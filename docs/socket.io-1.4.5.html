<!DOCTYPE html>

<html>
<head>
  <title>socket.io-1.4.5.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
  <link rel="stylesheet" media="all" href="docco.css" />
</head>
<body>
  <div id="container">
    <div id="background"></div>
    
      <ul id="jump_to">
        <li>
          <a class="large" href="javascript:void(0);">Jump To &hellip;</a>
          <a class="small" href="javascript:void(0);">+</a>
          <div id="jump_wrapper">
          <div id="jump_page_wrapper">
            <div id="jump_page">
              
                
                <a class="source" href="main.html">
                  main.js
                </a>
              
                
                <a class="source" href="pixi.min.html">
                  pixi.min.js
                </a>
              
                
                <a class="source" href="socket.io-1.4.5.html">
                  socket.io-1.4.5.js
                </a>
              
            </div>
          </div>
        </li>
      </ul>
    
    <ul class="sections">
        
          <li id="title">
              <div class="annotation">
                  <h1>socket.io-1.4.5.js</h1>
              </div>
          </li>
        
        
        
        <li id="section-1">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre>(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">f</span>)</span>{<span class="hljs-keyword">if</span>(<span class="hljs-keyword">typeof</span> exports===<span class="hljs-string">"object"</span>&amp;&amp;<span class="hljs-keyword">typeof</span> <span class="hljs-built_in">module</span>!==<span class="hljs-string">"undefined"</span>){<span class="hljs-built_in">module</span>.exports=f()}<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(<span class="hljs-keyword">typeof</span> define===<span class="hljs-string">"function"</span>&amp;&amp;define.amd){define([],f)}<span class="hljs-keyword">else</span>{<span class="hljs-keyword">var</span> g;<span class="hljs-keyword">if</span>(<span class="hljs-keyword">typeof</span> <span class="hljs-built_in">window</span>!==<span class="hljs-string">"undefined"</span>){g=<span class="hljs-built_in">window</span>}<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(<span class="hljs-keyword">typeof</span> global!==<span class="hljs-string">"undefined"</span>){g=global}<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(<span class="hljs-keyword">typeof</span> self!==<span class="hljs-string">"undefined"</span>){g=self}<span class="hljs-keyword">else</span>{g=<span class="hljs-keyword">this</span>}g.io=f()}})(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{<span class="hljs-keyword">var</span> define,<span class="hljs-built_in">module</span>,exports;<span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">e</span>(<span class="hljs-params">t,n,r</span>)</span>{<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">s</span>(<span class="hljs-params">o,u</span>)</span>{<span class="hljs-keyword">if</span>(!n[o]){<span class="hljs-keyword">if</span>(!t[o]){<span class="hljs-keyword">var</span> a=<span class="hljs-keyword">typeof</span> <span class="hljs-built_in">require</span>==<span class="hljs-string">"function"</span>&amp;&amp;<span class="hljs-built_in">require</span>;<span class="hljs-keyword">if</span>(!u&amp;&amp;a)<span class="hljs-keyword">return</span> a(o,!<span class="hljs-number">0</span>);<span class="hljs-keyword">if</span>(i)<span class="hljs-keyword">return</span> i(o,!<span class="hljs-number">0</span>);<span class="hljs-keyword">var</span> f=<span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"Cannot find module '"</span>+o+<span class="hljs-string">"'"</span>);<span class="hljs-keyword">throw</span> f.code=<span class="hljs-string">"MODULE_NOT_FOUND"</span>,f}<span class="hljs-keyword">var</span> l=n[o]={<span class="hljs-attr">exports</span>:{}};t[o][<span class="hljs-number">0</span>].call(l.exports,<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>)</span>{<span class="hljs-keyword">var</span> n=t[o][<span class="hljs-number">1</span>][e];<span class="hljs-keyword">return</span> s(n?n:e)},l,l.exports,e,t,n,r)}<span class="hljs-keyword">return</span> n[o].exports}<span class="hljs-keyword">var</span> i=<span class="hljs-keyword">typeof</span> <span class="hljs-built_in">require</span>==<span class="hljs-string">"function"</span>&amp;&amp;<span class="hljs-built_in">require</span>;<span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> o=<span class="hljs-number">0</span>;o&lt;r.length;o++)s(r[o]);<span class="hljs-keyword">return</span> s}({<span class="hljs-number">1</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">_dereq_,module,exports</span>)</span>{<span class="hljs-built_in">module</span>.exports=_dereq_(<span class="hljs-string">"./lib/"</span>)},{<span class="hljs-string">"./lib/"</span>:<span class="hljs-number">2</span>}],<span class="hljs-number">2</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">_dereq_,module,exports</span>)</span>{<span class="hljs-built_in">module</span>.exports=_dereq_(<span class="hljs-string">"./socket"</span>);<span class="hljs-built_in">module</span>.exports.parser=_dereq_(<span class="hljs-string">"engine.io-parser"</span>)},{<span class="hljs-string">"./socket"</span>:<span class="hljs-number">3</span>,<span class="hljs-string">"engine.io-parser"</span>:<span class="hljs-number">19</span>}],<span class="hljs-number">3</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">_dereq_,module,exports</span>)</span>{(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">global</span>)</span>{<span class="hljs-keyword">var</span> transports=_dereq_(<span class="hljs-string">"./transports"</span>);<span class="hljs-keyword">var</span> Emitter=_dereq_(<span class="hljs-string">"component-emitter"</span>);<span class="hljs-keyword">var</span> debug=_dereq_(<span class="hljs-string">"debug"</span>)(<span class="hljs-string">"engine.io-client:socket"</span>);<span class="hljs-keyword">var</span> index=_dereq_(<span class="hljs-string">"indexof"</span>);<span class="hljs-keyword">var</span> parser=_dereq_(<span class="hljs-string">"engine.io-parser"</span>);<span class="hljs-keyword">var</span> parseuri=_dereq_(<span class="hljs-string">"parseuri"</span>);<span class="hljs-keyword">var</span> parsejson=_dereq_(<span class="hljs-string">"parsejson"</span>);<span class="hljs-keyword">var</span> parseqs=_dereq_(<span class="hljs-string">"parseqs"</span>);<span class="hljs-built_in">module</span>.exports=Socket;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">noop</span>(<span class="hljs-params"></span>)</span>{}<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Socket</span>(<span class="hljs-params">uri,opts</span>)</span>{<span class="hljs-keyword">if</span>(!(<span class="hljs-keyword">this</span> <span class="hljs-keyword">instanceof</span> Socket))<span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Socket(uri,opts);opts=opts||{};<span class="hljs-keyword">if</span>(uri&amp;&amp;<span class="hljs-string">"object"</span>==<span class="hljs-keyword">typeof</span> uri){opts=uri;uri=<span class="hljs-literal">null</span>}<span class="hljs-keyword">if</span>(uri){uri=parseuri(uri);opts.hostname=uri.host;opts.secure=uri.protocol==<span class="hljs-string">"https"</span>||uri.protocol==<span class="hljs-string">"wss"</span>;opts.port=uri.port;<span class="hljs-keyword">if</span>(uri.query)opts.query=uri.query}<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(opts.host){opts.hostname=parseuri(opts.host).host}<span class="hljs-keyword">this</span>.secure=<span class="hljs-literal">null</span>!=opts.secure?opts.secure:global.location&amp;&amp;<span class="hljs-string">"https:"</span>==location.protocol;<span class="hljs-keyword">if</span>(opts.hostname&amp;&amp;!opts.port){opts.port=<span class="hljs-keyword">this</span>.secure?<span class="hljs-string">"443"</span>:<span class="hljs-string">"80"</span>}<span class="hljs-keyword">this</span>.agent=opts.agent||<span class="hljs-literal">false</span>;<span class="hljs-keyword">this</span>.hostname=opts.hostname||(global.location?location.hostname:<span class="hljs-string">"localhost"</span>);<span class="hljs-keyword">this</span>.port=opts.port||(global.location&amp;&amp;location.port?location.port:<span class="hljs-keyword">this</span>.secure?<span class="hljs-number">443</span>:<span class="hljs-number">80</span>);<span class="hljs-keyword">this</span>.query=opts.query||{};<span class="hljs-keyword">if</span>(<span class="hljs-string">"string"</span>==<span class="hljs-keyword">typeof</span> <span class="hljs-keyword">this</span>.query)<span class="hljs-keyword">this</span>.query=parseqs.decode(<span class="hljs-keyword">this</span>.query);<span class="hljs-keyword">this</span>.upgrade=<span class="hljs-literal">false</span>!==opts.upgrade;<span class="hljs-keyword">this</span>.path=(opts.path||<span class="hljs-string">"/engine.io"</span>).replace(<span class="hljs-regexp">/\/$/</span>,<span class="hljs-string">""</span>)+<span class="hljs-string">"/"</span>;<span class="hljs-keyword">this</span>.forceJSONP=!!opts.forceJSONP;<span class="hljs-keyword">this</span>.jsonp=<span class="hljs-literal">false</span>!==opts.jsonp;<span class="hljs-keyword">this</span>.forceBase64=!!opts.forceBase64;<span class="hljs-keyword">this</span>.enablesXDR=!!opts.enablesXDR;<span class="hljs-keyword">this</span>.timestampParam=opts.timestampParam||<span class="hljs-string">"t"</span>;<span class="hljs-keyword">this</span>.timestampRequests=opts.timestampRequests;<span class="hljs-keyword">this</span>.transports=opts.transports||[<span class="hljs-string">"polling"</span>,<span class="hljs-string">"websocket"</span>];<span class="hljs-keyword">this</span>.readyState=<span class="hljs-string">""</span>;<span class="hljs-keyword">this</span>.writeBuffer=[];<span class="hljs-keyword">this</span>.policyPort=opts.policyPort||<span class="hljs-number">843</span>;<span class="hljs-keyword">this</span>.rememberUpgrade=opts.rememberUpgrade||<span class="hljs-literal">false</span>;<span class="hljs-keyword">this</span>.binaryType=<span class="hljs-literal">null</span>;<span class="hljs-keyword">this</span>.onlyBinaryUpgrades=opts.onlyBinaryUpgrades;<span class="hljs-keyword">this</span>.perMessageDeflate=<span class="hljs-literal">false</span>!==opts.perMessageDeflate?opts.perMessageDeflate||{}:<span class="hljs-literal">false</span>;<span class="hljs-keyword">if</span>(<span class="hljs-literal">true</span>===<span class="hljs-keyword">this</span>.perMessageDeflate)<span class="hljs-keyword">this</span>.perMessageDeflate={};<span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.perMessageDeflate&amp;&amp;<span class="hljs-literal">null</span>==<span class="hljs-keyword">this</span>.perMessageDeflate.threshold){<span class="hljs-keyword">this</span>.perMessageDeflate.threshold=<span class="hljs-number">1024</span>}<span class="hljs-keyword">this</span>.pfx=opts.pfx||<span class="hljs-literal">null</span>;<span class="hljs-keyword">this</span>.key=opts.key||<span class="hljs-literal">null</span>;<span class="hljs-keyword">this</span>.passphrase=opts.passphrase||<span class="hljs-literal">null</span>;<span class="hljs-keyword">this</span>.cert=opts.cert||<span class="hljs-literal">null</span>;<span class="hljs-keyword">this</span>.ca=opts.ca||<span class="hljs-literal">null</span>;<span class="hljs-keyword">this</span>.ciphers=opts.ciphers||<span class="hljs-literal">null</span>;<span class="hljs-keyword">this</span>.rejectUnauthorized=opts.rejectUnauthorized===<span class="hljs-literal">undefined</span>?<span class="hljs-literal">null</span>:opts.rejectUnauthorized;<span class="hljs-keyword">var</span> freeGlobal=<span class="hljs-keyword">typeof</span> global==<span class="hljs-string">"object"</span>&amp;&amp;global;<span class="hljs-keyword">if</span>(freeGlobal.global===freeGlobal){<span class="hljs-keyword">if</span>(opts.extraHeaders&amp;&amp;<span class="hljs-built_in">Object</span>.keys(opts.extraHeaders).length&gt;<span class="hljs-number">0</span>){<span class="hljs-keyword">this</span>.extraHeaders=opts.extraHeaders}}<span class="hljs-keyword">this</span>.open()}Socket.priorWebsocketSuccess=<span class="hljs-literal">false</span>;Emitter(Socket.prototype);Socket.protocol=parser.protocol;Socket.Socket=Socket;Socket.Transport=_dereq_(<span class="hljs-string">"./transport"</span>);Socket.transports=_dereq_(<span class="hljs-string">"./transports"</span>);Socket.parser=_dereq_(<span class="hljs-string">"engine.io-parser"</span>);Socket.prototype.createTransport=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">name</span>)</span>{debug(<span class="hljs-string">'creating transport "%s"'</span>,name);<span class="hljs-keyword">var</span> query=clone(<span class="hljs-keyword">this</span>.query);query.EIO=parser.protocol;query.transport=name;<span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.id)query.sid=<span class="hljs-keyword">this</span>.id;<span class="hljs-keyword">var</span> transport=<span class="hljs-keyword">new</span> transports[name]({<span class="hljs-attr">agent</span>:<span class="hljs-keyword">this</span>.agent,<span class="hljs-attr">hostname</span>:<span class="hljs-keyword">this</span>.hostname,<span class="hljs-attr">port</span>:<span class="hljs-keyword">this</span>.port,<span class="hljs-attr">secure</span>:<span class="hljs-keyword">this</span>.secure,<span class="hljs-attr">path</span>:<span class="hljs-keyword">this</span>.path,<span class="hljs-attr">query</span>:query,<span class="hljs-attr">forceJSONP</span>:<span class="hljs-keyword">this</span>.forceJSONP,<span class="hljs-attr">jsonp</span>:<span class="hljs-keyword">this</span>.jsonp,<span class="hljs-attr">forceBase64</span>:<span class="hljs-keyword">this</span>.forceBase64,<span class="hljs-attr">enablesXDR</span>:<span class="hljs-keyword">this</span>.enablesXDR,<span class="hljs-attr">timestampRequests</span>:<span class="hljs-keyword">this</span>.timestampRequests,<span class="hljs-attr">timestampParam</span>:<span class="hljs-keyword">this</span>.timestampParam,<span class="hljs-attr">policyPort</span>:<span class="hljs-keyword">this</span>.policyPort,<span class="hljs-attr">socket</span>:<span class="hljs-keyword">this</span>,<span class="hljs-attr">pfx</span>:<span class="hljs-keyword">this</span>.pfx,<span class="hljs-attr">key</span>:<span class="hljs-keyword">this</span>.key,<span class="hljs-attr">passphrase</span>:<span class="hljs-keyword">this</span>.passphrase,<span class="hljs-attr">cert</span>:<span class="hljs-keyword">this</span>.cert,<span class="hljs-attr">ca</span>:<span class="hljs-keyword">this</span>.ca,<span class="hljs-attr">ciphers</span>:<span class="hljs-keyword">this</span>.ciphers,<span class="hljs-attr">rejectUnauthorized</span>:<span class="hljs-keyword">this</span>.rejectUnauthorized,<span class="hljs-attr">perMessageDeflate</span>:<span class="hljs-keyword">this</span>.perMessageDeflate,<span class="hljs-attr">extraHeaders</span>:<span class="hljs-keyword">this</span>.extraHeaders});<span class="hljs-keyword">return</span> transport};<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">clone</span>(<span class="hljs-params">obj</span>)</span>{<span class="hljs-keyword">var</span> o={};<span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> i <span class="hljs-keyword">in</span> obj){<span class="hljs-keyword">if</span>(obj.hasOwnProperty(i)){o[i]=obj[i]}}<span class="hljs-keyword">return</span> o}Socket.prototype.open=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{<span class="hljs-keyword">var</span> transport;<span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.rememberUpgrade&amp;&amp;Socket.priorWebsocketSuccess&amp;&amp;<span class="hljs-keyword">this</span>.transports.indexOf(<span class="hljs-string">"websocket"</span>)!=<span class="hljs-number">-1</span>){transport=<span class="hljs-string">"websocket"</span>}<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(<span class="hljs-number">0</span>===<span class="hljs-keyword">this</span>.transports.length){<span class="hljs-keyword">var</span> self=<span class="hljs-keyword">this</span>;setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{self.emit(<span class="hljs-string">"error"</span>,<span class="hljs-string">"No transports available"</span>)},<span class="hljs-number">0</span>);<span class="hljs-keyword">return</span>}<span class="hljs-keyword">else</span>{transport=<span class="hljs-keyword">this</span>.transports[<span class="hljs-number">0</span>]}<span class="hljs-keyword">this</span>.readyState=<span class="hljs-string">"opening"</span>;<span class="hljs-keyword">try</span>{transport=<span class="hljs-keyword">this</span>.createTransport(transport)}<span class="hljs-keyword">catch</span>(e){<span class="hljs-keyword">this</span>.transports.shift();<span class="hljs-keyword">this</span>.open();<span class="hljs-keyword">return</span>}transport.open();<span class="hljs-keyword">this</span>.setTransport(transport)};Socket.prototype.setTransport=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">transport</span>)</span>{debug(<span class="hljs-string">"setting transport %s"</span>,transport.name);<span class="hljs-keyword">var</span> self=<span class="hljs-keyword">this</span>;<span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.transport){debug(<span class="hljs-string">"clearing existing transport %s"</span>,<span class="hljs-keyword">this</span>.transport.name);<span class="hljs-keyword">this</span>.transport.removeAllListeners()}<span class="hljs-keyword">this</span>.transport=transport;transport.on(<span class="hljs-string">"drain"</span>,<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{self.onDrain()}).on(<span class="hljs-string">"packet"</span>,<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">packet</span>)</span>{self.onPacket(packet)}).on(<span class="hljs-string">"error"</span>,<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>)</span>{self.onError(e)}).on(<span class="hljs-string">"close"</span>,<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{self.onClose(<span class="hljs-string">"transport close"</span>)})};Socket.prototype.probe=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">name</span>)</span>{debug(<span class="hljs-string">'probing transport "%s"'</span>,name);<span class="hljs-keyword">var</span> transport=<span class="hljs-keyword">this</span>.createTransport(name,{<span class="hljs-attr">probe</span>:<span class="hljs-number">1</span>}),failed=<span class="hljs-literal">false</span>,self=<span class="hljs-keyword">this</span>;Socket.priorWebsocketSuccess=<span class="hljs-literal">false</span>;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">onTransportOpen</span>(<span class="hljs-params"></span>)</span>{<span class="hljs-keyword">if</span>(self.onlyBinaryUpgrades){<span class="hljs-keyword">var</span> upgradeLosesBinary=!<span class="hljs-keyword">this</span>.supportsBinary&amp;&amp;self.transport.supportsBinary;failed=failed||upgradeLosesBinary}<span class="hljs-keyword">if</span>(failed)<span class="hljs-keyword">return</span>;debug(<span class="hljs-string">'probe transport "%s" opened'</span>,name);transport.send([{<span class="hljs-attr">type</span>:<span class="hljs-string">"ping"</span>,<span class="hljs-attr">data</span>:<span class="hljs-string">"probe"</span>}]);transport.once(<span class="hljs-string">"packet"</span>,<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">msg</span>)</span>{<span class="hljs-keyword">if</span>(failed)<span class="hljs-keyword">return</span>;<span class="hljs-keyword">if</span>(<span class="hljs-string">"pong"</span>==msg.type&amp;&amp;<span class="hljs-string">"probe"</span>==msg.data){debug(<span class="hljs-string">'probe transport "%s" pong'</span>,name);self.upgrading=<span class="hljs-literal">true</span>;self.emit(<span class="hljs-string">"upgrading"</span>,transport);<span class="hljs-keyword">if</span>(!transport)<span class="hljs-keyword">return</span>;Socket.priorWebsocketSuccess=<span class="hljs-string">"websocket"</span>==transport.name;debug(<span class="hljs-string">'pausing current transport "%s"'</span>,self.transport.name);self.transport.pause(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{<span class="hljs-keyword">if</span>(failed)<span class="hljs-keyword">return</span>;<span class="hljs-keyword">if</span>(<span class="hljs-string">"closed"</span>==self.readyState)<span class="hljs-keyword">return</span>;debug(<span class="hljs-string">"changing transport and sending upgrade packet"</span>);cleanup();self.setTransport(transport);transport.send([{<span class="hljs-attr">type</span>:<span class="hljs-string">"upgrade"</span>}]);self.emit(<span class="hljs-string">"upgrade"</span>,transport);transport=<span class="hljs-literal">null</span>;self.upgrading=<span class="hljs-literal">false</span>;self.flush()})}<span class="hljs-keyword">else</span>{debug(<span class="hljs-string">'probe transport "%s" failed'</span>,name);<span class="hljs-keyword">var</span> err=<span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"probe error"</span>);err.transport=transport.name;self.emit(<span class="hljs-string">"upgradeError"</span>,err)}})}<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">freezeTransport</span>(<span class="hljs-params"></span>)</span>{<span class="hljs-keyword">if</span>(failed)<span class="hljs-keyword">return</span>;failed=<span class="hljs-literal">true</span>;cleanup();transport.close();transport=<span class="hljs-literal">null</span>}<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">onerror</span>(<span class="hljs-params">err</span>)</span>{<span class="hljs-keyword">var</span> error=<span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"probe error: "</span>+err);error.transport=transport.name;freezeTransport();debug(<span class="hljs-string">'probe transport "%s" failed because of error: %s'</span>,name,err);self.emit(<span class="hljs-string">"upgradeError"</span>,error)}<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">onTransportClose</span>(<span class="hljs-params"></span>)</span>{onerror(<span class="hljs-string">"transport closed"</span>)}<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">onclose</span>(<span class="hljs-params"></span>)</span>{onerror(<span class="hljs-string">"socket closed"</span>)}<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">onupgrade</span>(<span class="hljs-params">to</span>)</span>{<span class="hljs-keyword">if</span>(transport&amp;&amp;to.name!=transport.name){debug(<span class="hljs-string">'"%s" works - aborting "%s"'</span>,to.name,transport.name);freezeTransport()}}<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">cleanup</span>(<span class="hljs-params"></span>)</span>{transport.removeListener(<span class="hljs-string">"open"</span>,onTransportOpen);transport.removeListener(<span class="hljs-string">"error"</span>,onerror);transport.removeListener(<span class="hljs-string">"close"</span>,onTransportClose);self.removeListener(<span class="hljs-string">"close"</span>,onclose);self.removeListener(<span class="hljs-string">"upgrading"</span>,onupgrade)}transport.once(<span class="hljs-string">"open"</span>,onTransportOpen);transport.once(<span class="hljs-string">"error"</span>,onerror);transport.once(<span class="hljs-string">"close"</span>,onTransportClose);<span class="hljs-keyword">this</span>.once(<span class="hljs-string">"close"</span>,onclose);<span class="hljs-keyword">this</span>.once(<span class="hljs-string">"upgrading"</span>,onupgrade);transport.open()};Socket.prototype.onOpen=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{debug(<span class="hljs-string">"socket open"</span>);<span class="hljs-keyword">this</span>.readyState=<span class="hljs-string">"open"</span>;Socket.priorWebsocketSuccess=<span class="hljs-string">"websocket"</span>==<span class="hljs-keyword">this</span>.transport.name;<span class="hljs-keyword">this</span>.emit(<span class="hljs-string">"open"</span>);<span class="hljs-keyword">this</span>.flush();<span class="hljs-keyword">if</span>(<span class="hljs-string">"open"</span>==<span class="hljs-keyword">this</span>.readyState&amp;&amp;<span class="hljs-keyword">this</span>.upgrade&amp;&amp;<span class="hljs-keyword">this</span>.transport.pause){debug(<span class="hljs-string">"starting upgrade probes"</span>);<span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> i=<span class="hljs-number">0</span>,l=<span class="hljs-keyword">this</span>.upgrades.length;i&lt;l;i++){<span class="hljs-keyword">this</span>.probe(<span class="hljs-keyword">this</span>.upgrades[i])}}};Socket.prototype.onPacket=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">packet</span>)</span>{<span class="hljs-keyword">if</span>(<span class="hljs-string">"opening"</span>==<span class="hljs-keyword">this</span>.readyState||<span class="hljs-string">"open"</span>==<span class="hljs-keyword">this</span>.readyState){debug(<span class="hljs-string">'socket receive: type "%s", data "%s"'</span>,packet.type,packet.data);<span class="hljs-keyword">this</span>.emit(<span class="hljs-string">"packet"</span>,packet);<span class="hljs-keyword">this</span>.emit(<span class="hljs-string">"heartbeat"</span>);<span class="hljs-keyword">switch</span>(packet.type){<span class="hljs-keyword">case</span><span class="hljs-string">"open"</span>:<span class="hljs-keyword">this</span>.onHandshake(parsejson(packet.data));<span class="hljs-keyword">break</span>;<span class="hljs-keyword">case</span><span class="hljs-string">"pong"</span>:<span class="hljs-keyword">this</span>.setPing();<span class="hljs-keyword">this</span>.emit(<span class="hljs-string">"pong"</span>);<span class="hljs-keyword">break</span>;<span class="hljs-keyword">case</span><span class="hljs-string">"error"</span>:<span class="hljs-keyword">var</span> err=<span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"server error"</span>);err.code=packet.data;<span class="hljs-keyword">this</span>.onError(err);<span class="hljs-keyword">break</span>;<span class="hljs-keyword">case</span><span class="hljs-string">"message"</span>:<span class="hljs-keyword">this</span>.emit(<span class="hljs-string">"data"</span>,packet.data);<span class="hljs-keyword">this</span>.emit(<span class="hljs-string">"message"</span>,packet.data);<span class="hljs-keyword">break</span>}}<span class="hljs-keyword">else</span>{debug(<span class="hljs-string">'packet received with socket readyState "%s"'</span>,<span class="hljs-keyword">this</span>.readyState)}};Socket.prototype.onHandshake=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">data</span>)</span>{<span class="hljs-keyword">this</span>.emit(<span class="hljs-string">"handshake"</span>,data);<span class="hljs-keyword">this</span>.id=data.sid;<span class="hljs-keyword">this</span>.transport.query.sid=data.sid;<span class="hljs-keyword">this</span>.upgrades=<span class="hljs-keyword">this</span>.filterUpgrades(data.upgrades);<span class="hljs-keyword">this</span>.pingInterval=data.pingInterval;<span class="hljs-keyword">this</span>.pingTimeout=data.pingTimeout;<span class="hljs-keyword">this</span>.onOpen();<span class="hljs-keyword">if</span>(<span class="hljs-string">"closed"</span>==<span class="hljs-keyword">this</span>.readyState)<span class="hljs-keyword">return</span>;<span class="hljs-keyword">this</span>.setPing();<span class="hljs-keyword">this</span>.removeListener(<span class="hljs-string">"heartbeat"</span>,<span class="hljs-keyword">this</span>.onHeartbeat);<span class="hljs-keyword">this</span>.on(<span class="hljs-string">"heartbeat"</span>,<span class="hljs-keyword">this</span>.onHeartbeat)};Socket.prototype.onHeartbeat=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">timeout</span>)</span>{clearTimeout(<span class="hljs-keyword">this</span>.pingTimeoutTimer);<span class="hljs-keyword">var</span> self=<span class="hljs-keyword">this</span>;self.pingTimeoutTimer=setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{<span class="hljs-keyword">if</span>(<span class="hljs-string">"closed"</span>==self.readyState)<span class="hljs-keyword">return</span>;self.onClose(<span class="hljs-string">"ping timeout"</span>)},timeout||self.pingInterval+self.pingTimeout)};Socket.prototype.setPing=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{<span class="hljs-keyword">var</span> self=<span class="hljs-keyword">this</span>;clearTimeout(self.pingIntervalTimer);self.pingIntervalTimer=setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{debug(<span class="hljs-string">"writing ping packet - expecting pong within %sms"</span>,self.pingTimeout);self.ping();self.onHeartbeat(self.pingTimeout)},self.pingInterval)};Socket.prototype.ping=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{<span class="hljs-keyword">var</span> self=<span class="hljs-keyword">this</span>;<span class="hljs-keyword">this</span>.sendPacket(<span class="hljs-string">"ping"</span>,<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{self.emit(<span class="hljs-string">"ping"</span>)})};Socket.prototype.onDrain=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{<span class="hljs-keyword">this</span>.writeBuffer.splice(<span class="hljs-number">0</span>,<span class="hljs-keyword">this</span>.prevBufferLen);<span class="hljs-keyword">this</span>.prevBufferLen=<span class="hljs-number">0</span>;<span class="hljs-keyword">if</span>(<span class="hljs-number">0</span>===<span class="hljs-keyword">this</span>.writeBuffer.length){<span class="hljs-keyword">this</span>.emit(<span class="hljs-string">"drain"</span>)}<span class="hljs-keyword">else</span>{<span class="hljs-keyword">this</span>.flush()}};Socket.prototype.flush=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{<span class="hljs-keyword">if</span>(<span class="hljs-string">"closed"</span>!=<span class="hljs-keyword">this</span>.readyState&amp;&amp;<span class="hljs-keyword">this</span>.transport.writable&amp;&amp;!<span class="hljs-keyword">this</span>.upgrading&amp;&amp;<span class="hljs-keyword">this</span>.writeBuffer.length){debug(<span class="hljs-string">"flushing %d packets in socket"</span>,<span class="hljs-keyword">this</span>.writeBuffer.length);<span class="hljs-keyword">this</span>.transport.send(<span class="hljs-keyword">this</span>.writeBuffer);<span class="hljs-keyword">this</span>.prevBufferLen=<span class="hljs-keyword">this</span>.writeBuffer.length;<span class="hljs-keyword">this</span>.emit(<span class="hljs-string">"flush"</span>)}};Socket.prototype.write=Socket.prototype.send=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">msg,options,fn</span>)</span>{<span class="hljs-keyword">this</span>.sendPacket(<span class="hljs-string">"message"</span>,msg,options,fn);<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>};Socket.prototype.sendPacket=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">type,data,options,fn</span>)</span>{<span class="hljs-keyword">if</span>(<span class="hljs-string">"function"</span>==<span class="hljs-keyword">typeof</span> data){fn=data;data=<span class="hljs-literal">undefined</span>}<span class="hljs-keyword">if</span>(<span class="hljs-string">"function"</span>==<span class="hljs-keyword">typeof</span> options){fn=options;options=<span class="hljs-literal">null</span>}<span class="hljs-keyword">if</span>(<span class="hljs-string">"closing"</span>==<span class="hljs-keyword">this</span>.readyState||<span class="hljs-string">"closed"</span>==<span class="hljs-keyword">this</span>.readyState){<span class="hljs-keyword">return</span>}options=options||{};options.compress=<span class="hljs-literal">false</span>!==options.compress;<span class="hljs-keyword">var</span> packet={<span class="hljs-attr">type</span>:type,<span class="hljs-attr">data</span>:data,<span class="hljs-attr">options</span>:options};<span class="hljs-keyword">this</span>.emit(<span class="hljs-string">"packetCreate"</span>,packet);<span class="hljs-keyword">this</span>.writeBuffer.push(packet);<span class="hljs-keyword">if</span>(fn)<span class="hljs-keyword">this</span>.once(<span class="hljs-string">"flush"</span>,fn);<span class="hljs-keyword">this</span>.flush()};Socket.prototype.close=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{<span class="hljs-keyword">if</span>(<span class="hljs-string">"opening"</span>==<span class="hljs-keyword">this</span>.readyState||<span class="hljs-string">"open"</span>==<span class="hljs-keyword">this</span>.readyState){<span class="hljs-keyword">this</span>.readyState=<span class="hljs-string">"closing"</span>;<span class="hljs-keyword">var</span> self=<span class="hljs-keyword">this</span>;<span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.writeBuffer.length){<span class="hljs-keyword">this</span>.once(<span class="hljs-string">"drain"</span>,<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{<span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.upgrading){waitForUpgrade()}<span class="hljs-keyword">else</span>{close()}})}<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.upgrading){waitForUpgrade()}<span class="hljs-keyword">else</span>{close()}}<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">close</span>(<span class="hljs-params"></span>)</span>{self.onClose(<span class="hljs-string">"forced close"</span>);debug(<span class="hljs-string">"socket closing - telling transport to close"</span>);self.transport.close()}<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">cleanupAndClose</span>(<span class="hljs-params"></span>)</span>{self.removeListener(<span class="hljs-string">"upgrade"</span>,cleanupAndClose);self.removeListener(<span class="hljs-string">"upgradeError"</span>,cleanupAndClose);close()}<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">waitForUpgrade</span>(<span class="hljs-params"></span>)</span>{self.once(<span class="hljs-string">"upgrade"</span>,cleanupAndClose);self.once(<span class="hljs-string">"upgradeError"</span>,cleanupAndClose)}<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>};Socket.prototype.onError=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">err</span>)</span>{debug(<span class="hljs-string">"socket error %j"</span>,err);Socket.priorWebsocketSuccess=<span class="hljs-literal">false</span>;<span class="hljs-keyword">this</span>.emit(<span class="hljs-string">"error"</span>,err);<span class="hljs-keyword">this</span>.onClose(<span class="hljs-string">"transport error"</span>,err)};Socket.prototype.onClose=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">reason,desc</span>)</span>{<span class="hljs-keyword">if</span>(<span class="hljs-string">"opening"</span>==<span class="hljs-keyword">this</span>.readyState||<span class="hljs-string">"open"</span>==<span class="hljs-keyword">this</span>.readyState||<span class="hljs-string">"closing"</span>==<span class="hljs-keyword">this</span>.readyState){debug(<span class="hljs-string">'socket close with reason: "%s"'</span>,reason);<span class="hljs-keyword">var</span> self=<span class="hljs-keyword">this</span>;clearTimeout(<span class="hljs-keyword">this</span>.pingIntervalTimer);clearTimeout(<span class="hljs-keyword">this</span>.pingTimeoutTimer);<span class="hljs-keyword">this</span>.transport.removeAllListeners(<span class="hljs-string">"close"</span>);<span class="hljs-keyword">this</span>.transport.close();<span class="hljs-keyword">this</span>.transport.removeAllListeners();<span class="hljs-keyword">this</span>.readyState=<span class="hljs-string">"closed"</span>;<span class="hljs-keyword">this</span>.id=<span class="hljs-literal">null</span>;<span class="hljs-keyword">this</span>.emit(<span class="hljs-string">"close"</span>,reason,desc);self.writeBuffer=[];self.prevBufferLen=<span class="hljs-number">0</span>}};Socket.prototype.filterUpgrades=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">upgrades</span>)</span>{<span class="hljs-keyword">var</span> filteredUpgrades=[];<span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> i=<span class="hljs-number">0</span>,j=upgrades.length;i&lt;j;i++){<span class="hljs-keyword">if</span>(~index(<span class="hljs-keyword">this</span>.transports,upgrades[i]))filteredUpgrades.push(upgrades[i])}<span class="hljs-keyword">return</span> filteredUpgrades}}).call(<span class="hljs-keyword">this</span>,<span class="hljs-keyword">typeof</span> self!==<span class="hljs-string">"undefined"</span>?self:<span class="hljs-keyword">typeof</span> <span class="hljs-built_in">window</span>!==<span class="hljs-string">"undefined"</span>?<span class="hljs-built_in">window</span>:<span class="hljs-keyword">typeof</span> global!==<span class="hljs-string">"undefined"</span>?global:{})},{<span class="hljs-string">"./transport"</span>:<span class="hljs-number">4</span>,<span class="hljs-string">"./transports"</span>:<span class="hljs-number">5</span>,<span class="hljs-string">"component-emitter"</span>:<span class="hljs-number">15</span>,<span class="hljs-attr">debug</span>:<span class="hljs-number">17</span>,<span class="hljs-string">"engine.io-parser"</span>:<span class="hljs-number">19</span>,<span class="hljs-attr">indexof</span>:<span class="hljs-number">23</span>,<span class="hljs-attr">parsejson</span>:<span class="hljs-number">26</span>,<span class="hljs-attr">parseqs</span>:<span class="hljs-number">27</span>,<span class="hljs-attr">parseuri</span>:<span class="hljs-number">28</span>}],<span class="hljs-number">4</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">_dereq_,module,exports</span>)</span>{<span class="hljs-keyword">var</span> parser=_dereq_(<span class="hljs-string">"engine.io-parser"</span>);<span class="hljs-keyword">var</span> Emitter=_dereq_(<span class="hljs-string">"component-emitter"</span>);<span class="hljs-built_in">module</span>.exports=Transport;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Transport</span>(<span class="hljs-params">opts</span>)</span>{<span class="hljs-keyword">this</span>.path=opts.path;<span class="hljs-keyword">this</span>.hostname=opts.hostname;<span class="hljs-keyword">this</span>.port=opts.port;<span class="hljs-keyword">this</span>.secure=opts.secure;<span class="hljs-keyword">this</span>.query=opts.query;<span class="hljs-keyword">this</span>.timestampParam=opts.timestampParam;<span class="hljs-keyword">this</span>.timestampRequests=opts.timestampRequests;<span class="hljs-keyword">this</span>.readyState=<span class="hljs-string">""</span>;<span class="hljs-keyword">this</span>.agent=opts.agent||<span class="hljs-literal">false</span>;<span class="hljs-keyword">this</span>.socket=opts.socket;<span class="hljs-keyword">this</span>.enablesXDR=opts.enablesXDR;<span class="hljs-keyword">this</span>.pfx=opts.pfx;<span class="hljs-keyword">this</span>.key=opts.key;<span class="hljs-keyword">this</span>.passphrase=opts.passphrase;<span class="hljs-keyword">this</span>.cert=opts.cert;<span class="hljs-keyword">this</span>.ca=opts.ca;<span class="hljs-keyword">this</span>.ciphers=opts.ciphers;<span class="hljs-keyword">this</span>.rejectUnauthorized=opts.rejectUnauthorized;<span class="hljs-keyword">this</span>.extraHeaders=opts.extraHeaders}Emitter(Transport.prototype);Transport.prototype.onError=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">msg,desc</span>)</span>{<span class="hljs-keyword">var</span> err=<span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(msg);err.type=<span class="hljs-string">"TransportError"</span>;err.description=desc;<span class="hljs-keyword">this</span>.emit(<span class="hljs-string">"error"</span>,err);<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>};Transport.prototype.open=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{<span class="hljs-keyword">if</span>(<span class="hljs-string">"closed"</span>==<span class="hljs-keyword">this</span>.readyState||<span class="hljs-string">""</span>==<span class="hljs-keyword">this</span>.readyState){<span class="hljs-keyword">this</span>.readyState=<span class="hljs-string">"opening"</span>;<span class="hljs-keyword">this</span>.doOpen()}<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>};Transport.prototype.close=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{<span class="hljs-keyword">if</span>(<span class="hljs-string">"opening"</span>==<span class="hljs-keyword">this</span>.readyState||<span class="hljs-string">"open"</span>==<span class="hljs-keyword">this</span>.readyState){<span class="hljs-keyword">this</span>.doClose();<span class="hljs-keyword">this</span>.onClose()}<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>};Transport.prototype.send=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">packets</span>)</span>{<span class="hljs-keyword">if</span>(<span class="hljs-string">"open"</span>==<span class="hljs-keyword">this</span>.readyState){<span class="hljs-keyword">this</span>.write(packets)}<span class="hljs-keyword">else</span>{<span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"Transport not open"</span>)}};Transport.prototype.onOpen=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{<span class="hljs-keyword">this</span>.readyState=<span class="hljs-string">"open"</span>;<span class="hljs-keyword">this</span>.writable=<span class="hljs-literal">true</span>;<span class="hljs-keyword">this</span>.emit(<span class="hljs-string">"open"</span>)};Transport.prototype.onData=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">data</span>)</span>{<span class="hljs-keyword">var</span> packet=parser.decodePacket(data,<span class="hljs-keyword">this</span>.socket.binaryType);<span class="hljs-keyword">this</span>.onPacket(packet)};Transport.prototype.onPacket=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">packet</span>)</span>{<span class="hljs-keyword">this</span>.emit(<span class="hljs-string">"packet"</span>,packet)};Transport.prototype.onClose=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{<span class="hljs-keyword">this</span>.readyState=<span class="hljs-string">"closed"</span>;<span class="hljs-keyword">this</span>.emit(<span class="hljs-string">"close"</span>)}},{<span class="hljs-string">"component-emitter"</span>:<span class="hljs-number">15</span>,<span class="hljs-string">"engine.io-parser"</span>:<span class="hljs-number">19</span>}],<span class="hljs-number">5</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">_dereq_,module,exports</span>)</span>{(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">global</span>)</span>{<span class="hljs-keyword">var</span> XMLHttpRequest=_dereq_(<span class="hljs-string">"xmlhttprequest-ssl"</span>);<span class="hljs-keyword">var</span> XHR=_dereq_(<span class="hljs-string">"./polling-xhr"</span>);<span class="hljs-keyword">var</span> JSONP=_dereq_(<span class="hljs-string">"./polling-jsonp"</span>);<span class="hljs-keyword">var</span> websocket=_dereq_(<span class="hljs-string">"./websocket"</span>);exports.polling=polling;exports.websocket=websocket;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">polling</span>(<span class="hljs-params">opts</span>)</span>{<span class="hljs-keyword">var</span> xhr;<span class="hljs-keyword">var</span> xd=<span class="hljs-literal">false</span>;<span class="hljs-keyword">var</span> xs=<span class="hljs-literal">false</span>;<span class="hljs-keyword">var</span> jsonp=<span class="hljs-literal">false</span>!==opts.jsonp;<span class="hljs-keyword">if</span>(global.location){<span class="hljs-keyword">var</span> isSSL=<span class="hljs-string">"https:"</span>==location.protocol;<span class="hljs-keyword">var</span> port=location.port;<span class="hljs-keyword">if</span>(!port){port=isSSL?<span class="hljs-number">443</span>:<span class="hljs-number">80</span>}xd=opts.hostname!=location.hostname||port!=opts.port;xs=opts.secure!=isSSL}opts.xdomain=xd;opts.xscheme=xs;xhr=<span class="hljs-keyword">new</span> XMLHttpRequest(opts);<span class="hljs-keyword">if</span>(<span class="hljs-string">"open"</span><span class="hljs-keyword">in</span> xhr&amp;&amp;!opts.forceJSONP){<span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> XHR(opts)}<span class="hljs-keyword">else</span>{<span class="hljs-keyword">if</span>(!jsonp)<span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"JSONP disabled"</span>);<span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> JSONP(opts)}}}).call(<span class="hljs-keyword">this</span>,<span class="hljs-keyword">typeof</span> self!==<span class="hljs-string">"undefined"</span>?self:<span class="hljs-keyword">typeof</span> <span class="hljs-built_in">window</span>!==<span class="hljs-string">"undefined"</span>?<span class="hljs-built_in">window</span>:<span class="hljs-keyword">typeof</span> global!==<span class="hljs-string">"undefined"</span>?global:{})},{<span class="hljs-string">"./polling-jsonp"</span>:<span class="hljs-number">6</span>,<span class="hljs-string">"./polling-xhr"</span>:<span class="hljs-number">7</span>,<span class="hljs-string">"./websocket"</span>:<span class="hljs-number">9</span>,<span class="hljs-string">"xmlhttprequest-ssl"</span>:<span class="hljs-number">10</span>}],<span class="hljs-number">6</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">_dereq_,module,exports</span>)</span>{(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">global</span>)</span>{<span class="hljs-keyword">var</span> Polling=_dereq_(<span class="hljs-string">"./polling"</span>);<span class="hljs-keyword">var</span> inherit=_dereq_(<span class="hljs-string">"component-inherit"</span>);<span class="hljs-built_in">module</span>.exports=JSONPPolling;<span class="hljs-keyword">var</span> rNewline=<span class="hljs-regexp">/\n/g</span>;<span class="hljs-keyword">var</span> rEscapedNewline=<span class="hljs-regexp">/\\n/g</span>;<span class="hljs-keyword">var</span> callbacks;<span class="hljs-keyword">var</span> index=<span class="hljs-number">0</span>;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">empty</span>(<span class="hljs-params"></span>)</span>{}<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">JSONPPolling</span>(<span class="hljs-params">opts</span>)</span>{Polling.call(<span class="hljs-keyword">this</span>,opts);<span class="hljs-keyword">this</span>.query=<span class="hljs-keyword">this</span>.query||{};<span class="hljs-keyword">if</span>(!callbacks){<span class="hljs-keyword">if</span>(!global.___eio)global.___eio=[];callbacks=global.___eio}<span class="hljs-keyword">this</span>.index=callbacks.length;<span class="hljs-keyword">var</span> self=<span class="hljs-keyword">this</span>;callbacks.push(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">msg</span>)</span>{self.onData(msg)});<span class="hljs-keyword">this</span>.query.j=<span class="hljs-keyword">this</span>.index;<span class="hljs-keyword">if</span>(global.document&amp;&amp;global.addEventListener){global.addEventListener(<span class="hljs-string">"beforeunload"</span>,<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{<span class="hljs-keyword">if</span>(self.script)self.script.onerror=empty},<span class="hljs-literal">false</span>)}}inherit(JSONPPolling,Polling);JSONPPolling.prototype.supportsBinary=<span class="hljs-literal">false</span>;JSONPPolling.prototype.doClose=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{<span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.script){<span class="hljs-keyword">this</span>.script.parentNode.removeChild(<span class="hljs-keyword">this</span>.script);<span class="hljs-keyword">this</span>.script=<span class="hljs-literal">null</span>}<span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.form){<span class="hljs-keyword">this</span>.form.parentNode.removeChild(<span class="hljs-keyword">this</span>.form);<span class="hljs-keyword">this</span>.form=<span class="hljs-literal">null</span>;<span class="hljs-keyword">this</span>.iframe=<span class="hljs-literal">null</span>}Polling.prototype.doClose.call(<span class="hljs-keyword">this</span>)};JSONPPolling.prototype.doPoll=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{<span class="hljs-keyword">var</span> self=<span class="hljs-keyword">this</span>;<span class="hljs-keyword">var</span> script=<span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">"script"</span>);<span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.script){<span class="hljs-keyword">this</span>.script.parentNode.removeChild(<span class="hljs-keyword">this</span>.script);<span class="hljs-keyword">this</span>.script=<span class="hljs-literal">null</span>}script.async=<span class="hljs-literal">true</span>;script.src=<span class="hljs-keyword">this</span>.uri();script.onerror=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>)</span>{self.onError(<span class="hljs-string">"jsonp poll error"</span>,e)};<span class="hljs-keyword">var</span> insertAt=<span class="hljs-built_in">document</span>.getElementsByTagName(<span class="hljs-string">"script"</span>)[<span class="hljs-number">0</span>];<span class="hljs-keyword">if</span>(insertAt){insertAt.parentNode.insertBefore(script,insertAt)}<span class="hljs-keyword">else</span>{(<span class="hljs-built_in">document</span>.head||<span class="hljs-built_in">document</span>.body).appendChild(script)}<span class="hljs-keyword">this</span>.script=script;<span class="hljs-keyword">var</span> isUAgecko=<span class="hljs-string">"undefined"</span>!=<span class="hljs-keyword">typeof</span> navigator&amp;&amp;<span class="hljs-regexp">/gecko/i</span>.test(navigator.userAgent);<span class="hljs-keyword">if</span>(isUAgecko){setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{<span class="hljs-keyword">var</span> iframe=<span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">"iframe"</span>);<span class="hljs-built_in">document</span>.body.appendChild(iframe);<span class="hljs-built_in">document</span>.body.removeChild(iframe)},<span class="hljs-number">100</span>)}};JSONPPolling.prototype.doWrite=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">data,fn</span>)</span>{<span class="hljs-keyword">var</span> self=<span class="hljs-keyword">this</span>;<span class="hljs-keyword">if</span>(!<span class="hljs-keyword">this</span>.form){<span class="hljs-keyword">var</span> form=<span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">"form"</span>);<span class="hljs-keyword">var</span> area=<span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">"textarea"</span>);<span class="hljs-keyword">var</span> id=<span class="hljs-keyword">this</span>.iframeId=<span class="hljs-string">"eio_iframe_"</span>+<span class="hljs-keyword">this</span>.index;<span class="hljs-keyword">var</span> iframe;form.className=<span class="hljs-string">"socketio"</span>;form.style.position=<span class="hljs-string">"absolute"</span>;form.style.top=<span class="hljs-string">"-1000px"</span>;form.style.left=<span class="hljs-string">"-1000px"</span>;form.target=id;form.method=<span class="hljs-string">"POST"</span>;form.setAttribute(<span class="hljs-string">"accept-charset"</span>,<span class="hljs-string">"utf-8"</span>);area.name=<span class="hljs-string">"d"</span>;form.appendChild(area);<span class="hljs-built_in">document</span>.body.appendChild(form);<span class="hljs-keyword">this</span>.form=form;<span class="hljs-keyword">this</span>.area=area}<span class="hljs-keyword">this</span>.form.action=<span class="hljs-keyword">this</span>.uri();<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">complete</span>(<span class="hljs-params"></span>)</span>{initIframe();fn()}<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">initIframe</span>(<span class="hljs-params"></span>)</span>{<span class="hljs-keyword">if</span>(self.iframe){<span class="hljs-keyword">try</span>{self.form.removeChild(self.iframe)}<span class="hljs-keyword">catch</span>(e){self.onError(<span class="hljs-string">"jsonp polling iframe removal error"</span>,e)}}<span class="hljs-keyword">try</span>{<span class="hljs-keyword">var</span> html=<span class="hljs-string">'&lt;iframe src="javascript:0" name="'</span>+self.iframeId+<span class="hljs-string">'"&gt;'</span>;iframe=<span class="hljs-built_in">document</span>.createElement(html)}<span class="hljs-keyword">catch</span>(e){iframe=<span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">"iframe"</span>);iframe.name=self.iframeId;iframe.src=<span class="hljs-string">"javascript:0"</span>}iframe.id=self.iframeId;self.form.appendChild(iframe);self.iframe=iframe}initIframe();data=data.replace(rEscapedNewline,<span class="hljs-string">"\\\n"</span>);<span class="hljs-keyword">this</span>.area.value=data.replace(rNewline,<span class="hljs-string">"\\n"</span>);<span class="hljs-keyword">try</span>{<span class="hljs-keyword">this</span>.form.submit()}<span class="hljs-keyword">catch</span>(e){}<span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.iframe.attachEvent){<span class="hljs-keyword">this</span>.iframe.onreadystatechange=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{<span class="hljs-keyword">if</span>(self.iframe.readyState==<span class="hljs-string">"complete"</span>){complete()}}}<span class="hljs-keyword">else</span>{<span class="hljs-keyword">this</span>.iframe.onload=complete}}}).call(<span class="hljs-keyword">this</span>,<span class="hljs-keyword">typeof</span> self!==<span class="hljs-string">"undefined"</span>?self:<span class="hljs-keyword">typeof</span> <span class="hljs-built_in">window</span>!==<span class="hljs-string">"undefined"</span>?<span class="hljs-built_in">window</span>:<span class="hljs-keyword">typeof</span> global!==<span class="hljs-string">"undefined"</span>?global:{})},{<span class="hljs-string">"./polling"</span>:<span class="hljs-number">8</span>,<span class="hljs-string">"component-inherit"</span>:<span class="hljs-number">16</span>}],<span class="hljs-number">7</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">_dereq_,module,exports</span>)</span>{(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">global</span>)</span>{<span class="hljs-keyword">var</span> XMLHttpRequest=_dereq_(<span class="hljs-string">"xmlhttprequest-ssl"</span>);<span class="hljs-keyword">var</span> Polling=_dereq_(<span class="hljs-string">"./polling"</span>);<span class="hljs-keyword">var</span> Emitter=_dereq_(<span class="hljs-string">"component-emitter"</span>);<span class="hljs-keyword">var</span> inherit=_dereq_(<span class="hljs-string">"component-inherit"</span>);<span class="hljs-keyword">var</span> debug=_dereq_(<span class="hljs-string">"debug"</span>)(<span class="hljs-string">"engine.io-client:polling-xhr"</span>);<span class="hljs-built_in">module</span>.exports=XHR;<span class="hljs-built_in">module</span>.exports.Request=Request;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">empty</span>(<span class="hljs-params"></span>)</span>{}<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">XHR</span>(<span class="hljs-params">opts</span>)</span>{Polling.call(<span class="hljs-keyword">this</span>,opts);<span class="hljs-keyword">if</span>(global.location){<span class="hljs-keyword">var</span> isSSL=<span class="hljs-string">"https:"</span>==location.protocol;<span class="hljs-keyword">var</span> port=location.port;<span class="hljs-keyword">if</span>(!port){port=isSSL?<span class="hljs-number">443</span>:<span class="hljs-number">80</span>}<span class="hljs-keyword">this</span>.xd=opts.hostname!=global.location.hostname||port!=opts.port;<span class="hljs-keyword">this</span>.xs=opts.secure!=isSSL}<span class="hljs-keyword">else</span>{<span class="hljs-keyword">this</span>.extraHeaders=opts.extraHeaders}}inherit(XHR,Polling);XHR.prototype.supportsBinary=<span class="hljs-literal">true</span>;XHR.prototype.request=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">opts</span>)</span>{opts=opts||{};opts.uri=<span class="hljs-keyword">this</span>.uri();opts.xd=<span class="hljs-keyword">this</span>.xd;opts.xs=<span class="hljs-keyword">this</span>.xs;opts.agent=<span class="hljs-keyword">this</span>.agent||<span class="hljs-literal">false</span>;opts.supportsBinary=<span class="hljs-keyword">this</span>.supportsBinary;opts.enablesXDR=<span class="hljs-keyword">this</span>.enablesXDR;opts.pfx=<span class="hljs-keyword">this</span>.pfx;opts.key=<span class="hljs-keyword">this</span>.key;opts.passphrase=<span class="hljs-keyword">this</span>.passphrase;opts.cert=<span class="hljs-keyword">this</span>.cert;opts.ca=<span class="hljs-keyword">this</span>.ca;opts.ciphers=<span class="hljs-keyword">this</span>.ciphers;opts.rejectUnauthorized=<span class="hljs-keyword">this</span>.rejectUnauthorized;opts.extraHeaders=<span class="hljs-keyword">this</span>.extraHeaders;<span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Request(opts)};XHR.prototype.doWrite=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">data,fn</span>)</span>{<span class="hljs-keyword">var</span> isBinary=<span class="hljs-keyword">typeof</span> data!==<span class="hljs-string">"string"</span>&amp;&amp;data!==<span class="hljs-literal">undefined</span>;<span class="hljs-keyword">var</span> req=<span class="hljs-keyword">this</span>.request({<span class="hljs-attr">method</span>:<span class="hljs-string">"POST"</span>,<span class="hljs-attr">data</span>:data,<span class="hljs-attr">isBinary</span>:isBinary});<span class="hljs-keyword">var</span> self=<span class="hljs-keyword">this</span>;req.on(<span class="hljs-string">"success"</span>,fn);req.on(<span class="hljs-string">"error"</span>,<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">err</span>)</span>{self.onError(<span class="hljs-string">"xhr post error"</span>,err)});<span class="hljs-keyword">this</span>.sendXhr=req};XHR.prototype.doPoll=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{debug(<span class="hljs-string">"xhr poll"</span>);<span class="hljs-keyword">var</span> req=<span class="hljs-keyword">this</span>.request();<span class="hljs-keyword">var</span> self=<span class="hljs-keyword">this</span>;req.on(<span class="hljs-string">"data"</span>,<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">data</span>)</span>{self.onData(data)});req.on(<span class="hljs-string">"error"</span>,<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">err</span>)</span>{self.onError(<span class="hljs-string">"xhr poll error"</span>,err)});<span class="hljs-keyword">this</span>.pollXhr=req};<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Request</span>(<span class="hljs-params">opts</span>)</span>{<span class="hljs-keyword">this</span>.method=opts.method||<span class="hljs-string">"GET"</span>;<span class="hljs-keyword">this</span>.uri=opts.uri;<span class="hljs-keyword">this</span>.xd=!!opts.xd;<span class="hljs-keyword">this</span>.xs=!!opts.xs;<span class="hljs-keyword">this</span>.async=<span class="hljs-literal">false</span>!==opts.async;<span class="hljs-keyword">this</span>.data=<span class="hljs-literal">undefined</span>!=opts.data?opts.data:<span class="hljs-literal">null</span>;<span class="hljs-keyword">this</span>.agent=opts.agent;<span class="hljs-keyword">this</span>.isBinary=opts.isBinary;<span class="hljs-keyword">this</span>.supportsBinary=opts.supportsBinary;<span class="hljs-keyword">this</span>.enablesXDR=opts.enablesXDR;<span class="hljs-keyword">this</span>.pfx=opts.pfx;<span class="hljs-keyword">this</span>.key=opts.key;<span class="hljs-keyword">this</span>.passphrase=opts.passphrase;<span class="hljs-keyword">this</span>.cert=opts.cert;<span class="hljs-keyword">this</span>.ca=opts.ca;<span class="hljs-keyword">this</span>.ciphers=opts.ciphers;<span class="hljs-keyword">this</span>.rejectUnauthorized=opts.rejectUnauthorized;<span class="hljs-keyword">this</span>.extraHeaders=opts.extraHeaders;<span class="hljs-keyword">this</span>.create()}Emitter(Request.prototype);Request.prototype.create=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{<span class="hljs-keyword">var</span> opts={<span class="hljs-attr">agent</span>:<span class="hljs-keyword">this</span>.agent,<span class="hljs-attr">xdomain</span>:<span class="hljs-keyword">this</span>.xd,<span class="hljs-attr">xscheme</span>:<span class="hljs-keyword">this</span>.xs,<span class="hljs-attr">enablesXDR</span>:<span class="hljs-keyword">this</span>.enablesXDR};opts.pfx=<span class="hljs-keyword">this</span>.pfx;opts.key=<span class="hljs-keyword">this</span>.key;opts.passphrase=<span class="hljs-keyword">this</span>.passphrase;opts.cert=<span class="hljs-keyword">this</span>.cert;opts.ca=<span class="hljs-keyword">this</span>.ca;opts.ciphers=<span class="hljs-keyword">this</span>.ciphers;opts.rejectUnauthorized=<span class="hljs-keyword">this</span>.rejectUnauthorized;<span class="hljs-keyword">var</span> xhr=<span class="hljs-keyword">this</span>.xhr=<span class="hljs-keyword">new</span> XMLHttpRequest(opts);<span class="hljs-keyword">var</span> self=<span class="hljs-keyword">this</span>;<span class="hljs-keyword">try</span>{debug(<span class="hljs-string">"xhr open %s: %s"</span>,<span class="hljs-keyword">this</span>.method,<span class="hljs-keyword">this</span>.uri);xhr.open(<span class="hljs-keyword">this</span>.method,<span class="hljs-keyword">this</span>.uri,<span class="hljs-keyword">this</span>.async);<span class="hljs-keyword">try</span>{<span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.extraHeaders){xhr.setDisableHeaderCheck(<span class="hljs-literal">true</span>);<span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> i <span class="hljs-keyword">in</span> <span class="hljs-keyword">this</span>.extraHeaders){<span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.extraHeaders.hasOwnProperty(i)){xhr.setRequestHeader(i,<span class="hljs-keyword">this</span>.extraHeaders[i])}}}}<span class="hljs-keyword">catch</span>(e){}<span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.supportsBinary){xhr.responseType=<span class="hljs-string">"arraybuffer"</span>}<span class="hljs-keyword">if</span>(<span class="hljs-string">"POST"</span>==<span class="hljs-keyword">this</span>.method){<span class="hljs-keyword">try</span>{<span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.isBinary){xhr.setRequestHeader(<span class="hljs-string">"Content-type"</span>,<span class="hljs-string">"application/octet-stream"</span>)}<span class="hljs-keyword">else</span>{xhr.setRequestHeader(<span class="hljs-string">"Content-type"</span>,<span class="hljs-string">"text/plain;charset=UTF-8"</span>)}}<span class="hljs-keyword">catch</span>(e){}}<span class="hljs-keyword">if</span>(<span class="hljs-string">"withCredentials"</span><span class="hljs-keyword">in</span> xhr){xhr.withCredentials=<span class="hljs-literal">true</span>}<span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.hasXDR()){xhr.onload=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{self.onLoad()};xhr.onerror=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{self.onError(xhr.responseText)}}<span class="hljs-keyword">else</span>{xhr.onreadystatechange=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{<span class="hljs-keyword">if</span>(<span class="hljs-number">4</span>!=xhr.readyState)<span class="hljs-keyword">return</span>;<span class="hljs-keyword">if</span>(<span class="hljs-number">200</span>==xhr.status||<span class="hljs-number">1223</span>==xhr.status){self.onLoad()}<span class="hljs-keyword">else</span>{setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{self.onError(xhr.status)},<span class="hljs-number">0</span>)}}}debug(<span class="hljs-string">"xhr data %s"</span>,<span class="hljs-keyword">this</span>.data);xhr.send(<span class="hljs-keyword">this</span>.data)}<span class="hljs-keyword">catch</span>(e){setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{self.onError(e)},<span class="hljs-number">0</span>);<span class="hljs-keyword">return</span>}<span class="hljs-keyword">if</span>(global.document){<span class="hljs-keyword">this</span>.index=Request.requestsCount++;Request.requests[<span class="hljs-keyword">this</span>.index]=<span class="hljs-keyword">this</span>}};Request.prototype.onSuccess=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{<span class="hljs-keyword">this</span>.emit(<span class="hljs-string">"success"</span>);<span class="hljs-keyword">this</span>.cleanup()};Request.prototype.onData=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">data</span>)</span>{<span class="hljs-keyword">this</span>.emit(<span class="hljs-string">"data"</span>,data);<span class="hljs-keyword">this</span>.onSuccess()};Request.prototype.onError=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">err</span>)</span>{<span class="hljs-keyword">this</span>.emit(<span class="hljs-string">"error"</span>,err);<span class="hljs-keyword">this</span>.cleanup(<span class="hljs-literal">true</span>)};Request.prototype.cleanup=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">fromError</span>)</span>{<span class="hljs-keyword">if</span>(<span class="hljs-string">"undefined"</span>==<span class="hljs-keyword">typeof</span> <span class="hljs-keyword">this</span>.xhr||<span class="hljs-literal">null</span>===<span class="hljs-keyword">this</span>.xhr){<span class="hljs-keyword">return</span>}<span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.hasXDR()){<span class="hljs-keyword">this</span>.xhr.onload=<span class="hljs-keyword">this</span>.xhr.onerror=empty}<span class="hljs-keyword">else</span>{<span class="hljs-keyword">this</span>.xhr.onreadystatechange=empty}<span class="hljs-keyword">if</span>(fromError){<span class="hljs-keyword">try</span>{<span class="hljs-keyword">this</span>.xhr.abort()}<span class="hljs-keyword">catch</span>(e){}}<span class="hljs-keyword">if</span>(global.document){<span class="hljs-keyword">delete</span> Request.requests[<span class="hljs-keyword">this</span>.index]}<span class="hljs-keyword">this</span>.xhr=<span class="hljs-literal">null</span>};Request.prototype.onLoad=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{<span class="hljs-keyword">var</span> data;<span class="hljs-keyword">try</span>{<span class="hljs-keyword">var</span> contentType;<span class="hljs-keyword">try</span>{contentType=<span class="hljs-keyword">this</span>.xhr.getResponseHeader(<span class="hljs-string">"Content-Type"</span>).split(<span class="hljs-string">";"</span>)[<span class="hljs-number">0</span>]}<span class="hljs-keyword">catch</span>(e){}<span class="hljs-keyword">if</span>(contentType===<span class="hljs-string">"application/octet-stream"</span>){data=<span class="hljs-keyword">this</span>.xhr.response}<span class="hljs-keyword">else</span>{<span class="hljs-keyword">if</span>(!<span class="hljs-keyword">this</span>.supportsBinary){data=<span class="hljs-keyword">this</span>.xhr.responseText}<span class="hljs-keyword">else</span>{<span class="hljs-keyword">try</span>{data=<span class="hljs-built_in">String</span>.fromCharCode.apply(<span class="hljs-literal">null</span>,<span class="hljs-keyword">new</span> <span class="hljs-built_in">Uint8Array</span>(<span class="hljs-keyword">this</span>.xhr.response))}<span class="hljs-keyword">catch</span>(e){<span class="hljs-keyword">var</span> ui8Arr=<span class="hljs-keyword">new</span> <span class="hljs-built_in">Uint8Array</span>(<span class="hljs-keyword">this</span>.xhr.response);<span class="hljs-keyword">var</span> dataArray=[];<span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> idx=<span class="hljs-number">0</span>,length=ui8Arr.length;idx&lt;length;idx++){dataArray.push(ui8Arr[idx])}data=<span class="hljs-built_in">String</span>.fromCharCode.apply(<span class="hljs-literal">null</span>,dataArray)}}}}<span class="hljs-keyword">catch</span>(e){<span class="hljs-keyword">this</span>.onError(e)}<span class="hljs-keyword">if</span>(<span class="hljs-literal">null</span>!=data){<span class="hljs-keyword">this</span>.onData(data)}};Request.prototype.hasXDR=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{<span class="hljs-keyword">return</span><span class="hljs-string">"undefined"</span>!==<span class="hljs-keyword">typeof</span> global.XDomainRequest&amp;&amp;!<span class="hljs-keyword">this</span>.xs&amp;&amp;<span class="hljs-keyword">this</span>.enablesXDR};Request.prototype.abort=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{<span class="hljs-keyword">this</span>.cleanup()};<span class="hljs-keyword">if</span>(global.document){Request.requestsCount=<span class="hljs-number">0</span>;Request.requests={};<span class="hljs-keyword">if</span>(global.attachEvent){global.attachEvent(<span class="hljs-string">"onunload"</span>,unloadHandler)}<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(global.addEventListener){global.addEventListener(<span class="hljs-string">"beforeunload"</span>,unloadHandler,<span class="hljs-literal">false</span>)}}<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">unloadHandler</span>(<span class="hljs-params"></span>)</span>{<span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> i <span class="hljs-keyword">in</span> Request.requests){<span class="hljs-keyword">if</span>(Request.requests.hasOwnProperty(i)){Request.requests[i].abort()}}}}).call(<span class="hljs-keyword">this</span>,<span class="hljs-keyword">typeof</span> self!==<span class="hljs-string">"undefined"</span>?self:<span class="hljs-keyword">typeof</span> <span class="hljs-built_in">window</span>!==<span class="hljs-string">"undefined"</span>?<span class="hljs-built_in">window</span>:<span class="hljs-keyword">typeof</span> global!==<span class="hljs-string">"undefined"</span>?global:{})},{<span class="hljs-string">"./polling"</span>:<span class="hljs-number">8</span>,<span class="hljs-string">"component-emitter"</span>:<span class="hljs-number">15</span>,<span class="hljs-string">"component-inherit"</span>:<span class="hljs-number">16</span>,<span class="hljs-attr">debug</span>:<span class="hljs-number">17</span>,<span class="hljs-string">"xmlhttprequest-ssl"</span>:<span class="hljs-number">10</span>}],<span class="hljs-number">8</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">_dereq_,module,exports</span>)</span>{<span class="hljs-keyword">var</span> Transport=_dereq_(<span class="hljs-string">"../transport"</span>);<span class="hljs-keyword">var</span> parseqs=_dereq_(<span class="hljs-string">"parseqs"</span>);<span class="hljs-keyword">var</span> parser=_dereq_(<span class="hljs-string">"engine.io-parser"</span>);<span class="hljs-keyword">var</span> inherit=_dereq_(<span class="hljs-string">"component-inherit"</span>);<span class="hljs-keyword">var</span> yeast=_dereq_(<span class="hljs-string">"yeast"</span>);<span class="hljs-keyword">var</span> debug=_dereq_(<span class="hljs-string">"debug"</span>)(<span class="hljs-string">"engine.io-client:polling"</span>);<span class="hljs-built_in">module</span>.exports=Polling;<span class="hljs-keyword">var</span> hasXHR2=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{<span class="hljs-keyword">var</span> XMLHttpRequest=_dereq_(<span class="hljs-string">"xmlhttprequest-ssl"</span>);<span class="hljs-keyword">var</span> xhr=<span class="hljs-keyword">new</span> XMLHttpRequest({<span class="hljs-attr">xdomain</span>:<span class="hljs-literal">false</span>});<span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>!=xhr.responseType}();<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Polling</span>(<span class="hljs-params">opts</span>)</span>{<span class="hljs-keyword">var</span> forceBase64=opts&amp;&amp;opts.forceBase64;<span class="hljs-keyword">if</span>(!hasXHR2||forceBase64){<span class="hljs-keyword">this</span>.supportsBinary=<span class="hljs-literal">false</span>}Transport.call(<span class="hljs-keyword">this</span>,opts)}inherit(Polling,Transport);Polling.prototype.name=<span class="hljs-string">"polling"</span>;Polling.prototype.doOpen=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{<span class="hljs-keyword">this</span>.poll()};Polling.prototype.pause=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">onPause</span>)</span>{<span class="hljs-keyword">var</span> pending=<span class="hljs-number">0</span>;<span class="hljs-keyword">var</span> self=<span class="hljs-keyword">this</span>;<span class="hljs-keyword">this</span>.readyState=<span class="hljs-string">"pausing"</span>;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">pause</span>(<span class="hljs-params"></span>)</span>{debug(<span class="hljs-string">"paused"</span>);self.readyState=<span class="hljs-string">"paused"</span>;onPause()}<span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.polling||!<span class="hljs-keyword">this</span>.writable){<span class="hljs-keyword">var</span> total=<span class="hljs-number">0</span>;<span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.polling){debug(<span class="hljs-string">"we are currently polling - waiting to pause"</span>);total++;<span class="hljs-keyword">this</span>.once(<span class="hljs-string">"pollComplete"</span>,<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{debug(<span class="hljs-string">"pre-pause polling complete"</span>);--total||pause()})}<span class="hljs-keyword">if</span>(!<span class="hljs-keyword">this</span>.writable){debug(<span class="hljs-string">"we are currently writing - waiting to pause"</span>);total++;<span class="hljs-keyword">this</span>.once(<span class="hljs-string">"drain"</span>,<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{debug(<span class="hljs-string">"pre-pause writing complete"</span>);--total||pause()})}}<span class="hljs-keyword">else</span>{pause()}};Polling.prototype.poll=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{debug(<span class="hljs-string">"polling"</span>);<span class="hljs-keyword">this</span>.polling=<span class="hljs-literal">true</span>;<span class="hljs-keyword">this</span>.doPoll();<span class="hljs-keyword">this</span>.emit(<span class="hljs-string">"poll"</span>)};Polling.prototype.onData=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">data</span>)</span>{<span class="hljs-keyword">var</span> self=<span class="hljs-keyword">this</span>;debug(<span class="hljs-string">"polling got data %s"</span>,data);<span class="hljs-keyword">var</span> callback=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">packet,index,total</span>)</span>{<span class="hljs-keyword">if</span>(<span class="hljs-string">"opening"</span>==self.readyState){self.onOpen()}<span class="hljs-keyword">if</span>(<span class="hljs-string">"close"</span>==packet.type){self.onClose();<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>}self.onPacket(packet)};parser.decodePayload(data,<span class="hljs-keyword">this</span>.socket.binaryType,callback);<span class="hljs-keyword">if</span>(<span class="hljs-string">"closed"</span>!=<span class="hljs-keyword">this</span>.readyState){<span class="hljs-keyword">this</span>.polling=<span class="hljs-literal">false</span>;<span class="hljs-keyword">this</span>.emit(<span class="hljs-string">"pollComplete"</span>);<span class="hljs-keyword">if</span>(<span class="hljs-string">"open"</span>==<span class="hljs-keyword">this</span>.readyState){<span class="hljs-keyword">this</span>.poll()}<span class="hljs-keyword">else</span>{debug(<span class="hljs-string">'ignoring poll - transport state "%s"'</span>,<span class="hljs-keyword">this</span>.readyState)}}};Polling.prototype.doClose=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{<span class="hljs-keyword">var</span> self=<span class="hljs-keyword">this</span>;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">close</span>(<span class="hljs-params"></span>)</span>{debug(<span class="hljs-string">"writing close packet"</span>);self.write([{<span class="hljs-attr">type</span>:<span class="hljs-string">"close"</span>}])}<span class="hljs-keyword">if</span>(<span class="hljs-string">"open"</span>==<span class="hljs-keyword">this</span>.readyState){debug(<span class="hljs-string">"transport open - closing"</span>);close()}<span class="hljs-keyword">else</span>{debug(<span class="hljs-string">"transport not open - deferring close"</span>);<span class="hljs-keyword">this</span>.once(<span class="hljs-string">"open"</span>,close)}};Polling.prototype.write=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">packets</span>)</span>{<span class="hljs-keyword">var</span> self=<span class="hljs-keyword">this</span>;<span class="hljs-keyword">this</span>.writable=<span class="hljs-literal">false</span>;<span class="hljs-keyword">var</span> callbackfn=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{self.writable=<span class="hljs-literal">true</span>;self.emit(<span class="hljs-string">"drain"</span>)};<span class="hljs-keyword">var</span> self=<span class="hljs-keyword">this</span>;parser.encodePayload(packets,<span class="hljs-keyword">this</span>.supportsBinary,<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">data</span>)</span>{self.doWrite(data,callbackfn)})};Polling.prototype.uri=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{<span class="hljs-keyword">var</span> query=<span class="hljs-keyword">this</span>.query||{};<span class="hljs-keyword">var</span> schema=<span class="hljs-keyword">this</span>.secure?<span class="hljs-string">"https"</span>:<span class="hljs-string">"http"</span>;<span class="hljs-keyword">var</span> port=<span class="hljs-string">""</span>;<span class="hljs-keyword">if</span>(<span class="hljs-literal">false</span>!==<span class="hljs-keyword">this</span>.timestampRequests){query[<span class="hljs-keyword">this</span>.timestampParam]=yeast()}<span class="hljs-keyword">if</span>(!<span class="hljs-keyword">this</span>.supportsBinary&amp;&amp;!query.sid){query.b64=<span class="hljs-number">1</span>}query=parseqs.encode(query);<span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.port&amp;&amp;(<span class="hljs-string">"https"</span>==schema&amp;&amp;<span class="hljs-keyword">this</span>.port!=<span class="hljs-number">443</span>||<span class="hljs-string">"http"</span>==schema&amp;&amp;<span class="hljs-keyword">this</span>.port!=<span class="hljs-number">80</span>)){port=<span class="hljs-string">":"</span>+<span class="hljs-keyword">this</span>.port}<span class="hljs-keyword">if</span>(query.length){query=<span class="hljs-string">"?"</span>+query}<span class="hljs-keyword">var</span> ipv6=<span class="hljs-keyword">this</span>.hostname.indexOf(<span class="hljs-string">":"</span>)!==<span class="hljs-number">-1</span>;<span class="hljs-keyword">return</span> schema+<span class="hljs-string">"://"</span>+(ipv6?<span class="hljs-string">"["</span>+<span class="hljs-keyword">this</span>.hostname+<span class="hljs-string">"]"</span>:<span class="hljs-keyword">this</span>.hostname)+port+<span class="hljs-keyword">this</span>.path+query}},{<span class="hljs-string">"../transport"</span>:<span class="hljs-number">4</span>,<span class="hljs-string">"component-inherit"</span>:<span class="hljs-number">16</span>,<span class="hljs-attr">debug</span>:<span class="hljs-number">17</span>,<span class="hljs-string">"engine.io-parser"</span>:<span class="hljs-number">19</span>,<span class="hljs-attr">parseqs</span>:<span class="hljs-number">27</span>,<span class="hljs-string">"xmlhttprequest-ssl"</span>:<span class="hljs-number">10</span>,<span class="hljs-attr">yeast</span>:<span class="hljs-number">30</span>}],<span class="hljs-number">9</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">_dereq_,module,exports</span>)</span>{(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">global</span>)</span>{<span class="hljs-keyword">var</span> Transport=_dereq_(<span class="hljs-string">"../transport"</span>);<span class="hljs-keyword">var</span> parser=_dereq_(<span class="hljs-string">"engine.io-parser"</span>);<span class="hljs-keyword">var</span> parseqs=_dereq_(<span class="hljs-string">"parseqs"</span>);<span class="hljs-keyword">var</span> inherit=_dereq_(<span class="hljs-string">"component-inherit"</span>);<span class="hljs-keyword">var</span> yeast=_dereq_(<span class="hljs-string">"yeast"</span>);<span class="hljs-keyword">var</span> debug=_dereq_(<span class="hljs-string">"debug"</span>)(<span class="hljs-string">"engine.io-client:websocket"</span>);<span class="hljs-keyword">var</span> BrowserWebSocket=global.WebSocket||global.MozWebSocket;<span class="hljs-keyword">var</span> WebSocket=BrowserWebSocket;<span class="hljs-keyword">if</span>(!WebSocket&amp;&amp;<span class="hljs-keyword">typeof</span> <span class="hljs-built_in">window</span>===<span class="hljs-string">"undefined"</span>){<span class="hljs-keyword">try</span>{WebSocket=_dereq_(<span class="hljs-string">"ws"</span>)}<span class="hljs-keyword">catch</span>(e){}}<span class="hljs-built_in">module</span>.exports=WS;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">WS</span>(<span class="hljs-params">opts</span>)</span>{<span class="hljs-keyword">var</span> forceBase64=opts&amp;&amp;opts.forceBase64;<span class="hljs-keyword">if</span>(forceBase64){<span class="hljs-keyword">this</span>.supportsBinary=<span class="hljs-literal">false</span>}<span class="hljs-keyword">this</span>.perMessageDeflate=opts.perMessageDeflate;Transport.call(<span class="hljs-keyword">this</span>,opts)}inherit(WS,Transport);WS.prototype.name=<span class="hljs-string">"websocket"</span>;WS.prototype.supportsBinary=<span class="hljs-literal">true</span>;WS.prototype.doOpen=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{<span class="hljs-keyword">if</span>(!<span class="hljs-keyword">this</span>.check()){<span class="hljs-keyword">return</span>}<span class="hljs-keyword">var</span> self=<span class="hljs-keyword">this</span>;<span class="hljs-keyword">var</span> uri=<span class="hljs-keyword">this</span>.uri();<span class="hljs-keyword">var</span> protocols=<span class="hljs-keyword">void</span> <span class="hljs-number">0</span>;<span class="hljs-keyword">var</span> opts={<span class="hljs-attr">agent</span>:<span class="hljs-keyword">this</span>.agent,<span class="hljs-attr">perMessageDeflate</span>:<span class="hljs-keyword">this</span>.perMessageDeflate};opts.pfx=<span class="hljs-keyword">this</span>.pfx;opts.key=<span class="hljs-keyword">this</span>.key;opts.passphrase=<span class="hljs-keyword">this</span>.passphrase;opts.cert=<span class="hljs-keyword">this</span>.cert;opts.ca=<span class="hljs-keyword">this</span>.ca;opts.ciphers=<span class="hljs-keyword">this</span>.ciphers;opts.rejectUnauthorized=<span class="hljs-keyword">this</span>.rejectUnauthorized;<span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.extraHeaders){opts.headers=<span class="hljs-keyword">this</span>.extraHeaders}<span class="hljs-keyword">this</span>.ws=BrowserWebSocket?<span class="hljs-keyword">new</span> WebSocket(uri):<span class="hljs-keyword">new</span> WebSocket(uri,protocols,opts);<span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.ws.binaryType===<span class="hljs-literal">undefined</span>){<span class="hljs-keyword">this</span>.supportsBinary=<span class="hljs-literal">false</span>}<span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.ws.supports&amp;&amp;<span class="hljs-keyword">this</span>.ws.supports.binary){<span class="hljs-keyword">this</span>.supportsBinary=<span class="hljs-literal">true</span>;<span class="hljs-keyword">this</span>.ws.binaryType=<span class="hljs-string">"buffer"</span>}<span class="hljs-keyword">else</span>{<span class="hljs-keyword">this</span>.ws.binaryType=<span class="hljs-string">"arraybuffer"</span>}<span class="hljs-keyword">this</span>.addEventListeners()};WS.prototype.addEventListeners=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{<span class="hljs-keyword">var</span> self=<span class="hljs-keyword">this</span>;<span class="hljs-keyword">this</span>.ws.onopen=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{self.onOpen()};<span class="hljs-keyword">this</span>.ws.onclose=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{self.onClose()};<span class="hljs-keyword">this</span>.ws.onmessage=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">ev</span>)</span>{self.onData(ev.data)};<span class="hljs-keyword">this</span>.ws.onerror=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>)</span>{self.onError(<span class="hljs-string">"websocket error"</span>,e)}};<span class="hljs-keyword">if</span>(<span class="hljs-string">"undefined"</span>!=<span class="hljs-keyword">typeof</span> navigator&amp;&amp;<span class="hljs-regexp">/iPad|iPhone|iPod/i</span>.test(navigator.userAgent)){WS.prototype.onData=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">data</span>)</span>{<span class="hljs-keyword">var</span> self=<span class="hljs-keyword">this</span>;setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{Transport.prototype.onData.call(self,data)},<span class="hljs-number">0</span>)}}WS.prototype.write=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">packets</span>)</span>{<span class="hljs-keyword">var</span> self=<span class="hljs-keyword">this</span>;<span class="hljs-keyword">this</span>.writable=<span class="hljs-literal">false</span>;<span class="hljs-keyword">var</span> total=packets.length;<span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> i=<span class="hljs-number">0</span>,l=total;i&lt;l;i++){(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">packet</span>)</span>{parser.encodePacket(packet,self.supportsBinary,<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">data</span>)</span>{<span class="hljs-keyword">if</span>(!BrowserWebSocket){<span class="hljs-keyword">var</span> opts={};<span class="hljs-keyword">if</span>(packet.options){opts.compress=packet.options.compress}<span class="hljs-keyword">if</span>(self.perMessageDeflate){<span class="hljs-keyword">var</span> len=<span class="hljs-string">"string"</span>==<span class="hljs-keyword">typeof</span> data?global.Buffer.byteLength(data):data.length;<span class="hljs-keyword">if</span>(len&lt;self.perMessageDeflate.threshold){opts.compress=<span class="hljs-literal">false</span>}}}<span class="hljs-keyword">try</span>{<span class="hljs-keyword">if</span>(BrowserWebSocket){self.ws.send(data)}<span class="hljs-keyword">else</span>{self.ws.send(data,opts)}}<span class="hljs-keyword">catch</span>(e){debug(<span class="hljs-string">"websocket closed before onclose event"</span>)}--total||done()})})(packets[i])}<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">done</span>(<span class="hljs-params"></span>)</span>{self.emit(<span class="hljs-string">"flush"</span>);setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{self.writable=<span class="hljs-literal">true</span>;self.emit(<span class="hljs-string">"drain"</span>)},<span class="hljs-number">0</span>)}};WS.prototype.onClose=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{Transport.prototype.onClose.call(<span class="hljs-keyword">this</span>)};WS.prototype.doClose=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{<span class="hljs-keyword">if</span>(<span class="hljs-keyword">typeof</span> <span class="hljs-keyword">this</span>.ws!==<span class="hljs-string">"undefined"</span>){<span class="hljs-keyword">this</span>.ws.close()}};WS.prototype.uri=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{<span class="hljs-keyword">var</span> query=<span class="hljs-keyword">this</span>.query||{};<span class="hljs-keyword">var</span> schema=<span class="hljs-keyword">this</span>.secure?<span class="hljs-string">"wss"</span>:<span class="hljs-string">"ws"</span>;<span class="hljs-keyword">var</span> port=<span class="hljs-string">""</span>;<span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.port&amp;&amp;(<span class="hljs-string">"wss"</span>==schema&amp;&amp;<span class="hljs-keyword">this</span>.port!=<span class="hljs-number">443</span>||<span class="hljs-string">"ws"</span>==schema&amp;&amp;<span class="hljs-keyword">this</span>.port!=<span class="hljs-number">80</span>)){port=<span class="hljs-string">":"</span>+<span class="hljs-keyword">this</span>.port}<span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.timestampRequests){query[<span class="hljs-keyword">this</span>.timestampParam]=yeast()}<span class="hljs-keyword">if</span>(!<span class="hljs-keyword">this</span>.supportsBinary){query.b64=<span class="hljs-number">1</span>}query=parseqs.encode(query);<span class="hljs-keyword">if</span>(query.length){query=<span class="hljs-string">"?"</span>+query}<span class="hljs-keyword">var</span> ipv6=<span class="hljs-keyword">this</span>.hostname.indexOf(<span class="hljs-string">":"</span>)!==<span class="hljs-number">-1</span>;<span class="hljs-keyword">return</span> schema+<span class="hljs-string">"://"</span>+(ipv6?<span class="hljs-string">"["</span>+<span class="hljs-keyword">this</span>.hostname+<span class="hljs-string">"]"</span>:<span class="hljs-keyword">this</span>.hostname)+port+<span class="hljs-keyword">this</span>.path+query};WS.prototype.check=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{<span class="hljs-keyword">return</span>!!WebSocket&amp;&amp;!(<span class="hljs-string">"__initialize"</span><span class="hljs-keyword">in</span> WebSocket&amp;&amp;<span class="hljs-keyword">this</span>.name===WS.prototype.name)}}).call(<span class="hljs-keyword">this</span>,<span class="hljs-keyword">typeof</span> self!==<span class="hljs-string">"undefined"</span>?self:<span class="hljs-keyword">typeof</span> <span class="hljs-built_in">window</span>!==<span class="hljs-string">"undefined"</span>?<span class="hljs-built_in">window</span>:<span class="hljs-keyword">typeof</span> global!==<span class="hljs-string">"undefined"</span>?global:{})},{<span class="hljs-string">"../transport"</span>:<span class="hljs-number">4</span>,<span class="hljs-string">"component-inherit"</span>:<span class="hljs-number">16</span>,<span class="hljs-attr">debug</span>:<span class="hljs-number">17</span>,<span class="hljs-string">"engine.io-parser"</span>:<span class="hljs-number">19</span>,<span class="hljs-attr">parseqs</span>:<span class="hljs-number">27</span>,<span class="hljs-attr">ws</span>:<span class="hljs-literal">undefined</span>,<span class="hljs-attr">yeast</span>:<span class="hljs-number">30</span>}],<span class="hljs-number">10</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">_dereq_,module,exports</span>)</span>{<span class="hljs-keyword">var</span> hasCORS=_dereq_(<span class="hljs-string">"has-cors"</span>);<span class="hljs-built_in">module</span>.exports=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">opts</span>)</span>{<span class="hljs-keyword">var</span> xdomain=opts.xdomain;<span class="hljs-keyword">var</span> xscheme=opts.xscheme;<span class="hljs-keyword">var</span> enablesXDR=opts.enablesXDR;<span class="hljs-keyword">try</span>{<span class="hljs-keyword">if</span>(<span class="hljs-string">"undefined"</span>!=<span class="hljs-keyword">typeof</span> XMLHttpRequest&amp;&amp;(!xdomain||hasCORS)){<span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> XMLHttpRequest}}<span class="hljs-keyword">catch</span>(e){}<span class="hljs-keyword">try</span>{<span class="hljs-keyword">if</span>(<span class="hljs-string">"undefined"</span>!=<span class="hljs-keyword">typeof</span> XDomainRequest&amp;&amp;!xscheme&amp;&amp;enablesXDR){<span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> XDomainRequest}}<span class="hljs-keyword">catch</span>(e){}<span class="hljs-keyword">if</span>(!xdomain){<span class="hljs-keyword">try</span>{<span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> ActiveXObject(<span class="hljs-string">"Microsoft.XMLHTTP"</span>)}<span class="hljs-keyword">catch</span>(e){}}}},{<span class="hljs-string">"has-cors"</span>:<span class="hljs-number">22</span>}],<span class="hljs-number">11</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">_dereq_,module,exports</span>)</span>{<span class="hljs-built_in">module</span>.exports=after;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">after</span>(<span class="hljs-params">count,callback,err_cb</span>)</span>{<span class="hljs-keyword">var</span> bail=<span class="hljs-literal">false</span>;err_cb=err_cb||noop;proxy.count=count;<span class="hljs-keyword">return</span> count===<span class="hljs-number">0</span>?callback():proxy;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">proxy</span>(<span class="hljs-params">err,result</span>)</span>{<span class="hljs-keyword">if</span>(proxy.count&lt;=<span class="hljs-number">0</span>){<span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"after called too many times"</span>)}--proxy.count;<span class="hljs-keyword">if</span>(err){bail=<span class="hljs-literal">true</span>;callback(err);callback=err_cb}<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(proxy.count===<span class="hljs-number">0</span>&amp;&amp;!bail){callback(<span class="hljs-literal">null</span>,result)}}}<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">noop</span>(<span class="hljs-params"></span>)</span>{}},{}],<span class="hljs-number">12</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">_dereq_,module,exports</span>)</span>{<span class="hljs-built_in">module</span>.exports=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">arraybuffer,start,end</span>)</span>{<span class="hljs-keyword">var</span> bytes=arraybuffer.byteLength;start=start||<span class="hljs-number">0</span>;end=end||bytes;<span class="hljs-keyword">if</span>(arraybuffer.slice){<span class="hljs-keyword">return</span> arraybuffer.slice(start,end)}<span class="hljs-keyword">if</span>(start&lt;<span class="hljs-number">0</span>){start+=bytes}<span class="hljs-keyword">if</span>(end&lt;<span class="hljs-number">0</span>){end+=bytes}<span class="hljs-keyword">if</span>(end&gt;bytes){end=bytes}<span class="hljs-keyword">if</span>(start&gt;=bytes||start&gt;=end||bytes===<span class="hljs-number">0</span>){<span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">ArrayBuffer</span>(<span class="hljs-number">0</span>)}<span class="hljs-keyword">var</span> abv=<span class="hljs-keyword">new</span> <span class="hljs-built_in">Uint8Array</span>(arraybuffer);<span class="hljs-keyword">var</span> result=<span class="hljs-keyword">new</span> <span class="hljs-built_in">Uint8Array</span>(end-start);<span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> i=start,ii=<span class="hljs-number">0</span>;i&lt;end;i++,ii++){result[ii]=abv[i]}<span class="hljs-keyword">return</span> result.buffer}},{}],<span class="hljs-number">13</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">_dereq_,module,exports</span>)</span>{(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">chars</span>)</span>{<span class="hljs-string">"use strict"</span>;exports.encode=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">arraybuffer</span>)</span>{<span class="hljs-keyword">var</span> bytes=<span class="hljs-keyword">new</span> <span class="hljs-built_in">Uint8Array</span>(arraybuffer),i,len=bytes.length,base64=<span class="hljs-string">""</span>;<span class="hljs-keyword">for</span>(i=<span class="hljs-number">0</span>;i&lt;len;i+=<span class="hljs-number">3</span>){base64+=chars[bytes[i]&gt;&gt;<span class="hljs-number">2</span>];
base64+=chars[(bytes[i]&amp;<span class="hljs-number">3</span>)&lt;&lt;<span class="hljs-number">4</span>|bytes[i+<span class="hljs-number">1</span>]&gt;&gt;<span class="hljs-number">4</span>];base64+=chars[(bytes[i+<span class="hljs-number">1</span>]&amp;<span class="hljs-number">15</span>)&lt;&lt;<span class="hljs-number">2</span>|bytes[i+<span class="hljs-number">2</span>]&gt;&gt;<span class="hljs-number">6</span>];base64+=chars[bytes[i+<span class="hljs-number">2</span>]&amp;<span class="hljs-number">63</span>]}<span class="hljs-keyword">if</span>(len%<span class="hljs-number">3</span>===<span class="hljs-number">2</span>){base64=base64.substring(<span class="hljs-number">0</span>,base64.length<span class="hljs-number">-1</span>)+<span class="hljs-string">"="</span>}<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(len%<span class="hljs-number">3</span>===<span class="hljs-number">1</span>){base64=base64.substring(<span class="hljs-number">0</span>,base64.length<span class="hljs-number">-2</span>)+<span class="hljs-string">"=="</span>}<span class="hljs-keyword">return</span> base64};exports.decode=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">base64</span>)</span>{<span class="hljs-keyword">var</span> bufferLength=base64.length*<span class="hljs-number">.75</span>,len=base64.length,i,p=<span class="hljs-number">0</span>,encoded1,encoded2,encoded3,encoded4;<span class="hljs-keyword">if</span>(base64[base64.length<span class="hljs-number">-1</span>]===<span class="hljs-string">"="</span>){bufferLength--;<span class="hljs-keyword">if</span>(base64[base64.length<span class="hljs-number">-2</span>]===<span class="hljs-string">"="</span>){bufferLength--}}<span class="hljs-keyword">var</span> arraybuffer=<span class="hljs-keyword">new</span> <span class="hljs-built_in">ArrayBuffer</span>(bufferLength),bytes=<span class="hljs-keyword">new</span> <span class="hljs-built_in">Uint8Array</span>(arraybuffer);<span class="hljs-keyword">for</span>(i=<span class="hljs-number">0</span>;i&lt;len;i+=<span class="hljs-number">4</span>){encoded1=chars.indexOf(base64[i]);encoded2=chars.indexOf(base64[i+<span class="hljs-number">1</span>]);encoded3=chars.indexOf(base64[i+<span class="hljs-number">2</span>]);encoded4=chars.indexOf(base64[i+<span class="hljs-number">3</span>]);bytes[p++]=encoded1&lt;&lt;<span class="hljs-number">2</span>|encoded2&gt;&gt;<span class="hljs-number">4</span>;bytes[p++]=(encoded2&amp;<span class="hljs-number">15</span>)&lt;&lt;<span class="hljs-number">4</span>|encoded3&gt;&gt;<span class="hljs-number">2</span>;bytes[p++]=(encoded3&amp;<span class="hljs-number">3</span>)&lt;&lt;<span class="hljs-number">6</span>|encoded4&amp;<span class="hljs-number">63</span>}<span class="hljs-keyword">return</span> arraybuffer}})(<span class="hljs-string">"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"</span>)},{}],<span class="hljs-number">14</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">_dereq_,module,exports</span>)</span>{(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">global</span>)</span>{<span class="hljs-keyword">var</span> BlobBuilder=global.BlobBuilder||global.WebKitBlobBuilder||global.MSBlobBuilder||global.MozBlobBuilder;<span class="hljs-keyword">var</span> blobSupported=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{<span class="hljs-keyword">try</span>{<span class="hljs-keyword">var</span> a=<span class="hljs-keyword">new</span> Blob([<span class="hljs-string">"hi"</span>]);<span class="hljs-keyword">return</span> a.size===<span class="hljs-number">2</span>}<span class="hljs-keyword">catch</span>(e){<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>}}();<span class="hljs-keyword">var</span> blobSupportsArrayBufferView=blobSupported&amp;&amp;<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{<span class="hljs-keyword">try</span>{<span class="hljs-keyword">var</span> b=<span class="hljs-keyword">new</span> Blob([<span class="hljs-keyword">new</span> <span class="hljs-built_in">Uint8Array</span>([<span class="hljs-number">1</span>,<span class="hljs-number">2</span>])]);<span class="hljs-keyword">return</span> b.size===<span class="hljs-number">2</span>}<span class="hljs-keyword">catch</span>(e){<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>}}();<span class="hljs-keyword">var</span> blobBuilderSupported=BlobBuilder&amp;&amp;BlobBuilder.prototype.append&amp;&amp;BlobBuilder.prototype.getBlob;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">mapArrayBufferViews</span>(<span class="hljs-params">ary</span>)</span>{<span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> i=<span class="hljs-number">0</span>;i&lt;ary.length;i++){<span class="hljs-keyword">var</span> chunk=ary[i];<span class="hljs-keyword">if</span>(chunk.buffer <span class="hljs-keyword">instanceof</span> <span class="hljs-built_in">ArrayBuffer</span>){<span class="hljs-keyword">var</span> buf=chunk.buffer;<span class="hljs-keyword">if</span>(chunk.byteLength!==buf.byteLength){<span class="hljs-keyword">var</span> copy=<span class="hljs-keyword">new</span> <span class="hljs-built_in">Uint8Array</span>(chunk.byteLength);copy.set(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Uint8Array</span>(buf,chunk.byteOffset,chunk.byteLength));buf=copy.buffer}ary[i]=buf}}}<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">BlobBuilderConstructor</span>(<span class="hljs-params">ary,options</span>)</span>{options=options||{};<span class="hljs-keyword">var</span> bb=<span class="hljs-keyword">new</span> BlobBuilder;mapArrayBufferViews(ary);<span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> i=<span class="hljs-number">0</span>;i&lt;ary.length;i++){bb.append(ary[i])}<span class="hljs-keyword">return</span> options.type?bb.getBlob(options.type):bb.getBlob()}<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">BlobConstructor</span>(<span class="hljs-params">ary,options</span>)</span>{mapArrayBufferViews(ary);<span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Blob(ary,options||{})}<span class="hljs-built_in">module</span>.exports=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{<span class="hljs-keyword">if</span>(blobSupported){<span class="hljs-keyword">return</span> blobSupportsArrayBufferView?global.Blob:BlobConstructor}<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(blobBuilderSupported){<span class="hljs-keyword">return</span> BlobBuilderConstructor}<span class="hljs-keyword">else</span>{<span class="hljs-keyword">return</span> <span class="hljs-literal">undefined</span>}}()}).call(<span class="hljs-keyword">this</span>,<span class="hljs-keyword">typeof</span> self!==<span class="hljs-string">"undefined"</span>?self:<span class="hljs-keyword">typeof</span> <span class="hljs-built_in">window</span>!==<span class="hljs-string">"undefined"</span>?<span class="hljs-built_in">window</span>:<span class="hljs-keyword">typeof</span> global!==<span class="hljs-string">"undefined"</span>?global:{})},{}],<span class="hljs-number">15</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">_dereq_,module,exports</span>)</span>{<span class="hljs-built_in">module</span>.exports=Emitter;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Emitter</span>(<span class="hljs-params">obj</span>)</span>{<span class="hljs-keyword">if</span>(obj)<span class="hljs-keyword">return</span> mixin(obj)}<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">mixin</span>(<span class="hljs-params">obj</span>)</span>{<span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> key <span class="hljs-keyword">in</span> Emitter.prototype){obj[key]=Emitter.prototype[key]}<span class="hljs-keyword">return</span> obj}Emitter.prototype.on=Emitter.prototype.addEventListener=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">event,fn</span>)</span>{<span class="hljs-keyword">this</span>._callbacks=<span class="hljs-keyword">this</span>._callbacks||{};(<span class="hljs-keyword">this</span>._callbacks[event]=<span class="hljs-keyword">this</span>._callbacks[event]||[]).push(fn);<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>};Emitter.prototype.once=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">event,fn</span>)</span>{<span class="hljs-keyword">var</span> self=<span class="hljs-keyword">this</span>;<span class="hljs-keyword">this</span>._callbacks=<span class="hljs-keyword">this</span>._callbacks||{};<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">on</span>(<span class="hljs-params"></span>)</span>{self.off(event,on);fn.apply(<span class="hljs-keyword">this</span>,<span class="hljs-built_in">arguments</span>)}on.fn=fn;<span class="hljs-keyword">this</span>.on(event,on);<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>};Emitter.prototype.off=Emitter.prototype.removeListener=Emitter.prototype.removeAllListeners=Emitter.prototype.removeEventListener=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">event,fn</span>)</span>{<span class="hljs-keyword">this</span>._callbacks=<span class="hljs-keyword">this</span>._callbacks||{};<span class="hljs-keyword">if</span>(<span class="hljs-number">0</span>==<span class="hljs-built_in">arguments</span>.length){<span class="hljs-keyword">this</span>._callbacks={};<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>}<span class="hljs-keyword">var</span> callbacks=<span class="hljs-keyword">this</span>._callbacks[event];<span class="hljs-keyword">if</span>(!callbacks)<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;<span class="hljs-keyword">if</span>(<span class="hljs-number">1</span>==<span class="hljs-built_in">arguments</span>.length){<span class="hljs-keyword">delete</span> <span class="hljs-keyword">this</span>._callbacks[event];<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>}<span class="hljs-keyword">var</span> cb;<span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> i=<span class="hljs-number">0</span>;i&lt;callbacks.length;i++){cb=callbacks[i];<span class="hljs-keyword">if</span>(cb===fn||cb.fn===fn){callbacks.splice(i,<span class="hljs-number">1</span>);<span class="hljs-keyword">break</span>}}<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>};Emitter.prototype.emit=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">event</span>)</span>{<span class="hljs-keyword">this</span>._callbacks=<span class="hljs-keyword">this</span>._callbacks||{};<span class="hljs-keyword">var</span> args=[].slice.call(<span class="hljs-built_in">arguments</span>,<span class="hljs-number">1</span>),callbacks=<span class="hljs-keyword">this</span>._callbacks[event];<span class="hljs-keyword">if</span>(callbacks){callbacks=callbacks.slice(<span class="hljs-number">0</span>);<span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> i=<span class="hljs-number">0</span>,len=callbacks.length;i&lt;len;++i){callbacks[i].apply(<span class="hljs-keyword">this</span>,args)}}<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>};Emitter.prototype.listeners=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">event</span>)</span>{<span class="hljs-keyword">this</span>._callbacks=<span class="hljs-keyword">this</span>._callbacks||{};<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._callbacks[event]||[]};Emitter.prototype.hasListeners=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">event</span>)</span>{<span class="hljs-keyword">return</span>!!<span class="hljs-keyword">this</span>.listeners(event).length}},{}],<span class="hljs-number">16</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">_dereq_,module,exports</span>)</span>{<span class="hljs-built_in">module</span>.exports=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a,b</span>)</span>{<span class="hljs-keyword">var</span> fn=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{};fn.prototype=b.prototype;a.prototype=<span class="hljs-keyword">new</span> fn;a.prototype.constructor=a}},{}],<span class="hljs-number">17</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">_dereq_,module,exports</span>)</span>{exports=<span class="hljs-built_in">module</span>.exports=_dereq_(<span class="hljs-string">"./debug"</span>);exports.log=log;exports.formatArgs=formatArgs;exports.save=save;exports.load=load;exports.useColors=useColors;exports.storage=<span class="hljs-string">"undefined"</span>!=<span class="hljs-keyword">typeof</span> chrome&amp;&amp;<span class="hljs-string">"undefined"</span>!=<span class="hljs-keyword">typeof</span> chrome.storage?chrome.storage.local:localstorage();exports.colors=[<span class="hljs-string">"lightseagreen"</span>,<span class="hljs-string">"forestgreen"</span>,<span class="hljs-string">"goldenrod"</span>,<span class="hljs-string">"dodgerblue"</span>,<span class="hljs-string">"darkorchid"</span>,<span class="hljs-string">"crimson"</span>];<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">useColors</span>(<span class="hljs-params"></span>)</span>{<span class="hljs-keyword">return</span><span class="hljs-string">"WebkitAppearance"</span><span class="hljs-keyword">in</span> <span class="hljs-built_in">document</span>.documentElement.style||<span class="hljs-built_in">window</span>.console&amp;&amp;(<span class="hljs-built_in">console</span>.firebug||<span class="hljs-built_in">console</span>.exception&amp;&amp;<span class="hljs-built_in">console</span>.table)||navigator.userAgent.toLowerCase().match(<span class="hljs-regexp">/firefox\/(\d+)/</span>)&amp;&amp;<span class="hljs-built_in">parseInt</span>(<span class="hljs-built_in">RegExp</span>.$<span class="hljs-number">1</span>,<span class="hljs-number">10</span>)&gt;=<span class="hljs-number">31</span>}exports.formatters.j=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">v</span>)</span>{<span class="hljs-keyword">return</span> <span class="hljs-built_in">JSON</span>.stringify(v)};<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">formatArgs</span>(<span class="hljs-params"></span>)</span>{<span class="hljs-keyword">var</span> args=<span class="hljs-built_in">arguments</span>;<span class="hljs-keyword">var</span> useColors=<span class="hljs-keyword">this</span>.useColors;args[<span class="hljs-number">0</span>]=(useColors?<span class="hljs-string">"%c"</span>:<span class="hljs-string">""</span>)+<span class="hljs-keyword">this</span>.namespace+(useColors?<span class="hljs-string">" %c"</span>:<span class="hljs-string">" "</span>)+args[<span class="hljs-number">0</span>]+(useColors?<span class="hljs-string">"%c "</span>:<span class="hljs-string">" "</span>)+<span class="hljs-string">"+"</span>+exports.humanize(<span class="hljs-keyword">this</span>.diff);<span class="hljs-keyword">if</span>(!useColors)<span class="hljs-keyword">return</span> args;<span class="hljs-keyword">var</span> c=<span class="hljs-string">"color: "</span>+<span class="hljs-keyword">this</span>.color;args=[args[<span class="hljs-number">0</span>],c,<span class="hljs-string">"color: inherit"</span>].concat(<span class="hljs-built_in">Array</span>.prototype.slice.call(args,<span class="hljs-number">1</span>));<span class="hljs-keyword">var</span> index=<span class="hljs-number">0</span>;<span class="hljs-keyword">var</span> lastC=<span class="hljs-number">0</span>;args[<span class="hljs-number">0</span>].replace(<span class="hljs-regexp">/%[a-z%]/g</span>,<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">match</span>)</span>{<span class="hljs-keyword">if</span>(<span class="hljs-string">"%%"</span>===match)<span class="hljs-keyword">return</span>;index++;<span class="hljs-keyword">if</span>(<span class="hljs-string">"%c"</span>===match){lastC=index}});args.splice(lastC,<span class="hljs-number">0</span>,c);<span class="hljs-keyword">return</span> args}<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">log</span>(<span class="hljs-params"></span>)</span>{<span class="hljs-keyword">return</span><span class="hljs-string">"object"</span>===<span class="hljs-keyword">typeof</span> <span class="hljs-built_in">console</span>&amp;&amp;<span class="hljs-built_in">console</span>.log&amp;&amp;<span class="hljs-built_in">Function</span>.prototype.apply.call(<span class="hljs-built_in">console</span>.log,<span class="hljs-built_in">console</span>,<span class="hljs-built_in">arguments</span>)}<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">save</span>(<span class="hljs-params">namespaces</span>)</span>{<span class="hljs-keyword">try</span>{<span class="hljs-keyword">if</span>(<span class="hljs-literal">null</span>==namespaces){exports.storage.removeItem(<span class="hljs-string">"debug"</span>)}<span class="hljs-keyword">else</span>{exports.storage.debug=namespaces}}<span class="hljs-keyword">catch</span>(e){}}<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">load</span>(<span class="hljs-params"></span>)</span>{<span class="hljs-keyword">var</span> r;<span class="hljs-keyword">try</span>{r=exports.storage.debug}<span class="hljs-keyword">catch</span>(e){}<span class="hljs-keyword">return</span> r}exports.enable(load());<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">localstorage</span>(<span class="hljs-params"></span>)</span>{<span class="hljs-keyword">try</span>{<span class="hljs-keyword">return</span> <span class="hljs-built_in">window</span>.localStorage}<span class="hljs-keyword">catch</span>(e){}}},{<span class="hljs-string">"./debug"</span>:<span class="hljs-number">18</span>}],<span class="hljs-number">18</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">_dereq_,module,exports</span>)</span>{exports=<span class="hljs-built_in">module</span>.exports=debug;exports.coerce=coerce;exports.disable=disable;exports.enable=enable;exports.enabled=enabled;exports.humanize=_dereq_(<span class="hljs-string">"ms"</span>);exports.names=[];exports.skips=[];exports.formatters={};<span class="hljs-keyword">var</span> prevColor=<span class="hljs-number">0</span>;<span class="hljs-keyword">var</span> prevTime;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">selectColor</span>(<span class="hljs-params"></span>)</span>{<span class="hljs-keyword">return</span> exports.colors[prevColor++%exports.colors.length]}<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">debug</span>(<span class="hljs-params">namespace</span>)</span>{<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">disabled</span>(<span class="hljs-params"></span>)</span>{}disabled.enabled=<span class="hljs-literal">false</span>;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">enabled</span>(<span class="hljs-params"></span>)</span>{<span class="hljs-keyword">var</span> self=enabled;<span class="hljs-keyword">var</span> curr=+<span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>;<span class="hljs-keyword">var</span> ms=curr-(prevTime||curr);self.diff=ms;self.prev=prevTime;self.curr=curr;prevTime=curr;<span class="hljs-keyword">if</span>(<span class="hljs-literal">null</span>==self.useColors)self.useColors=exports.useColors();<span class="hljs-keyword">if</span>(<span class="hljs-literal">null</span>==self.color&amp;&amp;self.useColors)self.color=selectColor();<span class="hljs-keyword">var</span> args=<span class="hljs-built_in">Array</span>.prototype.slice.call(<span class="hljs-built_in">arguments</span>);args[<span class="hljs-number">0</span>]=exports.coerce(args[<span class="hljs-number">0</span>]);<span class="hljs-keyword">if</span>(<span class="hljs-string">"string"</span>!==<span class="hljs-keyword">typeof</span> args[<span class="hljs-number">0</span>]){args=[<span class="hljs-string">"%o"</span>].concat(args)}<span class="hljs-keyword">var</span> index=<span class="hljs-number">0</span>;args[<span class="hljs-number">0</span>]=args[<span class="hljs-number">0</span>].replace(<span class="hljs-regexp">/%([a-z%])/g</span>,<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">match,format</span>)</span>{<span class="hljs-keyword">if</span>(match===<span class="hljs-string">"%%"</span>)<span class="hljs-keyword">return</span> match;index++;<span class="hljs-keyword">var</span> formatter=exports.formatters[format];<span class="hljs-keyword">if</span>(<span class="hljs-string">"function"</span>===<span class="hljs-keyword">typeof</span> formatter){<span class="hljs-keyword">var</span> val=args[index];match=formatter.call(self,val);args.splice(index,<span class="hljs-number">1</span>);index--}<span class="hljs-keyword">return</span> match});<span class="hljs-keyword">if</span>(<span class="hljs-string">"function"</span>===<span class="hljs-keyword">typeof</span> exports.formatArgs){args=exports.formatArgs.apply(self,args)}<span class="hljs-keyword">var</span> logFn=enabled.log||exports.log||<span class="hljs-built_in">console</span>.log.bind(<span class="hljs-built_in">console</span>);logFn.apply(self,args)}enabled.enabled=<span class="hljs-literal">true</span>;<span class="hljs-keyword">var</span> fn=exports.enabled(namespace)?enabled:disabled;fn.namespace=namespace;<span class="hljs-keyword">return</span> fn}<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">enable</span>(<span class="hljs-params">namespaces</span>)</span>{exports.save(namespaces);<span class="hljs-keyword">var</span> split=(namespaces||<span class="hljs-string">""</span>).split(<span class="hljs-regexp">/[\s,]+/</span>);<span class="hljs-keyword">var</span> len=split.length;<span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> i=<span class="hljs-number">0</span>;i&lt;len;i++){<span class="hljs-keyword">if</span>(!split[i])<span class="hljs-keyword">continue</span>;namespaces=split[i].replace(<span class="hljs-regexp">/\*/g</span>,<span class="hljs-string">".*?"</span>);<span class="hljs-keyword">if</span>(namespaces[<span class="hljs-number">0</span>]===<span class="hljs-string">"-"</span>){exports.skips.push(<span class="hljs-keyword">new</span> <span class="hljs-built_in">RegExp</span>(<span class="hljs-string">"^"</span>+namespaces.substr(<span class="hljs-number">1</span>)+<span class="hljs-string">"$"</span>))}<span class="hljs-keyword">else</span>{exports.names.push(<span class="hljs-keyword">new</span> <span class="hljs-built_in">RegExp</span>(<span class="hljs-string">"^"</span>+namespaces+<span class="hljs-string">"$"</span>))}}}<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">disable</span>(<span class="hljs-params"></span>)</span>{exports.enable(<span class="hljs-string">""</span>)}<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">enabled</span>(<span class="hljs-params">name</span>)</span>{<span class="hljs-keyword">var</span> i,len;<span class="hljs-keyword">for</span>(i=<span class="hljs-number">0</span>,len=exports.skips.length;i&lt;len;i++){<span class="hljs-keyword">if</span>(exports.skips[i].test(name)){<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>}}<span class="hljs-keyword">for</span>(i=<span class="hljs-number">0</span>,len=exports.names.length;i&lt;len;i++){<span class="hljs-keyword">if</span>(exports.names[i].test(name)){<span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>}}<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>}<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">coerce</span>(<span class="hljs-params">val</span>)</span>{<span class="hljs-keyword">if</span>(val <span class="hljs-keyword">instanceof</span> <span class="hljs-built_in">Error</span>)<span class="hljs-keyword">return</span> val.stack||val.message;<span class="hljs-keyword">return</span> val}},{<span class="hljs-attr">ms</span>:<span class="hljs-number">25</span>}],<span class="hljs-number">19</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">_dereq_,module,exports</span>)</span>{(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">global</span>)</span>{<span class="hljs-keyword">var</span> keys=_dereq_(<span class="hljs-string">"./keys"</span>);<span class="hljs-keyword">var</span> hasBinary=_dereq_(<span class="hljs-string">"has-binary"</span>);<span class="hljs-keyword">var</span> sliceBuffer=_dereq_(<span class="hljs-string">"arraybuffer.slice"</span>);<span class="hljs-keyword">var</span> base64encoder=_dereq_(<span class="hljs-string">"base64-arraybuffer"</span>);<span class="hljs-keyword">var</span> after=_dereq_(<span class="hljs-string">"after"</span>);<span class="hljs-keyword">var</span> utf8=_dereq_(<span class="hljs-string">"utf8"</span>);<span class="hljs-keyword">var</span> isAndroid=navigator.userAgent.match(<span class="hljs-regexp">/Android/i</span>);<span class="hljs-keyword">var</span> isPhantomJS=<span class="hljs-regexp">/PhantomJS/i</span>.test(navigator.userAgent);<span class="hljs-keyword">var</span> dontSendBlobs=isAndroid||isPhantomJS;exports.protocol=<span class="hljs-number">3</span>;<span class="hljs-keyword">var</span> packets=exports.packets={<span class="hljs-attr">open</span>:<span class="hljs-number">0</span>,<span class="hljs-attr">close</span>:<span class="hljs-number">1</span>,<span class="hljs-attr">ping</span>:<span class="hljs-number">2</span>,<span class="hljs-attr">pong</span>:<span class="hljs-number">3</span>,<span class="hljs-attr">message</span>:<span class="hljs-number">4</span>,<span class="hljs-attr">upgrade</span>:<span class="hljs-number">5</span>,<span class="hljs-attr">noop</span>:<span class="hljs-number">6</span>};<span class="hljs-keyword">var</span> packetslist=keys(packets);<span class="hljs-keyword">var</span> err={<span class="hljs-attr">type</span>:<span class="hljs-string">"error"</span>,<span class="hljs-attr">data</span>:<span class="hljs-string">"parser error"</span>};<span class="hljs-keyword">var</span> Blob=_dereq_(<span class="hljs-string">"blob"</span>);exports.encodePacket=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">packet,supportsBinary,utf8encode,callback</span>)</span>{<span class="hljs-keyword">if</span>(<span class="hljs-string">"function"</span>==<span class="hljs-keyword">typeof</span> supportsBinary){callback=supportsBinary;supportsBinary=<span class="hljs-literal">false</span>}<span class="hljs-keyword">if</span>(<span class="hljs-string">"function"</span>==<span class="hljs-keyword">typeof</span> utf8encode){callback=utf8encode;utf8encode=<span class="hljs-literal">null</span>}<span class="hljs-keyword">var</span> data=packet.data===<span class="hljs-literal">undefined</span>?<span class="hljs-literal">undefined</span>:packet.data.buffer||packet.data;<span class="hljs-keyword">if</span>(global.ArrayBuffer&amp;&amp;data <span class="hljs-keyword">instanceof</span> <span class="hljs-built_in">ArrayBuffer</span>){<span class="hljs-keyword">return</span> encodeArrayBuffer(packet,supportsBinary,callback)}<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(Blob&amp;&amp;data <span class="hljs-keyword">instanceof</span> global.Blob){<span class="hljs-keyword">return</span> encodeBlob(packet,supportsBinary,callback)}<span class="hljs-keyword">if</span>(data&amp;&amp;data.base64){<span class="hljs-keyword">return</span> encodeBase64Object(packet,callback)}<span class="hljs-keyword">var</span> encoded=packets[packet.type];<span class="hljs-keyword">if</span>(<span class="hljs-literal">undefined</span>!==packet.data){encoded+=utf8encode?utf8.encode(<span class="hljs-built_in">String</span>(packet.data)):<span class="hljs-built_in">String</span>(packet.data)}<span class="hljs-keyword">return</span> callback(<span class="hljs-string">""</span>+encoded)};<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">encodeBase64Object</span>(<span class="hljs-params">packet,callback</span>)</span>{<span class="hljs-keyword">var</span> message=<span class="hljs-string">"b"</span>+exports.packets[packet.type]+packet.data.data;<span class="hljs-keyword">return</span> callback(message)}<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">encodeArrayBuffer</span>(<span class="hljs-params">packet,supportsBinary,callback</span>)</span>{<span class="hljs-keyword">if</span>(!supportsBinary){<span class="hljs-keyword">return</span> exports.encodeBase64Packet(packet,callback)}<span class="hljs-keyword">var</span> data=packet.data;<span class="hljs-keyword">var</span> contentArray=<span class="hljs-keyword">new</span> <span class="hljs-built_in">Uint8Array</span>(data);<span class="hljs-keyword">var</span> resultBuffer=<span class="hljs-keyword">new</span> <span class="hljs-built_in">Uint8Array</span>(<span class="hljs-number">1</span>+data.byteLength);resultBuffer[<span class="hljs-number">0</span>]=packets[packet.type];<span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> i=<span class="hljs-number">0</span>;i&lt;contentArray.length;i++){resultBuffer[i+<span class="hljs-number">1</span>]=contentArray[i]}<span class="hljs-keyword">return</span> callback(resultBuffer.buffer)}<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">encodeBlobAsArrayBuffer</span>(<span class="hljs-params">packet,supportsBinary,callback</span>)</span>{<span class="hljs-keyword">if</span>(!supportsBinary){<span class="hljs-keyword">return</span> exports.encodeBase64Packet(packet,callback)}<span class="hljs-keyword">var</span> fr=<span class="hljs-keyword">new</span> FileReader;fr.onload=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{packet.data=fr.result;exports.encodePacket(packet,supportsBinary,<span class="hljs-literal">true</span>,callback)};<span class="hljs-keyword">return</span> fr.readAsArrayBuffer(packet.data)}<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">encodeBlob</span>(<span class="hljs-params">packet,supportsBinary,callback</span>)</span>{<span class="hljs-keyword">if</span>(!supportsBinary){<span class="hljs-keyword">return</span> exports.encodeBase64Packet(packet,callback)}<span class="hljs-keyword">if</span>(dontSendBlobs){<span class="hljs-keyword">return</span> encodeBlobAsArrayBuffer(packet,supportsBinary,callback)}<span class="hljs-keyword">var</span> length=<span class="hljs-keyword">new</span> <span class="hljs-built_in">Uint8Array</span>(<span class="hljs-number">1</span>);length[<span class="hljs-number">0</span>]=packets[packet.type];<span class="hljs-keyword">var</span> blob=<span class="hljs-keyword">new</span> Blob([length.buffer,packet.data]);<span class="hljs-keyword">return</span> callback(blob)}exports.encodeBase64Packet=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">packet,callback</span>)</span>{<span class="hljs-keyword">var</span> message=<span class="hljs-string">"b"</span>+exports.packets[packet.type];<span class="hljs-keyword">if</span>(Blob&amp;&amp;packet.data <span class="hljs-keyword">instanceof</span> global.Blob){<span class="hljs-keyword">var</span> fr=<span class="hljs-keyword">new</span> FileReader;fr.onload=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{<span class="hljs-keyword">var</span> b64=fr.result.split(<span class="hljs-string">","</span>)[<span class="hljs-number">1</span>];callback(message+b64)};<span class="hljs-keyword">return</span> fr.readAsDataURL(packet.data)}<span class="hljs-keyword">var</span> b64data;<span class="hljs-keyword">try</span>{b64data=<span class="hljs-built_in">String</span>.fromCharCode.apply(<span class="hljs-literal">null</span>,<span class="hljs-keyword">new</span> <span class="hljs-built_in">Uint8Array</span>(packet.data))}<span class="hljs-keyword">catch</span>(e){<span class="hljs-keyword">var</span> typed=<span class="hljs-keyword">new</span> <span class="hljs-built_in">Uint8Array</span>(packet.data);<span class="hljs-keyword">var</span> basic=<span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>(typed.length);<span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> i=<span class="hljs-number">0</span>;i&lt;typed.length;i++){basic[i]=typed[i]}b64data=<span class="hljs-built_in">String</span>.fromCharCode.apply(<span class="hljs-literal">null</span>,basic)}message+=global.btoa(b64data);<span class="hljs-keyword">return</span> callback(message)};exports.decodePacket=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">data,binaryType,utf8decode</span>)</span>{<span class="hljs-keyword">if</span>(<span class="hljs-keyword">typeof</span> data==<span class="hljs-string">"string"</span>||data===<span class="hljs-literal">undefined</span>){<span class="hljs-keyword">if</span>(data.charAt(<span class="hljs-number">0</span>)==<span class="hljs-string">"b"</span>){<span class="hljs-keyword">return</span> exports.decodeBase64Packet(data.substr(<span class="hljs-number">1</span>),binaryType)}<span class="hljs-keyword">if</span>(utf8decode){<span class="hljs-keyword">try</span>{data=utf8.decode(data)}<span class="hljs-keyword">catch</span>(e){<span class="hljs-keyword">return</span> err}}<span class="hljs-keyword">var</span> type=data.charAt(<span class="hljs-number">0</span>);<span class="hljs-keyword">if</span>(<span class="hljs-built_in">Number</span>(type)!=type||!packetslist[type]){<span class="hljs-keyword">return</span> err}<span class="hljs-keyword">if</span>(data.length&gt;<span class="hljs-number">1</span>){<span class="hljs-keyword">return</span>{<span class="hljs-attr">type</span>:packetslist[type],<span class="hljs-attr">data</span>:data.substring(<span class="hljs-number">1</span>)}}<span class="hljs-keyword">else</span>{<span class="hljs-keyword">return</span>{<span class="hljs-attr">type</span>:packetslist[type]}}}<span class="hljs-keyword">var</span> asArray=<span class="hljs-keyword">new</span> <span class="hljs-built_in">Uint8Array</span>(data);<span class="hljs-keyword">var</span> type=asArray[<span class="hljs-number">0</span>];<span class="hljs-keyword">var</span> rest=sliceBuffer(data,<span class="hljs-number">1</span>);<span class="hljs-keyword">if</span>(Blob&amp;&amp;binaryType===<span class="hljs-string">"blob"</span>){rest=<span class="hljs-keyword">new</span> Blob([rest])}<span class="hljs-keyword">return</span>{<span class="hljs-attr">type</span>:packetslist[type],<span class="hljs-attr">data</span>:rest}};exports.decodeBase64Packet=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">msg,binaryType</span>)</span>{<span class="hljs-keyword">var</span> type=packetslist[msg.charAt(<span class="hljs-number">0</span>)];<span class="hljs-keyword">if</span>(!global.ArrayBuffer){<span class="hljs-keyword">return</span>{<span class="hljs-attr">type</span>:type,<span class="hljs-attr">data</span>:{<span class="hljs-attr">base64</span>:<span class="hljs-literal">true</span>,<span class="hljs-attr">data</span>:msg.substr(<span class="hljs-number">1</span>)}}}<span class="hljs-keyword">var</span> data=base64encoder.decode(msg.substr(<span class="hljs-number">1</span>));<span class="hljs-keyword">if</span>(binaryType===<span class="hljs-string">"blob"</span>&amp;&amp;Blob){data=<span class="hljs-keyword">new</span> Blob([data])}<span class="hljs-keyword">return</span>{<span class="hljs-attr">type</span>:type,<span class="hljs-attr">data</span>:data}};exports.encodePayload=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">packets,supportsBinary,callback</span>)</span>{<span class="hljs-keyword">if</span>(<span class="hljs-keyword">typeof</span> supportsBinary==<span class="hljs-string">"function"</span>){callback=supportsBinary;supportsBinary=<span class="hljs-literal">null</span>}<span class="hljs-keyword">var</span> isBinary=hasBinary(packets);<span class="hljs-keyword">if</span>(supportsBinary&amp;&amp;isBinary){<span class="hljs-keyword">if</span>(Blob&amp;&amp;!dontSendBlobs){<span class="hljs-keyword">return</span> exports.encodePayloadAsBlob(packets,callback)}<span class="hljs-keyword">return</span> exports.encodePayloadAsArrayBuffer(packets,callback)}<span class="hljs-keyword">if</span>(!packets.length){<span class="hljs-keyword">return</span> callback(<span class="hljs-string">"0:"</span>)}<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">setLengthHeader</span>(<span class="hljs-params">message</span>)</span>{<span class="hljs-keyword">return</span> message.length+<span class="hljs-string">":"</span>+message}<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">encodeOne</span>(<span class="hljs-params">packet,doneCallback</span>)</span>{exports.encodePacket(packet,!isBinary?<span class="hljs-literal">false</span>:supportsBinary,<span class="hljs-literal">true</span>,<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">message</span>)</span>{doneCallback(<span class="hljs-literal">null</span>,setLengthHeader(message))})}map(packets,encodeOne,<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">err,results</span>)</span>{<span class="hljs-keyword">return</span> callback(results.join(<span class="hljs-string">""</span>))})};<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">map</span>(<span class="hljs-params">ary,each,done</span>)</span>{<span class="hljs-keyword">var</span> result=<span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>(ary.length);<span class="hljs-keyword">var</span> next=after(ary.length,done);<span class="hljs-keyword">var</span> eachWithIndex=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">i,el,cb</span>)</span>{each(el,<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">error,msg</span>)</span>{result[i]=msg;cb(error,result)})};<span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> i=<span class="hljs-number">0</span>;i&lt;ary.length;i++){eachWithIndex(i,ary[i],next)}}exports.decodePayload=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">data,binaryType,callback</span>)</span>{<span class="hljs-keyword">if</span>(<span class="hljs-keyword">typeof</span> data!=<span class="hljs-string">"string"</span>){<span class="hljs-keyword">return</span> exports.decodePayloadAsBinary(data,binaryType,callback)}<span class="hljs-keyword">if</span>(<span class="hljs-keyword">typeof</span> binaryType===<span class="hljs-string">"function"</span>){callback=binaryType;binaryType=<span class="hljs-literal">null</span>}<span class="hljs-keyword">var</span> packet;<span class="hljs-keyword">if</span>(data==<span class="hljs-string">""</span>){<span class="hljs-keyword">return</span> callback(err,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>)}<span class="hljs-keyword">var</span> length=<span class="hljs-string">""</span>,n,msg;<span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> i=<span class="hljs-number">0</span>,l=data.length;i&lt;l;i++){<span class="hljs-keyword">var</span> chr=data.charAt(i);<span class="hljs-keyword">if</span>(<span class="hljs-string">":"</span>!=chr){length+=chr}<span class="hljs-keyword">else</span>{<span class="hljs-keyword">if</span>(<span class="hljs-string">""</span>==length||length!=(n=<span class="hljs-built_in">Number</span>(length))){<span class="hljs-keyword">return</span> callback(err,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>)}msg=data.substr(i+<span class="hljs-number">1</span>,n);<span class="hljs-keyword">if</span>(length!=msg.length){<span class="hljs-keyword">return</span> callback(err,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>)}<span class="hljs-keyword">if</span>(msg.length){packet=exports.decodePacket(msg,binaryType,<span class="hljs-literal">true</span>);<span class="hljs-keyword">if</span>(err.type==packet.type&amp;&amp;err.data==packet.data){<span class="hljs-keyword">return</span> callback(err,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>)}<span class="hljs-keyword">var</span> ret=callback(packet,i+n,l);<span class="hljs-keyword">if</span>(<span class="hljs-literal">false</span>===ret)<span class="hljs-keyword">return</span>}i+=n;length=<span class="hljs-string">""</span>}}<span class="hljs-keyword">if</span>(length!=<span class="hljs-string">""</span>){<span class="hljs-keyword">return</span> callback(err,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>)}};exports.encodePayloadAsArrayBuffer=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">packets,callback</span>)</span>{<span class="hljs-keyword">if</span>(!packets.length){<span class="hljs-keyword">return</span> callback(<span class="hljs-keyword">new</span> <span class="hljs-built_in">ArrayBuffer</span>(<span class="hljs-number">0</span>))}<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">encodeOne</span>(<span class="hljs-params">packet,doneCallback</span>)</span>{exports.encodePacket(packet,<span class="hljs-literal">true</span>,<span class="hljs-literal">true</span>,<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">data</span>)</span>{<span class="hljs-keyword">return</span> doneCallback(<span class="hljs-literal">null</span>,data)})}map(packets,encodeOne,<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">err,encodedPackets</span>)</span>{<span class="hljs-keyword">var</span> totalLength=encodedPackets.reduce(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">acc,p</span>)</span>{<span class="hljs-keyword">var</span> len;<span class="hljs-keyword">if</span>(<span class="hljs-keyword">typeof</span> p===<span class="hljs-string">"string"</span>){len=p.length}<span class="hljs-keyword">else</span>{len=p.byteLength}<span class="hljs-keyword">return</span> acc+len.toString().length+len+<span class="hljs-number">2</span>},<span class="hljs-number">0</span>);<span class="hljs-keyword">var</span> resultArray=<span class="hljs-keyword">new</span> <span class="hljs-built_in">Uint8Array</span>(totalLength);<span class="hljs-keyword">var</span> bufferIndex=<span class="hljs-number">0</span>;encodedPackets.forEach(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">p</span>)</span>{<span class="hljs-keyword">var</span> isString=<span class="hljs-keyword">typeof</span> p===<span class="hljs-string">"string"</span>;<span class="hljs-keyword">var</span> ab=p;<span class="hljs-keyword">if</span>(isString){<span class="hljs-keyword">var</span> view=<span class="hljs-keyword">new</span> <span class="hljs-built_in">Uint8Array</span>(p.length);<span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> i=<span class="hljs-number">0</span>;i&lt;p.length;i++){view[i]=p.charCodeAt(i)}ab=view.buffer}<span class="hljs-keyword">if</span>(isString){resultArray[bufferIndex++]=<span class="hljs-number">0</span>}<span class="hljs-keyword">else</span>{resultArray[bufferIndex++]=<span class="hljs-number">1</span>}<span class="hljs-keyword">var</span> lenStr=ab.byteLength.toString();<span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> i=<span class="hljs-number">0</span>;i&lt;lenStr.length;i++){resultArray[bufferIndex++]=<span class="hljs-built_in">parseInt</span>(lenStr[i])}resultArray[bufferIndex++]=<span class="hljs-number">255</span>;<span class="hljs-keyword">var</span> view=<span class="hljs-keyword">new</span> <span class="hljs-built_in">Uint8Array</span>(ab);<span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> i=<span class="hljs-number">0</span>;i&lt;view.length;i++){resultArray[bufferIndex++]=view[i]}});<span class="hljs-keyword">return</span> callback(resultArray.buffer)})};exports.encodePayloadAsBlob=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">packets,callback</span>)</span>{<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">encodeOne</span>(<span class="hljs-params">packet,doneCallback</span>)</span>{exports.encodePacket(packet,<span class="hljs-literal">true</span>,<span class="hljs-literal">true</span>,<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">encoded</span>)</span>{<span class="hljs-keyword">var</span> binaryIdentifier=<span class="hljs-keyword">new</span> <span class="hljs-built_in">Uint8Array</span>(<span class="hljs-number">1</span>);binaryIdentifier[<span class="hljs-number">0</span>]=<span class="hljs-number">1</span>;<span class="hljs-keyword">if</span>(<span class="hljs-keyword">typeof</span> encoded===<span class="hljs-string">"string"</span>){<span class="hljs-keyword">var</span> view=<span class="hljs-keyword">new</span> <span class="hljs-built_in">Uint8Array</span>(encoded.length);<span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> i=<span class="hljs-number">0</span>;i&lt;encoded.length;i++){view[i]=encoded.charCodeAt(i)}encoded=view.buffer;binaryIdentifier[<span class="hljs-number">0</span>]=<span class="hljs-number">0</span>}<span class="hljs-keyword">var</span> len=encoded <span class="hljs-keyword">instanceof</span> <span class="hljs-built_in">ArrayBuffer</span>?encoded.byteLength:encoded.size;<span class="hljs-keyword">var</span> lenStr=len.toString();<span class="hljs-keyword">var</span> lengthAry=<span class="hljs-keyword">new</span> <span class="hljs-built_in">Uint8Array</span>(lenStr.length+<span class="hljs-number">1</span>);<span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> i=<span class="hljs-number">0</span>;i&lt;lenStr.length;i++){lengthAry[i]=<span class="hljs-built_in">parseInt</span>(lenStr[i])}lengthAry[lenStr.length]=<span class="hljs-number">255</span>;<span class="hljs-keyword">if</span>(Blob){<span class="hljs-keyword">var</span> blob=<span class="hljs-keyword">new</span> Blob([binaryIdentifier.buffer,lengthAry.buffer,encoded]);doneCallback(<span class="hljs-literal">null</span>,blob)}})}map(packets,encodeOne,<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">err,results</span>)</span>{<span class="hljs-keyword">return</span> callback(<span class="hljs-keyword">new</span> Blob(results))})};exports.decodePayloadAsBinary=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">data,binaryType,callback</span>)</span>{<span class="hljs-keyword">if</span>(<span class="hljs-keyword">typeof</span> binaryType===<span class="hljs-string">"function"</span>){callback=binaryType;binaryType=<span class="hljs-literal">null</span>}<span class="hljs-keyword">var</span> bufferTail=data;<span class="hljs-keyword">var</span> buffers=[];<span class="hljs-keyword">var</span> numberTooLong=<span class="hljs-literal">false</span>;<span class="hljs-keyword">while</span>(bufferTail.byteLength&gt;<span class="hljs-number">0</span>){<span class="hljs-keyword">var</span> tailArray=<span class="hljs-keyword">new</span> <span class="hljs-built_in">Uint8Array</span>(bufferTail);<span class="hljs-keyword">var</span> isString=tailArray[<span class="hljs-number">0</span>]===<span class="hljs-number">0</span>;<span class="hljs-keyword">var</span> msgLength=<span class="hljs-string">""</span>;<span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> i=<span class="hljs-number">1</span>;;i++){<span class="hljs-keyword">if</span>(tailArray[i]==<span class="hljs-number">255</span>)<span class="hljs-keyword">break</span>;<span class="hljs-keyword">if</span>(msgLength.length&gt;<span class="hljs-number">310</span>){numberTooLong=<span class="hljs-literal">true</span>;<span class="hljs-keyword">break</span>}msgLength+=tailArray[i]}<span class="hljs-keyword">if</span>(numberTooLong)<span class="hljs-keyword">return</span> callback(err,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>);bufferTail=sliceBuffer(bufferTail,<span class="hljs-number">2</span>+msgLength.length);msgLength=<span class="hljs-built_in">parseInt</span>(msgLength);<span class="hljs-keyword">var</span> msg=sliceBuffer(bufferTail,<span class="hljs-number">0</span>,msgLength);<span class="hljs-keyword">if</span>(isString){<span class="hljs-keyword">try</span>{msg=<span class="hljs-built_in">String</span>.fromCharCode.apply(<span class="hljs-literal">null</span>,<span class="hljs-keyword">new</span> <span class="hljs-built_in">Uint8Array</span>(msg))}<span class="hljs-keyword">catch</span>(e){<span class="hljs-keyword">var</span> typed=<span class="hljs-keyword">new</span> <span class="hljs-built_in">Uint8Array</span>(msg);msg=<span class="hljs-string">""</span>;<span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> i=<span class="hljs-number">0</span>;i&lt;typed.length;i++){msg+=<span class="hljs-built_in">String</span>.fromCharCode(typed[i])}}}buffers.push(msg);bufferTail=sliceBuffer(bufferTail,msgLength)}<span class="hljs-keyword">var</span> total=buffers.length;buffers.forEach(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">buffer,i</span>)</span>{callback(exports.decodePacket(buffer,binaryType,<span class="hljs-literal">true</span>),i,total)})}}).call(<span class="hljs-keyword">this</span>,<span class="hljs-keyword">typeof</span> self!==<span class="hljs-string">"undefined"</span>?self:<span class="hljs-keyword">typeof</span> <span class="hljs-built_in">window</span>!==<span class="hljs-string">"undefined"</span>?<span class="hljs-built_in">window</span>:<span class="hljs-keyword">typeof</span> global!==<span class="hljs-string">"undefined"</span>?global:{})},{<span class="hljs-string">"./keys"</span>:<span class="hljs-number">20</span>,<span class="hljs-attr">after</span>:<span class="hljs-number">11</span>,<span class="hljs-string">"arraybuffer.slice"</span>:<span class="hljs-number">12</span>,<span class="hljs-string">"base64-arraybuffer"</span>:<span class="hljs-number">13</span>,<span class="hljs-attr">blob</span>:<span class="hljs-number">14</span>,<span class="hljs-string">"has-binary"</span>:<span class="hljs-number">21</span>,<span class="hljs-attr">utf8</span>:<span class="hljs-number">29</span>}],<span class="hljs-number">20</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">_dereq_,module,exports</span>)</span>{<span class="hljs-built_in">module</span>.exports=<span class="hljs-built_in">Object</span>.keys||<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">keys</span>(<span class="hljs-params">obj</span>)</span>{<span class="hljs-keyword">var</span> arr=[];<span class="hljs-keyword">var</span> has=<span class="hljs-built_in">Object</span>.prototype.hasOwnProperty;<span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> i <span class="hljs-keyword">in</span> obj){<span class="hljs-keyword">if</span>(has.call(obj,i)){arr.push(i)}}<span class="hljs-keyword">return</span> arr}},{}],<span class="hljs-number">21</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">_dereq_,module,exports</span>)</span>{(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">global</span>)</span>{<span class="hljs-keyword">var</span> isArray=_dereq_(<span class="hljs-string">"isarray"</span>);<span class="hljs-built_in">module</span>.exports=hasBinary;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">hasBinary</span>(<span class="hljs-params">data</span>)</span>{<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">_hasBinary</span>(<span class="hljs-params">obj</span>)</span>{<span class="hljs-keyword">if</span>(!obj)<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<span class="hljs-keyword">if</span>(global.Buffer&amp;&amp;global.Buffer.isBuffer(obj)||global.ArrayBuffer&amp;&amp;obj <span class="hljs-keyword">instanceof</span> <span class="hljs-built_in">ArrayBuffer</span>||global.Blob&amp;&amp;obj <span class="hljs-keyword">instanceof</span> Blob||global.File&amp;&amp;obj <span class="hljs-keyword">instanceof</span> File){<span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>}<span class="hljs-keyword">if</span>(isArray(obj)){<span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> i=<span class="hljs-number">0</span>;i&lt;obj.length;i++){<span class="hljs-keyword">if</span>(_hasBinary(obj[i])){<span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>}}}<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(obj&amp;&amp;<span class="hljs-string">"object"</span>==<span class="hljs-keyword">typeof</span> obj){<span class="hljs-keyword">if</span>(obj.toJSON){obj=obj.toJSON()}<span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> key <span class="hljs-keyword">in</span> obj){<span class="hljs-keyword">if</span>(<span class="hljs-built_in">Object</span>.prototype.hasOwnProperty.call(obj,key)&amp;&amp;_hasBinary(obj[key])){<span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>}}}<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>}<span class="hljs-keyword">return</span> _hasBinary(data)}}).call(<span class="hljs-keyword">this</span>,<span class="hljs-keyword">typeof</span> self!==<span class="hljs-string">"undefined"</span>?self:<span class="hljs-keyword">typeof</span> <span class="hljs-built_in">window</span>!==<span class="hljs-string">"undefined"</span>?<span class="hljs-built_in">window</span>:<span class="hljs-keyword">typeof</span> global!==<span class="hljs-string">"undefined"</span>?global:{})},{<span class="hljs-attr">isarray</span>:<span class="hljs-number">24</span>}],<span class="hljs-number">22</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">_dereq_,module,exports</span>)</span>{<span class="hljs-keyword">try</span>{<span class="hljs-built_in">module</span>.exports=<span class="hljs-keyword">typeof</span> XMLHttpRequest!==<span class="hljs-string">"undefined"</span>&amp;&amp;<span class="hljs-string">"withCredentials"</span><span class="hljs-keyword">in</span> <span class="hljs-keyword">new</span> XMLHttpRequest}<span class="hljs-keyword">catch</span>(err){<span class="hljs-built_in">module</span>.exports=<span class="hljs-literal">false</span>}},{}],<span class="hljs-number">23</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">_dereq_,module,exports</span>)</span>{<span class="hljs-keyword">var</span> indexOf=[].indexOf;<span class="hljs-built_in">module</span>.exports=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">arr,obj</span>)</span>{<span class="hljs-keyword">if</span>(indexOf)<span class="hljs-keyword">return</span> arr.indexOf(obj);<span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> i=<span class="hljs-number">0</span>;i&lt;arr.length;++i){<span class="hljs-keyword">if</span>(arr[i]===obj)<span class="hljs-keyword">return</span> i}<span class="hljs-keyword">return</span><span class="hljs-number">-1</span>}},{}],<span class="hljs-number">24</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">_dereq_,module,exports</span>)</span>{<span class="hljs-built_in">module</span>.exports=<span class="hljs-built_in">Array</span>.isArray||<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">arr</span>)</span>{<span class="hljs-keyword">return</span> <span class="hljs-built_in">Object</span>.prototype.toString.call(arr)==<span class="hljs-string">"[object Array]"</span>}},{}],<span class="hljs-number">25</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">_dereq_,module,exports</span>)</span>{<span class="hljs-keyword">var</span> s=<span class="hljs-number">1e3</span>;<span class="hljs-keyword">var</span> m=s*<span class="hljs-number">60</span>;<span class="hljs-keyword">var</span> h=m*<span class="hljs-number">60</span>;<span class="hljs-keyword">var</span> d=h*<span class="hljs-number">24</span>;<span class="hljs-keyword">var</span> y=d*<span class="hljs-number">365.25</span>;<span class="hljs-built_in">module</span>.exports=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">val,options</span>)</span>{options=options||{};<span class="hljs-keyword">if</span>(<span class="hljs-string">"string"</span>==<span class="hljs-keyword">typeof</span> val)<span class="hljs-keyword">return</span> parse(val);<span class="hljs-keyword">return</span> options.long?long(val):short(val)};<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">parse</span>(<span class="hljs-params">str</span>)</span>{str=<span class="hljs-string">""</span>+str;<span class="hljs-keyword">if</span>(str.length&gt;<span class="hljs-number">1e4</span>)<span class="hljs-keyword">return</span>;<span class="hljs-keyword">var</span> match=<span class="hljs-regexp">/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i</span>.exec(str);<span class="hljs-keyword">if</span>(!match)<span class="hljs-keyword">return</span>;<span class="hljs-keyword">var</span> n=<span class="hljs-built_in">parseFloat</span>(match[<span class="hljs-number">1</span>]);<span class="hljs-keyword">var</span> type=(match[<span class="hljs-number">2</span>]||<span class="hljs-string">"ms"</span>).toLowerCase();<span class="hljs-keyword">switch</span>(type){<span class="hljs-keyword">case</span><span class="hljs-string">"years"</span>:<span class="hljs-keyword">case</span><span class="hljs-string">"year"</span>:<span class="hljs-keyword">case</span><span class="hljs-string">"yrs"</span>:<span class="hljs-keyword">case</span><span class="hljs-string">"yr"</span>:<span class="hljs-keyword">case</span><span class="hljs-string">"y"</span>:<span class="hljs-keyword">return</span> n*y;<span class="hljs-keyword">case</span><span class="hljs-string">"days"</span>:<span class="hljs-keyword">case</span><span class="hljs-string">"day"</span>:<span class="hljs-keyword">case</span><span class="hljs-string">"d"</span>:<span class="hljs-keyword">return</span> n*d;<span class="hljs-keyword">case</span><span class="hljs-string">"hours"</span>:<span class="hljs-keyword">case</span><span class="hljs-string">"hour"</span>:<span class="hljs-keyword">case</span><span class="hljs-string">"hrs"</span>:<span class="hljs-keyword">case</span><span class="hljs-string">"hr"</span>:<span class="hljs-keyword">case</span><span class="hljs-string">"h"</span>:<span class="hljs-keyword">return</span> n*h;<span class="hljs-keyword">case</span><span class="hljs-string">"minutes"</span>:<span class="hljs-keyword">case</span><span class="hljs-string">"minute"</span>:<span class="hljs-keyword">case</span><span class="hljs-string">"mins"</span>:<span class="hljs-keyword">case</span><span class="hljs-string">"min"</span>:<span class="hljs-keyword">case</span><span class="hljs-string">"m"</span>:<span class="hljs-keyword">return</span> n*m;<span class="hljs-keyword">case</span><span class="hljs-string">"seconds"</span>:<span class="hljs-keyword">case</span><span class="hljs-string">"second"</span>:<span class="hljs-keyword">case</span><span class="hljs-string">"secs"</span>:<span class="hljs-keyword">case</span><span class="hljs-string">"sec"</span>:<span class="hljs-keyword">case</span><span class="hljs-string">"s"</span>:<span class="hljs-keyword">return</span> n*s;<span class="hljs-keyword">case</span><span class="hljs-string">"milliseconds"</span>:<span class="hljs-keyword">case</span><span class="hljs-string">"millisecond"</span>:<span class="hljs-keyword">case</span><span class="hljs-string">"msecs"</span>:<span class="hljs-keyword">case</span><span class="hljs-string">"msec"</span>:<span class="hljs-keyword">case</span><span class="hljs-string">"ms"</span>:<span class="hljs-keyword">return</span> n}}<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">short</span>(<span class="hljs-params">ms</span>)</span>{<span class="hljs-keyword">if</span>(ms&gt;=d)<span class="hljs-keyword">return</span> <span class="hljs-built_in">Math</span>.round(ms/d)+<span class="hljs-string">"d"</span>;<span class="hljs-keyword">if</span>(ms&gt;=h)<span class="hljs-keyword">return</span> <span class="hljs-built_in">Math</span>.round(ms/h)+<span class="hljs-string">"h"</span>;<span class="hljs-keyword">if</span>(ms&gt;=m)<span class="hljs-keyword">return</span> <span class="hljs-built_in">Math</span>.round(ms/m)+<span class="hljs-string">"m"</span>;<span class="hljs-keyword">if</span>(ms&gt;=s)<span class="hljs-keyword">return</span> <span class="hljs-built_in">Math</span>.round(ms/s)+<span class="hljs-string">"s"</span>;<span class="hljs-keyword">return</span> ms+<span class="hljs-string">"ms"</span>}<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">long</span>(<span class="hljs-params">ms</span>)</span>{<span class="hljs-keyword">return</span> plural(ms,d,<span class="hljs-string">"day"</span>)||plural(ms,h,<span class="hljs-string">"hour"</span>)||plural(ms,m,<span class="hljs-string">"minute"</span>)||plural(ms,s,<span class="hljs-string">"second"</span>)||ms+<span class="hljs-string">" ms"</span>}<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">plural</span>(<span class="hljs-params">ms,n,name</span>)</span>{<span class="hljs-keyword">if</span>(ms&lt;n)<span class="hljs-keyword">return</span>;<span class="hljs-keyword">if</span>(ms&lt;n*<span class="hljs-number">1.5</span>)<span class="hljs-keyword">return</span> <span class="hljs-built_in">Math</span>.floor(ms/n)+<span class="hljs-string">" "</span>+name;<span class="hljs-keyword">return</span> <span class="hljs-built_in">Math</span>.ceil(ms/n)+<span class="hljs-string">" "</span>+name+<span class="hljs-string">"s"</span>}},{}],<span class="hljs-number">26</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">_dereq_,module,exports</span>)</span>{(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">global</span>)</span>{<span class="hljs-keyword">var</span> rvalidchars=<span class="hljs-regexp">/^[\],:{}\s]*$/</span>;<span class="hljs-keyword">var</span> rvalidescape=<span class="hljs-regexp">/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g</span>;<span class="hljs-keyword">var</span> rvalidtokens=<span class="hljs-regexp">/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g</span>;<span class="hljs-keyword">var</span> rvalidbraces=<span class="hljs-regexp">/(?:^|:|,)(?:\s*\[)+/g</span>;<span class="hljs-keyword">var</span> rtrimLeft=<span class="hljs-regexp">/^\s+/</span>;<span class="hljs-keyword">var</span> rtrimRight=<span class="hljs-regexp">/\s+$/</span>;<span class="hljs-built_in">module</span>.exports=<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">parsejson</span>(<span class="hljs-params">data</span>)</span>{<span class="hljs-keyword">if</span>(<span class="hljs-string">"string"</span>!=<span class="hljs-keyword">typeof</span> data||!data){<span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>}data=data.replace(rtrimLeft,<span class="hljs-string">""</span>).replace(rtrimRight,<span class="hljs-string">""</span>);<span class="hljs-keyword">if</span>(global.JSON&amp;&amp;<span class="hljs-built_in">JSON</span>.parse){<span class="hljs-keyword">return</span> <span class="hljs-built_in">JSON</span>.parse(data)}<span class="hljs-keyword">if</span>(rvalidchars.test(data.replace(rvalidescape,<span class="hljs-string">"@"</span>).replace(rvalidtokens,<span class="hljs-string">"]"</span>).replace(rvalidbraces,<span class="hljs-string">""</span>))){<span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Function</span>(<span class="hljs-string">"return "</span>+data)()}}}).call(<span class="hljs-keyword">this</span>,<span class="hljs-keyword">typeof</span> self!==<span class="hljs-string">"undefined"</span>?self:<span class="hljs-keyword">typeof</span> <span class="hljs-built_in">window</span>!==<span class="hljs-string">"undefined"</span>?<span class="hljs-built_in">window</span>:<span class="hljs-keyword">typeof</span> global!==<span class="hljs-string">"undefined"</span>?global:{})},{}],<span class="hljs-number">27</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">_dereq_,module,exports</span>)</span>{exports.encode=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">obj</span>)</span>{<span class="hljs-keyword">var</span> str=<span class="hljs-string">""</span>;<span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> i <span class="hljs-keyword">in</span> obj){<span class="hljs-keyword">if</span>(obj.hasOwnProperty(i)){<span class="hljs-keyword">if</span>(str.length)str+=<span class="hljs-string">"&amp;"</span>;str+=<span class="hljs-built_in">encodeURIComponent</span>(i)+<span class="hljs-string">"="</span>+<span class="hljs-built_in">encodeURIComponent</span>(obj[i])}}<span class="hljs-keyword">return</span> str};exports.decode=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">qs</span>)</span>{<span class="hljs-keyword">var</span> qry={};<span class="hljs-keyword">var</span> pairs=qs.split(<span class="hljs-string">"&amp;"</span>);<span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> i=<span class="hljs-number">0</span>,l=pairs.length;i&lt;l;i++){<span class="hljs-keyword">var</span> pair=pairs[i].split(<span class="hljs-string">"="</span>);qry[<span class="hljs-built_in">decodeURIComponent</span>(pair[<span class="hljs-number">0</span>])]=<span class="hljs-built_in">decodeURIComponent</span>(pair[<span class="hljs-number">1</span>])}<span class="hljs-keyword">return</span> qry}},{}],<span class="hljs-number">28</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">_dereq_,module,exports</span>)</span>{<span class="hljs-keyword">var</span> re=<span class="hljs-regexp">/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/</span>;<span class="hljs-keyword">var</span> parts=[<span class="hljs-string">"source"</span>,<span class="hljs-string">"protocol"</span>,<span class="hljs-string">"authority"</span>,<span class="hljs-string">"userInfo"</span>,<span class="hljs-string">"user"</span>,<span class="hljs-string">"password"</span>,<span class="hljs-string">"host"</span>,<span class="hljs-string">"port"</span>,<span class="hljs-string">"relative"</span>,<span class="hljs-string">"path"</span>,<span class="hljs-string">"directory"</span>,<span class="hljs-string">"file"</span>,<span class="hljs-string">"query"</span>,<span class="hljs-string">"anchor"</span>];<span class="hljs-built_in">module</span>.exports=<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">parseuri</span>(<span class="hljs-params">str</span>)</span>{<span class="hljs-keyword">var</span> src=str,b=str.indexOf(<span class="hljs-string">"["</span>),e=str.indexOf(<span class="hljs-string">"]"</span>);<span class="hljs-keyword">if</span>(b!=<span class="hljs-number">-1</span>&amp;&amp;e!=<span class="hljs-number">-1</span>){str=str.substring(<span class="hljs-number">0</span>,b)+str.substring(b,e).replace(<span class="hljs-regexp">/:/g</span>,<span class="hljs-string">";"</span>)+str.substring(e,str.length)}<span class="hljs-keyword">var</span> m=re.exec(str||<span class="hljs-string">""</span>),uri={},i=<span class="hljs-number">14</span>;<span class="hljs-keyword">while</span>(i--){uri[parts[i]]=m[i]||<span class="hljs-string">""</span>}<span class="hljs-keyword">if</span>(b!=<span class="hljs-number">-1</span>&amp;&amp;e!=<span class="hljs-number">-1</span>){uri.source=src;uri.host=uri.host.substring(<span class="hljs-number">1</span>,uri.host.length<span class="hljs-number">-1</span>).replace(<span class="hljs-regexp">/;/g</span>,<span class="hljs-string">":"</span>);uri.authority=uri.authority.replace(<span class="hljs-string">"["</span>,<span class="hljs-string">""</span>).replace(<span class="hljs-string">"]"</span>,<span class="hljs-string">""</span>).replace(<span class="hljs-regexp">/;/g</span>,<span class="hljs-string">":"</span>);uri.ipv6uri=<span class="hljs-literal">true</span>}<span class="hljs-keyword">return</span> uri}},{}],<span class="hljs-number">29</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">_dereq_,module,exports</span>)</span>{(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">global</span>)</span>{(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">root</span>)</span>{<span class="hljs-keyword">var</span> freeExports=<span class="hljs-keyword">typeof</span> exports==<span class="hljs-string">"object"</span>&amp;&amp;exports;<span class="hljs-keyword">var</span> freeModule=<span class="hljs-keyword">typeof</span> <span class="hljs-built_in">module</span>==<span class="hljs-string">"object"</span>&amp;&amp;<span class="hljs-built_in">module</span>&amp;&amp;<span class="hljs-built_in">module</span>.exports==freeExports&amp;&amp;<span class="hljs-built_in">module</span>;<span class="hljs-keyword">var</span> freeGlobal=<span class="hljs-keyword">typeof</span> global==<span class="hljs-string">"object"</span>&amp;&amp;global;<span class="hljs-keyword">if</span>(freeGlobal.global===freeGlobal||freeGlobal.window===freeGlobal){root=freeGlobal}<span class="hljs-keyword">var</span> stringFromCharCode=<span class="hljs-built_in">String</span>.fromCharCode;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ucs2decode</span>(<span class="hljs-params">string</span>)</span>{<span class="hljs-keyword">var</span> output=[];<span class="hljs-keyword">var</span> counter=<span class="hljs-number">0</span>;<span class="hljs-keyword">var</span> length=string.length;<span class="hljs-keyword">var</span> value;<span class="hljs-keyword">var</span> extra;<span class="hljs-keyword">while</span>(counter&lt;length){value=string.charCodeAt(counter++);<span class="hljs-keyword">if</span>(value&gt;=<span class="hljs-number">55296</span>&amp;&amp;value&lt;=<span class="hljs-number">56319</span>&amp;&amp;counter&lt;length){extra=string.charCodeAt(counter++);<span class="hljs-keyword">if</span>((extra&amp;<span class="hljs-number">64512</span>)==<span class="hljs-number">56320</span>){output.push(((value&amp;<span class="hljs-number">1023</span>)&lt;&lt;<span class="hljs-number">10</span>)+(extra&amp;<span class="hljs-number">1023</span>)+<span class="hljs-number">65536</span>)}<span class="hljs-keyword">else</span>{output.push(value);counter--}}<span class="hljs-keyword">else</span>{output.push(value)}}<span class="hljs-keyword">return</span> output}<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ucs2encode</span>(<span class="hljs-params">array</span>)</span>{<span class="hljs-keyword">var</span> length=array.length;<span class="hljs-keyword">var</span> index=<span class="hljs-number">-1</span>;<span class="hljs-keyword">var</span> value;<span class="hljs-keyword">var</span> output=<span class="hljs-string">""</span>;<span class="hljs-keyword">while</span>(++index&lt;length){value=array[index];<span class="hljs-keyword">if</span>(value&gt;<span class="hljs-number">65535</span>){value-=<span class="hljs-number">65536</span>;output+=stringFromCharCode(value&gt;&gt;&gt;<span class="hljs-number">10</span>&amp;<span class="hljs-number">1023</span>|<span class="hljs-number">55296</span>);value=<span class="hljs-number">56320</span>|value&amp;<span class="hljs-number">1023</span>}output+=stringFromCharCode(value)}<span class="hljs-keyword">return</span> output}<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">checkScalarValue</span>(<span class="hljs-params">codePoint</span>)</span>{<span class="hljs-keyword">if</span>(codePoint&gt;=<span class="hljs-number">55296</span>&amp;&amp;codePoint&lt;=<span class="hljs-number">57343</span>){<span class="hljs-keyword">throw</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"Lone surrogate U+"</span>+codePoint.toString(<span class="hljs-number">16</span>).toUpperCase()+<span class="hljs-string">" is not a scalar value"</span>)}}<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createByte</span>(<span class="hljs-params">codePoint,shift</span>)</span>{<span class="hljs-keyword">return</span> stringFromCharCode(codePoint&gt;&gt;shift&amp;<span class="hljs-number">63</span>|<span class="hljs-number">128</span>)}<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">encodeCodePoint</span>(<span class="hljs-params">codePoint</span>)</span>{<span class="hljs-keyword">if</span>((codePoint&amp;<span class="hljs-number">4294967168</span>)==<span class="hljs-number">0</span>){<span class="hljs-keyword">return</span> stringFromCharCode(codePoint)}<span class="hljs-keyword">var</span> symbol=<span class="hljs-string">""</span>;<span class="hljs-keyword">if</span>((codePoint&amp;<span class="hljs-number">4294965248</span>)==<span class="hljs-number">0</span>){symbol=stringFromCharCode(codePoint&gt;&gt;<span class="hljs-number">6</span>&amp;<span class="hljs-number">31</span>|<span class="hljs-number">192</span>)}<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>((codePoint&amp;<span class="hljs-number">4294901760</span>)==<span class="hljs-number">0</span>){checkScalarValue(codePoint);symbol=stringFromCharCode(codePoint&gt;&gt;<span class="hljs-number">12</span>&amp;<span class="hljs-number">15</span>|<span class="hljs-number">224</span>);symbol+=createByte(codePoint,<span class="hljs-number">6</span>)}<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>((codePoint&amp;<span class="hljs-number">4292870144</span>)==<span class="hljs-number">0</span>){symbol=stringFromCharCode(codePoint&gt;&gt;<span class="hljs-number">18</span>&amp;<span class="hljs-number">7</span>|<span class="hljs-number">240</span>);symbol+=createByte(codePoint,<span class="hljs-number">12</span>);symbol+=createByte(codePoint,<span class="hljs-number">6</span>)}symbol+=stringFromCharCode(codePoint&amp;<span class="hljs-number">63</span>|<span class="hljs-number">128</span>);<span class="hljs-keyword">return</span> symbol}<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">utf8encode</span>(<span class="hljs-params">string</span>)</span>{<span class="hljs-keyword">var</span> codePoints=ucs2decode(string);<span class="hljs-keyword">var</span> length=codePoints.length;<span class="hljs-keyword">var</span> index=<span class="hljs-number">-1</span>;<span class="hljs-keyword">var</span> codePoint;<span class="hljs-keyword">var</span> byteString=<span class="hljs-string">""</span>;<span class="hljs-keyword">while</span>(++index&lt;length){codePoint=codePoints[index];byteString+=encodeCodePoint(codePoint)}<span class="hljs-keyword">return</span> byteString}<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">readContinuationByte</span>(<span class="hljs-params"></span>)</span>{<span class="hljs-keyword">if</span>(byteIndex&gt;=byteCount){<span class="hljs-keyword">throw</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"Invalid byte index"</span>)}<span class="hljs-keyword">var</span> continuationByte=byteArray[byteIndex]&amp;<span class="hljs-number">255</span>;byteIndex++;<span class="hljs-keyword">if</span>((continuationByte&amp;<span class="hljs-number">192</span>)==<span class="hljs-number">128</span>){<span class="hljs-keyword">return</span> continuationByte&amp;<span class="hljs-number">63</span>}<span class="hljs-keyword">throw</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"Invalid continuation byte"</span>)}<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">decodeSymbol</span>(<span class="hljs-params"></span>)</span>{<span class="hljs-keyword">var</span> byte1;<span class="hljs-keyword">var</span> byte2;<span class="hljs-keyword">var</span> byte3;<span class="hljs-keyword">var</span> byte4;<span class="hljs-keyword">var</span> codePoint;<span class="hljs-keyword">if</span>(byteIndex&gt;byteCount){<span class="hljs-keyword">throw</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"Invalid byte index"</span>)}<span class="hljs-keyword">if</span>(byteIndex==byteCount){<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>}byte1=byteArray[byteIndex]&amp;<span class="hljs-number">255</span>;byteIndex++;<span class="hljs-keyword">if</span>((byte1&amp;<span class="hljs-number">128</span>)==<span class="hljs-number">0</span>){<span class="hljs-keyword">return</span> byte1}<span class="hljs-keyword">if</span>((byte1&amp;<span class="hljs-number">224</span>)==<span class="hljs-number">192</span>){<span class="hljs-keyword">var</span> byte2=readContinuationByte();codePoint=(byte1&amp;<span class="hljs-number">31</span>)&lt;&lt;<span class="hljs-number">6</span>|byte2;<span class="hljs-keyword">if</span>(codePoint&gt;=<span class="hljs-number">128</span>){<span class="hljs-keyword">return</span> codePoint}<span class="hljs-keyword">else</span>{<span class="hljs-keyword">throw</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"Invalid continuation byte"</span>)}}<span class="hljs-keyword">if</span>((byte1&amp;<span class="hljs-number">240</span>)==<span class="hljs-number">224</span>){byte2=readContinuationByte();byte3=readContinuationByte();codePoint=(byte1&amp;<span class="hljs-number">15</span>)&lt;&lt;<span class="hljs-number">12</span>|byte2&lt;&lt;<span class="hljs-number">6</span>|byte3;<span class="hljs-keyword">if</span>(codePoint&gt;=<span class="hljs-number">2048</span>){checkScalarValue(codePoint);<span class="hljs-keyword">return</span> codePoint}<span class="hljs-keyword">else</span>{<span class="hljs-keyword">throw</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"Invalid continuation byte"</span>)}}<span class="hljs-keyword">if</span>((byte1&amp;<span class="hljs-number">248</span>)==<span class="hljs-number">240</span>){byte2=readContinuationByte();byte3=readContinuationByte();byte4=readContinuationByte();codePoint=(byte1&amp;<span class="hljs-number">15</span>)&lt;&lt;<span class="hljs-number">18</span>|byte2&lt;&lt;<span class="hljs-number">12</span>|byte3&lt;&lt;<span class="hljs-number">6</span>|byte4;<span class="hljs-keyword">if</span>(codePoint&gt;=<span class="hljs-number">65536</span>&amp;&amp;codePoint&lt;=<span class="hljs-number">1114111</span>){<span class="hljs-keyword">return</span> codePoint}}<span class="hljs-keyword">throw</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"Invalid UTF-8 detected"</span>)}<span class="hljs-keyword">var</span> byteArray;<span class="hljs-keyword">var</span> byteCount;<span class="hljs-keyword">var</span> byteIndex;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">utf8decode</span>(<span class="hljs-params">byteString</span>)</span>{byteArray=ucs2decode(byteString);byteCount=byteArray.length;byteIndex=<span class="hljs-number">0</span>;<span class="hljs-keyword">var</span> codePoints=[];<span class="hljs-keyword">var</span> tmp;<span class="hljs-keyword">while</span>((tmp=decodeSymbol())!==<span class="hljs-literal">false</span>){codePoints.push(tmp)}<span class="hljs-keyword">return</span> ucs2encode(codePoints)}<span class="hljs-keyword">var</span> utf8={<span class="hljs-attr">version</span>:<span class="hljs-string">"2.0.0"</span>,<span class="hljs-attr">encode</span>:utf8encode,<span class="hljs-attr">decode</span>:utf8decode};<span class="hljs-keyword">if</span>(<span class="hljs-keyword">typeof</span> define==<span class="hljs-string">"function"</span>&amp;&amp;<span class="hljs-keyword">typeof</span> define.amd==<span class="hljs-string">"object"</span>&amp;&amp;define.amd){define(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{<span class="hljs-keyword">return</span> utf8})}<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(freeExports&amp;&amp;!freeExports.nodeType){<span class="hljs-keyword">if</span>(freeModule){freeModule.exports=utf8}<span class="hljs-keyword">else</span>{<span class="hljs-keyword">var</span> object={};<span class="hljs-keyword">var</span> hasOwnProperty=object.hasOwnProperty;<span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> key <span class="hljs-keyword">in</span> utf8){hasOwnProperty.call(utf8,key)&amp;&amp;(freeExports[key]=utf8[key])}}}<span class="hljs-keyword">else</span>{root.utf8=utf8}})(<span class="hljs-keyword">this</span>)}).call(<span class="hljs-keyword">this</span>,<span class="hljs-keyword">typeof</span> self!==<span class="hljs-string">"undefined"</span>?self:<span class="hljs-keyword">typeof</span> <span class="hljs-built_in">window</span>!==<span class="hljs-string">"undefined"</span>?<span class="hljs-built_in">window</span>:<span class="hljs-keyword">typeof</span> global!==<span class="hljs-string">"undefined"</span>?global:{})},{}],<span class="hljs-number">30</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">_dereq_,module,exports</span>)</span>{<span class="hljs-string">"use strict"</span>;<span class="hljs-keyword">var</span> alphabet=<span class="hljs-string">"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_"</span>.split(<span class="hljs-string">""</span>),length=<span class="hljs-number">64</span>,map={},seed=<span class="hljs-number">0</span>,i=<span class="hljs-number">0</span>,prev;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">encode</span>(<span class="hljs-params">num</span>)</span>{<span class="hljs-keyword">var</span> encoded=<span class="hljs-string">""</span>;<span class="hljs-keyword">do</span>{encoded=alphabet[num%length]+encoded;num=<span class="hljs-built_in">Math</span>.floor(num/length)}<span class="hljs-keyword">while</span>(num&gt;<span class="hljs-number">0</span>);<span class="hljs-keyword">return</span> encoded}<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">decode</span>(<span class="hljs-params">str</span>)</span>{<span class="hljs-keyword">var</span> decoded=<span class="hljs-number">0</span>;<span class="hljs-keyword">for</span>(i=<span class="hljs-number">0</span>;i&lt;str.length;i++){decoded=decoded*length+map[str.charAt(i)]}<span class="hljs-keyword">return</span> decoded}<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">yeast</span>(<span class="hljs-params"></span>)</span>{<span class="hljs-keyword">var</span> now=encode(+<span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>);<span class="hljs-keyword">if</span>(now!==prev)<span class="hljs-keyword">return</span> seed=<span class="hljs-number">0</span>,prev=now;<span class="hljs-keyword">return</span> now+<span class="hljs-string">"."</span>+encode(seed++)}<span class="hljs-keyword">for</span>(;i&lt;length;i++)map[alphabet[i]]=i;yeast.encode=encode;yeast.decode=decode;<span class="hljs-built_in">module</span>.exports=yeast},{}],<span class="hljs-number">31</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">_dereq_,module,exports</span>)</span>{<span class="hljs-keyword">var</span> url=_dereq_(<span class="hljs-string">"./url"</span>);<span class="hljs-keyword">var</span> parser=_dereq_(<span class="hljs-string">"socket.io-parser"</span>);<span class="hljs-keyword">var</span> Manager=_dereq_(<span class="hljs-string">"./manager"</span>);<span class="hljs-keyword">var</span> debug=_dereq_(<span class="hljs-string">"debug"</span>)(<span class="hljs-string">"socket.io-client"</span>);<span class="hljs-built_in">module</span>.exports=exports=lookup;<span class="hljs-keyword">var</span> cache=exports.managers={};<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">lookup</span>(<span class="hljs-params">uri,opts</span>)</span>{<span class="hljs-keyword">if</span>(<span class="hljs-keyword">typeof</span> uri==<span class="hljs-string">"object"</span>){opts=uri;uri=<span class="hljs-literal">undefined</span>}opts=opts||{};<span class="hljs-keyword">var</span> parsed=url(uri);<span class="hljs-keyword">var</span> source=parsed.source;<span class="hljs-keyword">var</span> id=parsed.id;<span class="hljs-keyword">var</span> path=parsed.path;<span class="hljs-keyword">var</span> sameNamespace=cache[id]&amp;&amp;path <span class="hljs-keyword">in</span> cache[id].nsps;<span class="hljs-keyword">var</span> newConnection=opts.forceNew||opts[<span class="hljs-string">"force new connection"</span>]||<span class="hljs-literal">false</span>===opts.multiplex||sameNamespace;<span class="hljs-keyword">var</span> io;<span class="hljs-keyword">if</span>(newConnection){debug(<span class="hljs-string">"ignoring socket cache for %s"</span>,source);io=Manager(source,opts)}<span class="hljs-keyword">else</span>{<span class="hljs-keyword">if</span>(!cache[id]){debug(<span class="hljs-string">"new io instance for %s"</span>,source);cache[id]=Manager(source,opts)}io=cache[id]}<span class="hljs-keyword">return</span> io.socket(parsed.path)}exports.protocol=parser.protocol;exports.connect=lookup;exports.Manager=_dereq_(<span class="hljs-string">"./manager"</span>);exports.Socket=_dereq_(<span class="hljs-string">"./socket"</span>)},{<span class="hljs-string">"./manager"</span>:<span class="hljs-number">32</span>,<span class="hljs-string">"./socket"</span>:<span class="hljs-number">34</span>,<span class="hljs-string">"./url"</span>:<span class="hljs-number">35</span>,<span class="hljs-attr">debug</span>:<span class="hljs-number">39</span>,<span class="hljs-string">"socket.io-parser"</span>:<span class="hljs-number">47</span>}],<span class="hljs-number">32</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">_dereq_,module,exports</span>)</span>{<span class="hljs-keyword">var</span> eio=_dereq_(<span class="hljs-string">"engine.io-client"</span>);<span class="hljs-keyword">var</span> Socket=_dereq_(<span class="hljs-string">"./socket"</span>);<span class="hljs-keyword">var</span> Emitter=_dereq_(<span class="hljs-string">"component-emitter"</span>);<span class="hljs-keyword">var</span> parser=_dereq_(<span class="hljs-string">"socket.io-parser"</span>);<span class="hljs-keyword">var</span> on=_dereq_(<span class="hljs-string">"./on"</span>);<span class="hljs-keyword">var</span> bind=_dereq_(<span class="hljs-string">"component-bind"</span>);<span class="hljs-keyword">var</span> debug=_dereq_(<span class="hljs-string">"debug"</span>)(<span class="hljs-string">"socket.io-client:manager"</span>);<span class="hljs-keyword">var</span> indexOf=_dereq_(<span class="hljs-string">"indexof"</span>);<span class="hljs-keyword">var</span> Backoff=_dereq_(<span class="hljs-string">"backo2"</span>);<span class="hljs-keyword">var</span> has=<span class="hljs-built_in">Object</span>.prototype.hasOwnProperty;<span class="hljs-built_in">module</span>.exports=Manager;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Manager</span>(<span class="hljs-params">uri,opts</span>)</span>{<span class="hljs-keyword">if</span>(!(<span class="hljs-keyword">this</span> <span class="hljs-keyword">instanceof</span> Manager))<span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Manager(uri,opts);<span class="hljs-keyword">if</span>(uri&amp;&amp;<span class="hljs-string">"object"</span>==<span class="hljs-keyword">typeof</span> uri){opts=uri;uri=<span class="hljs-literal">undefined</span>}opts=opts||{};opts.path=opts.path||<span class="hljs-string">"/socket.io"</span>;<span class="hljs-keyword">this</span>.nsps={};<span class="hljs-keyword">this</span>.subs=[];<span class="hljs-keyword">this</span>.opts=opts;<span class="hljs-keyword">this</span>.reconnection(opts.reconnection!==<span class="hljs-literal">false</span>);<span class="hljs-keyword">this</span>.reconnectionAttempts(opts.reconnectionAttempts||<span class="hljs-literal">Infinity</span>);<span class="hljs-keyword">this</span>.reconnectionDelay(opts.reconnectionDelay||<span class="hljs-number">1e3</span>);<span class="hljs-keyword">this</span>.reconnectionDelayMax(opts.reconnectionDelayMax||<span class="hljs-number">5e3</span>);<span class="hljs-keyword">this</span>.randomizationFactor(opts.randomizationFactor||<span class="hljs-number">.5</span>);<span class="hljs-keyword">this</span>.backoff=<span class="hljs-keyword">new</span> Backoff({<span class="hljs-attr">min</span>:<span class="hljs-keyword">this</span>.reconnectionDelay(),<span class="hljs-attr">max</span>:<span class="hljs-keyword">this</span>.reconnectionDelayMax(),<span class="hljs-attr">jitter</span>:<span class="hljs-keyword">this</span>.randomizationFactor()});<span class="hljs-keyword">this</span>.timeout(<span class="hljs-literal">null</span>==opts.timeout?<span class="hljs-number">2e4</span>:opts.timeout);<span class="hljs-keyword">this</span>.readyState=<span class="hljs-string">"closed"</span>;<span class="hljs-keyword">this</span>.uri=uri;<span class="hljs-keyword">this</span>.connecting=[];<span class="hljs-keyword">this</span>.lastPing=<span class="hljs-literal">null</span>;<span class="hljs-keyword">this</span>.encoding=<span class="hljs-literal">false</span>;<span class="hljs-keyword">this</span>.packetBuffer=[];<span class="hljs-keyword">this</span>.encoder=<span class="hljs-keyword">new</span> parser.Encoder;<span class="hljs-keyword">this</span>.decoder=<span class="hljs-keyword">new</span> parser.Decoder;<span class="hljs-keyword">this</span>.autoConnect=opts.autoConnect!==<span class="hljs-literal">false</span>;<span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.autoConnect)<span class="hljs-keyword">this</span>.open()}Manager.prototype.emitAll=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{<span class="hljs-keyword">this</span>.emit.apply(<span class="hljs-keyword">this</span>,<span class="hljs-built_in">arguments</span>);<span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> nsp <span class="hljs-keyword">in</span> <span class="hljs-keyword">this</span>.nsps){<span class="hljs-keyword">if</span>(has.call(<span class="hljs-keyword">this</span>.nsps,nsp)){<span class="hljs-keyword">this</span>.nsps[nsp].emit.apply(<span class="hljs-keyword">this</span>.nsps[nsp],<span class="hljs-built_in">arguments</span>)}}};Manager.prototype.updateSocketIds=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{<span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> nsp <span class="hljs-keyword">in</span> <span class="hljs-keyword">this</span>.nsps){<span class="hljs-keyword">if</span>(has.call(<span class="hljs-keyword">this</span>.nsps,nsp)){<span class="hljs-keyword">this</span>.nsps[nsp].id=<span class="hljs-keyword">this</span>.engine.id}}};Emitter(Manager.prototype);Manager.prototype.reconnection=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">v</span>)</span>{<span class="hljs-keyword">if</span>(!<span class="hljs-built_in">arguments</span>.length)<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._reconnection;<span class="hljs-keyword">this</span>._reconnection=!!v;<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>};Manager.prototype.reconnectionAttempts=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">v</span>)</span>{<span class="hljs-keyword">if</span>(!<span class="hljs-built_in">arguments</span>.length)<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._reconnectionAttempts;<span class="hljs-keyword">this</span>._reconnectionAttempts=v;<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>};Manager.prototype.reconnectionDelay=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">v</span>)</span>{<span class="hljs-keyword">if</span>(!<span class="hljs-built_in">arguments</span>.length)<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._reconnectionDelay;<span class="hljs-keyword">this</span>._reconnectionDelay=v;<span class="hljs-keyword">this</span>.backoff&amp;&amp;<span class="hljs-keyword">this</span>.backoff.setMin(v);<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>};Manager.prototype.randomizationFactor=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">v</span>)</span>{<span class="hljs-keyword">if</span>(!<span class="hljs-built_in">arguments</span>.length)<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._randomizationFactor;<span class="hljs-keyword">this</span>._randomizationFactor=v;<span class="hljs-keyword">this</span>.backoff&amp;&amp;<span class="hljs-keyword">this</span>.backoff.setJitter(v);<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>};Manager.prototype.reconnectionDelayMax=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">v</span>)</span>{<span class="hljs-keyword">if</span>(!<span class="hljs-built_in">arguments</span>.length)<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._reconnectionDelayMax;<span class="hljs-keyword">this</span>._reconnectionDelayMax=v;<span class="hljs-keyword">this</span>.backoff&amp;&amp;<span class="hljs-keyword">this</span>.backoff.setMax(v);<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>};Manager.prototype.timeout=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">v</span>)</span>{<span class="hljs-keyword">if</span>(!<span class="hljs-built_in">arguments</span>.length)<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._timeout;<span class="hljs-keyword">this</span>._timeout=v;<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>};Manager.prototype.maybeReconnectOnOpen=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{<span class="hljs-keyword">if</span>(!<span class="hljs-keyword">this</span>.reconnecting&amp;&amp;<span class="hljs-keyword">this</span>._reconnection&amp;&amp;<span class="hljs-keyword">this</span>.backoff.attempts===<span class="hljs-number">0</span>){<span class="hljs-keyword">this</span>.reconnect()}};Manager.prototype.open=Manager.prototype.connect=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">fn</span>)</span>{debug(<span class="hljs-string">"readyState %s"</span>,<span class="hljs-keyword">this</span>.readyState);<span class="hljs-keyword">if</span>(~<span class="hljs-keyword">this</span>.readyState.indexOf(<span class="hljs-string">"open"</span>))<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;debug(<span class="hljs-string">"opening %s"</span>,<span class="hljs-keyword">this</span>.uri);<span class="hljs-keyword">this</span>.engine=eio(<span class="hljs-keyword">this</span>.uri,<span class="hljs-keyword">this</span>.opts);<span class="hljs-keyword">var</span> socket=<span class="hljs-keyword">this</span>.engine;<span class="hljs-keyword">var</span> self=<span class="hljs-keyword">this</span>;<span class="hljs-keyword">this</span>.readyState=<span class="hljs-string">"opening"</span>;<span class="hljs-keyword">this</span>.skipReconnect=<span class="hljs-literal">false</span>;<span class="hljs-keyword">var</span> openSub=on(socket,<span class="hljs-string">"open"</span>,<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{self.onopen();fn&amp;&amp;fn()});<span class="hljs-keyword">var</span> errorSub=on(socket,<span class="hljs-string">"error"</span>,<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">data</span>)</span>{debug(<span class="hljs-string">"connect_error"</span>);self.cleanup();self.readyState=<span class="hljs-string">"closed"</span>;self.emitAll(<span class="hljs-string">"connect_error"</span>,data);<span class="hljs-keyword">if</span>(fn){<span class="hljs-keyword">var</span> err=<span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"Connection error"</span>);err.data=data;fn(err)}<span class="hljs-keyword">else</span>{self.maybeReconnectOnOpen()}});<span class="hljs-keyword">if</span>(<span class="hljs-literal">false</span>!==<span class="hljs-keyword">this</span>._timeout){<span class="hljs-keyword">var</span> timeout=<span class="hljs-keyword">this</span>._timeout;debug(<span class="hljs-string">"connect attempt will timeout after %d"</span>,timeout);<span class="hljs-keyword">var</span> timer=setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{debug(<span class="hljs-string">"connect attempt timed out after %d"</span>,timeout);openSub.destroy();socket.close();socket.emit(<span class="hljs-string">"error"</span>,<span class="hljs-string">"timeout"</span>);self.emitAll(<span class="hljs-string">"connect_timeout"</span>,timeout)},timeout);<span class="hljs-keyword">this</span>.subs.push({<span class="hljs-attr">destroy</span>:<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{clearTimeout(timer)}})}<span class="hljs-keyword">this</span>.subs.push(openSub);<span class="hljs-keyword">this</span>.subs.push(errorSub);<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>};Manager.prototype.onopen=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{debug(<span class="hljs-string">"open"</span>);<span class="hljs-keyword">this</span>.cleanup();<span class="hljs-keyword">this</span>.readyState=<span class="hljs-string">"open"</span>;<span class="hljs-keyword">this</span>.emit(<span class="hljs-string">"open"</span>);<span class="hljs-keyword">var</span> socket=<span class="hljs-keyword">this</span>.engine;<span class="hljs-keyword">this</span>.subs.push(on(socket,<span class="hljs-string">"data"</span>,bind(<span class="hljs-keyword">this</span>,<span class="hljs-string">"ondata"</span>)));<span class="hljs-keyword">this</span>.subs.push(on(socket,<span class="hljs-string">"ping"</span>,bind(<span class="hljs-keyword">this</span>,<span class="hljs-string">"onping"</span>)));<span class="hljs-keyword">this</span>.subs.push(on(socket,<span class="hljs-string">"pong"</span>,bind(<span class="hljs-keyword">this</span>,<span class="hljs-string">"onpong"</span>)));<span class="hljs-keyword">this</span>.subs.push(on(socket,<span class="hljs-string">"error"</span>,bind(<span class="hljs-keyword">this</span>,<span class="hljs-string">"onerror"</span>)));<span class="hljs-keyword">this</span>.subs.push(on(socket,<span class="hljs-string">"close"</span>,bind(<span class="hljs-keyword">this</span>,<span class="hljs-string">"onclose"</span>)));<span class="hljs-keyword">this</span>.subs.push(on(<span class="hljs-keyword">this</span>.decoder,<span class="hljs-string">"decoded"</span>,bind(<span class="hljs-keyword">this</span>,<span class="hljs-string">"ondecoded"</span>)))};Manager.prototype.onping=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{<span class="hljs-keyword">this</span>.lastPing=<span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>;<span class="hljs-keyword">this</span>.emitAll(<span class="hljs-string">"ping"</span>)};Manager.prototype.onpong=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{<span class="hljs-keyword">this</span>.emitAll(<span class="hljs-string">"pong"</span>,<span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>-<span class="hljs-keyword">this</span>.lastPing)};Manager.prototype.ondata=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">data</span>)</span>{<span class="hljs-keyword">this</span>.decoder.add(data)};Manager.prototype.ondecoded=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">packet</span>)</span>{<span class="hljs-keyword">this</span>.emit(<span class="hljs-string">"packet"</span>,packet)};Manager.prototype.onerror=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">err</span>)</span>{debug(<span class="hljs-string">"error"</span>,err);<span class="hljs-keyword">this</span>.emitAll(<span class="hljs-string">"error"</span>,err)};Manager.prototype.socket=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">nsp</span>)</span>{<span class="hljs-keyword">var</span> socket=<span class="hljs-keyword">this</span>.nsps[nsp];<span class="hljs-keyword">if</span>(!socket){socket=<span class="hljs-keyword">new</span> Socket(<span class="hljs-keyword">this</span>,nsp);<span class="hljs-keyword">this</span>.nsps[nsp]=socket;<span class="hljs-keyword">var</span> self=<span class="hljs-keyword">this</span>;socket.on(<span class="hljs-string">"connecting"</span>,onConnecting);
socket.on(<span class="hljs-string">"connect"</span>,<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{socket.id=self.engine.id});<span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.autoConnect){onConnecting()}}<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">onConnecting</span>(<span class="hljs-params"></span>)</span>{<span class="hljs-keyword">if</span>(!~indexOf(self.connecting,socket)){self.connecting.push(socket)}}<span class="hljs-keyword">return</span> socket};Manager.prototype.destroy=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">socket</span>)</span>{<span class="hljs-keyword">var</span> index=indexOf(<span class="hljs-keyword">this</span>.connecting,socket);<span class="hljs-keyword">if</span>(~index)<span class="hljs-keyword">this</span>.connecting.splice(index,<span class="hljs-number">1</span>);<span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.connecting.length)<span class="hljs-keyword">return</span>;<span class="hljs-keyword">this</span>.close()};Manager.prototype.packet=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">packet</span>)</span>{debug(<span class="hljs-string">"writing packet %j"</span>,packet);<span class="hljs-keyword">var</span> self=<span class="hljs-keyword">this</span>;<span class="hljs-keyword">if</span>(!self.encoding){self.encoding=<span class="hljs-literal">true</span>;<span class="hljs-keyword">this</span>.encoder.encode(packet,<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">encodedPackets</span>)</span>{<span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> i=<span class="hljs-number">0</span>;i&lt;encodedPackets.length;i++){self.engine.write(encodedPackets[i],packet.options)}self.encoding=<span class="hljs-literal">false</span>;self.processPacketQueue()})}<span class="hljs-keyword">else</span>{self.packetBuffer.push(packet)}};Manager.prototype.processPacketQueue=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{<span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.packetBuffer.length&gt;<span class="hljs-number">0</span>&amp;&amp;!<span class="hljs-keyword">this</span>.encoding){<span class="hljs-keyword">var</span> pack=<span class="hljs-keyword">this</span>.packetBuffer.shift();<span class="hljs-keyword">this</span>.packet(pack)}};Manager.prototype.cleanup=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{debug(<span class="hljs-string">"cleanup"</span>);<span class="hljs-keyword">var</span> sub;<span class="hljs-keyword">while</span>(sub=<span class="hljs-keyword">this</span>.subs.shift())sub.destroy();<span class="hljs-keyword">this</span>.packetBuffer=[];<span class="hljs-keyword">this</span>.encoding=<span class="hljs-literal">false</span>;<span class="hljs-keyword">this</span>.lastPing=<span class="hljs-literal">null</span>;<span class="hljs-keyword">this</span>.decoder.destroy()};Manager.prototype.close=Manager.prototype.disconnect=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{debug(<span class="hljs-string">"disconnect"</span>);<span class="hljs-keyword">this</span>.skipReconnect=<span class="hljs-literal">true</span>;<span class="hljs-keyword">this</span>.reconnecting=<span class="hljs-literal">false</span>;<span class="hljs-keyword">if</span>(<span class="hljs-string">"opening"</span>==<span class="hljs-keyword">this</span>.readyState){<span class="hljs-keyword">this</span>.cleanup()}<span class="hljs-keyword">this</span>.backoff.reset();<span class="hljs-keyword">this</span>.readyState=<span class="hljs-string">"closed"</span>;<span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.engine)<span class="hljs-keyword">this</span>.engine.close()};Manager.prototype.onclose=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">reason</span>)</span>{debug(<span class="hljs-string">"onclose"</span>);<span class="hljs-keyword">this</span>.cleanup();<span class="hljs-keyword">this</span>.backoff.reset();<span class="hljs-keyword">this</span>.readyState=<span class="hljs-string">"closed"</span>;<span class="hljs-keyword">this</span>.emit(<span class="hljs-string">"close"</span>,reason);<span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>._reconnection&amp;&amp;!<span class="hljs-keyword">this</span>.skipReconnect){<span class="hljs-keyword">this</span>.reconnect()}};Manager.prototype.reconnect=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{<span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.reconnecting||<span class="hljs-keyword">this</span>.skipReconnect)<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;<span class="hljs-keyword">var</span> self=<span class="hljs-keyword">this</span>;<span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.backoff.attempts&gt;=<span class="hljs-keyword">this</span>._reconnectionAttempts){debug(<span class="hljs-string">"reconnect failed"</span>);<span class="hljs-keyword">this</span>.backoff.reset();<span class="hljs-keyword">this</span>.emitAll(<span class="hljs-string">"reconnect_failed"</span>);<span class="hljs-keyword">this</span>.reconnecting=<span class="hljs-literal">false</span>}<span class="hljs-keyword">else</span>{<span class="hljs-keyword">var</span> delay=<span class="hljs-keyword">this</span>.backoff.duration();debug(<span class="hljs-string">"will wait %dms before reconnect attempt"</span>,delay);<span class="hljs-keyword">this</span>.reconnecting=<span class="hljs-literal">true</span>;<span class="hljs-keyword">var</span> timer=setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{<span class="hljs-keyword">if</span>(self.skipReconnect)<span class="hljs-keyword">return</span>;debug(<span class="hljs-string">"attempting reconnect"</span>);self.emitAll(<span class="hljs-string">"reconnect_attempt"</span>,self.backoff.attempts);self.emitAll(<span class="hljs-string">"reconnecting"</span>,self.backoff.attempts);<span class="hljs-keyword">if</span>(self.skipReconnect)<span class="hljs-keyword">return</span>;self.open(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">err</span>)</span>{<span class="hljs-keyword">if</span>(err){debug(<span class="hljs-string">"reconnect attempt error"</span>);self.reconnecting=<span class="hljs-literal">false</span>;self.reconnect();self.emitAll(<span class="hljs-string">"reconnect_error"</span>,err.data)}<span class="hljs-keyword">else</span>{debug(<span class="hljs-string">"reconnect success"</span>);self.onreconnect()}})},delay);<span class="hljs-keyword">this</span>.subs.push({<span class="hljs-attr">destroy</span>:<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{clearTimeout(timer)}})}};Manager.prototype.onreconnect=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{<span class="hljs-keyword">var</span> attempt=<span class="hljs-keyword">this</span>.backoff.attempts;<span class="hljs-keyword">this</span>.reconnecting=<span class="hljs-literal">false</span>;<span class="hljs-keyword">this</span>.backoff.reset();<span class="hljs-keyword">this</span>.updateSocketIds();<span class="hljs-keyword">this</span>.emitAll(<span class="hljs-string">"reconnect"</span>,attempt)}},{<span class="hljs-string">"./on"</span>:<span class="hljs-number">33</span>,<span class="hljs-string">"./socket"</span>:<span class="hljs-number">34</span>,<span class="hljs-attr">backo2</span>:<span class="hljs-number">36</span>,<span class="hljs-string">"component-bind"</span>:<span class="hljs-number">37</span>,<span class="hljs-string">"component-emitter"</span>:<span class="hljs-number">38</span>,<span class="hljs-attr">debug</span>:<span class="hljs-number">39</span>,<span class="hljs-string">"engine.io-client"</span>:<span class="hljs-number">1</span>,<span class="hljs-attr">indexof</span>:<span class="hljs-number">42</span>,<span class="hljs-string">"socket.io-parser"</span>:<span class="hljs-number">47</span>}],<span class="hljs-number">33</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">_dereq_,module,exports</span>)</span>{<span class="hljs-built_in">module</span>.exports=on;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">on</span>(<span class="hljs-params">obj,ev,fn</span>)</span>{obj.on(ev,fn);<span class="hljs-keyword">return</span>{<span class="hljs-attr">destroy</span>:<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{obj.removeListener(ev,fn)}}}},{}],<span class="hljs-number">34</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">_dereq_,module,exports</span>)</span>{<span class="hljs-keyword">var</span> parser=_dereq_(<span class="hljs-string">"socket.io-parser"</span>);<span class="hljs-keyword">var</span> Emitter=_dereq_(<span class="hljs-string">"component-emitter"</span>);<span class="hljs-keyword">var</span> toArray=_dereq_(<span class="hljs-string">"to-array"</span>);<span class="hljs-keyword">var</span> on=_dereq_(<span class="hljs-string">"./on"</span>);<span class="hljs-keyword">var</span> bind=_dereq_(<span class="hljs-string">"component-bind"</span>);<span class="hljs-keyword">var</span> debug=_dereq_(<span class="hljs-string">"debug"</span>)(<span class="hljs-string">"socket.io-client:socket"</span>);<span class="hljs-keyword">var</span> hasBin=_dereq_(<span class="hljs-string">"has-binary"</span>);<span class="hljs-built_in">module</span>.exports=exports=Socket;<span class="hljs-keyword">var</span> events={<span class="hljs-attr">connect</span>:<span class="hljs-number">1</span>,<span class="hljs-attr">connect_error</span>:<span class="hljs-number">1</span>,<span class="hljs-attr">connect_timeout</span>:<span class="hljs-number">1</span>,<span class="hljs-attr">connecting</span>:<span class="hljs-number">1</span>,<span class="hljs-attr">disconnect</span>:<span class="hljs-number">1</span>,<span class="hljs-attr">error</span>:<span class="hljs-number">1</span>,<span class="hljs-attr">reconnect</span>:<span class="hljs-number">1</span>,<span class="hljs-attr">reconnect_attempt</span>:<span class="hljs-number">1</span>,<span class="hljs-attr">reconnect_failed</span>:<span class="hljs-number">1</span>,<span class="hljs-attr">reconnect_error</span>:<span class="hljs-number">1</span>,<span class="hljs-attr">reconnecting</span>:<span class="hljs-number">1</span>,<span class="hljs-attr">ping</span>:<span class="hljs-number">1</span>,<span class="hljs-attr">pong</span>:<span class="hljs-number">1</span>};<span class="hljs-keyword">var</span> emit=Emitter.prototype.emit;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Socket</span>(<span class="hljs-params">io,nsp</span>)</span>{<span class="hljs-keyword">this</span>.io=io;<span class="hljs-keyword">this</span>.nsp=nsp;<span class="hljs-keyword">this</span>.json=<span class="hljs-keyword">this</span>;<span class="hljs-keyword">this</span>.ids=<span class="hljs-number">0</span>;<span class="hljs-keyword">this</span>.acks={};<span class="hljs-keyword">this</span>.receiveBuffer=[];<span class="hljs-keyword">this</span>.sendBuffer=[];<span class="hljs-keyword">this</span>.connected=<span class="hljs-literal">false</span>;<span class="hljs-keyword">this</span>.disconnected=<span class="hljs-literal">true</span>;<span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.io.autoConnect)<span class="hljs-keyword">this</span>.open()}Emitter(Socket.prototype);Socket.prototype.subEvents=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{<span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.subs)<span class="hljs-keyword">return</span>;<span class="hljs-keyword">var</span> io=<span class="hljs-keyword">this</span>.io;<span class="hljs-keyword">this</span>.subs=[on(io,<span class="hljs-string">"open"</span>,bind(<span class="hljs-keyword">this</span>,<span class="hljs-string">"onopen"</span>)),on(io,<span class="hljs-string">"packet"</span>,bind(<span class="hljs-keyword">this</span>,<span class="hljs-string">"onpacket"</span>)),on(io,<span class="hljs-string">"close"</span>,bind(<span class="hljs-keyword">this</span>,<span class="hljs-string">"onclose"</span>))]};Socket.prototype.open=Socket.prototype.connect=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{<span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.connected)<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;<span class="hljs-keyword">this</span>.subEvents();<span class="hljs-keyword">this</span>.io.open();<span class="hljs-keyword">if</span>(<span class="hljs-string">"open"</span>==<span class="hljs-keyword">this</span>.io.readyState)<span class="hljs-keyword">this</span>.onopen();<span class="hljs-keyword">this</span>.emit(<span class="hljs-string">"connecting"</span>);<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>};Socket.prototype.send=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{<span class="hljs-keyword">var</span> args=toArray(<span class="hljs-built_in">arguments</span>);args.unshift(<span class="hljs-string">"message"</span>);<span class="hljs-keyword">this</span>.emit.apply(<span class="hljs-keyword">this</span>,args);<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>};Socket.prototype.emit=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">ev</span>)</span>{<span class="hljs-keyword">if</span>(events.hasOwnProperty(ev)){emit.apply(<span class="hljs-keyword">this</span>,<span class="hljs-built_in">arguments</span>);<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>}<span class="hljs-keyword">var</span> args=toArray(<span class="hljs-built_in">arguments</span>);<span class="hljs-keyword">var</span> parserType=parser.EVENT;<span class="hljs-keyword">if</span>(hasBin(args)){parserType=parser.BINARY_EVENT}<span class="hljs-keyword">var</span> packet={<span class="hljs-attr">type</span>:parserType,<span class="hljs-attr">data</span>:args};packet.options={};packet.options.compress=!<span class="hljs-keyword">this</span>.flags||<span class="hljs-literal">false</span>!==<span class="hljs-keyword">this</span>.flags.compress;<span class="hljs-keyword">if</span>(<span class="hljs-string">"function"</span>==<span class="hljs-keyword">typeof</span> args[args.length<span class="hljs-number">-1</span>]){debug(<span class="hljs-string">"emitting packet with ack id %d"</span>,<span class="hljs-keyword">this</span>.ids);<span class="hljs-keyword">this</span>.acks[<span class="hljs-keyword">this</span>.ids]=args.pop();packet.id=<span class="hljs-keyword">this</span>.ids++}<span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.connected){<span class="hljs-keyword">this</span>.packet(packet)}<span class="hljs-keyword">else</span>{<span class="hljs-keyword">this</span>.sendBuffer.push(packet)}<span class="hljs-keyword">delete</span> <span class="hljs-keyword">this</span>.flags;<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>};Socket.prototype.packet=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">packet</span>)</span>{packet.nsp=<span class="hljs-keyword">this</span>.nsp;<span class="hljs-keyword">this</span>.io.packet(packet)};Socket.prototype.onopen=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{debug(<span class="hljs-string">"transport is open - connecting"</span>);<span class="hljs-keyword">if</span>(<span class="hljs-string">"/"</span>!=<span class="hljs-keyword">this</span>.nsp){<span class="hljs-keyword">this</span>.packet({<span class="hljs-attr">type</span>:parser.CONNECT})}};Socket.prototype.onclose=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">reason</span>)</span>{debug(<span class="hljs-string">"close (%s)"</span>,reason);<span class="hljs-keyword">this</span>.connected=<span class="hljs-literal">false</span>;<span class="hljs-keyword">this</span>.disconnected=<span class="hljs-literal">true</span>;<span class="hljs-keyword">delete</span> <span class="hljs-keyword">this</span>.id;<span class="hljs-keyword">this</span>.emit(<span class="hljs-string">"disconnect"</span>,reason)};Socket.prototype.onpacket=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">packet</span>)</span>{<span class="hljs-keyword">if</span>(packet.nsp!=<span class="hljs-keyword">this</span>.nsp)<span class="hljs-keyword">return</span>;<span class="hljs-keyword">switch</span>(packet.type){<span class="hljs-keyword">case</span> parser.CONNECT:<span class="hljs-keyword">this</span>.onconnect();<span class="hljs-keyword">break</span>;<span class="hljs-keyword">case</span> parser.EVENT:<span class="hljs-keyword">this</span>.onevent(packet);<span class="hljs-keyword">break</span>;<span class="hljs-keyword">case</span> parser.BINARY_EVENT:<span class="hljs-keyword">this</span>.onevent(packet);<span class="hljs-keyword">break</span>;<span class="hljs-keyword">case</span> parser.ACK:<span class="hljs-keyword">this</span>.onack(packet);<span class="hljs-keyword">break</span>;<span class="hljs-keyword">case</span> parser.BINARY_ACK:<span class="hljs-keyword">this</span>.onack(packet);<span class="hljs-keyword">break</span>;<span class="hljs-keyword">case</span> parser.DISCONNECT:<span class="hljs-keyword">this</span>.ondisconnect();<span class="hljs-keyword">break</span>;<span class="hljs-keyword">case</span> parser.ERROR:<span class="hljs-keyword">this</span>.emit(<span class="hljs-string">"error"</span>,packet.data);<span class="hljs-keyword">break</span>}};Socket.prototype.onevent=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">packet</span>)</span>{<span class="hljs-keyword">var</span> args=packet.data||[];debug(<span class="hljs-string">"emitting event %j"</span>,args);<span class="hljs-keyword">if</span>(<span class="hljs-literal">null</span>!=packet.id){debug(<span class="hljs-string">"attaching ack callback to event"</span>);args.push(<span class="hljs-keyword">this</span>.ack(packet.id))}<span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.connected){emit.apply(<span class="hljs-keyword">this</span>,args)}<span class="hljs-keyword">else</span>{<span class="hljs-keyword">this</span>.receiveBuffer.push(args)}};Socket.prototype.ack=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">id</span>)</span>{<span class="hljs-keyword">var</span> self=<span class="hljs-keyword">this</span>;<span class="hljs-keyword">var</span> sent=<span class="hljs-literal">false</span>;<span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{<span class="hljs-keyword">if</span>(sent)<span class="hljs-keyword">return</span>;sent=<span class="hljs-literal">true</span>;<span class="hljs-keyword">var</span> args=toArray(<span class="hljs-built_in">arguments</span>);debug(<span class="hljs-string">"sending ack %j"</span>,args);<span class="hljs-keyword">var</span> type=hasBin(args)?parser.BINARY_ACK:parser.ACK;self.packet({<span class="hljs-attr">type</span>:type,<span class="hljs-attr">id</span>:id,<span class="hljs-attr">data</span>:args})}};Socket.prototype.onack=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">packet</span>)</span>{<span class="hljs-keyword">var</span> ack=<span class="hljs-keyword">this</span>.acks[packet.id];<span class="hljs-keyword">if</span>(<span class="hljs-string">"function"</span>==<span class="hljs-keyword">typeof</span> ack){debug(<span class="hljs-string">"calling ack %s with %j"</span>,packet.id,packet.data);ack.apply(<span class="hljs-keyword">this</span>,packet.data);<span class="hljs-keyword">delete</span> <span class="hljs-keyword">this</span>.acks[packet.id]}<span class="hljs-keyword">else</span>{debug(<span class="hljs-string">"bad ack %s"</span>,packet.id)}};Socket.prototype.onconnect=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{<span class="hljs-keyword">this</span>.connected=<span class="hljs-literal">true</span>;<span class="hljs-keyword">this</span>.disconnected=<span class="hljs-literal">false</span>;<span class="hljs-keyword">this</span>.emit(<span class="hljs-string">"connect"</span>);<span class="hljs-keyword">this</span>.emitBuffered()};Socket.prototype.emitBuffered=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{<span class="hljs-keyword">var</span> i;<span class="hljs-keyword">for</span>(i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-keyword">this</span>.receiveBuffer.length;i++){emit.apply(<span class="hljs-keyword">this</span>,<span class="hljs-keyword">this</span>.receiveBuffer[i])}<span class="hljs-keyword">this</span>.receiveBuffer=[];<span class="hljs-keyword">for</span>(i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-keyword">this</span>.sendBuffer.length;i++){<span class="hljs-keyword">this</span>.packet(<span class="hljs-keyword">this</span>.sendBuffer[i])}<span class="hljs-keyword">this</span>.sendBuffer=[]};Socket.prototype.ondisconnect=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{debug(<span class="hljs-string">"server disconnect (%s)"</span>,<span class="hljs-keyword">this</span>.nsp);<span class="hljs-keyword">this</span>.destroy();<span class="hljs-keyword">this</span>.onclose(<span class="hljs-string">"io server disconnect"</span>)};Socket.prototype.destroy=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{<span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.subs){<span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-keyword">this</span>.subs.length;i++){<span class="hljs-keyword">this</span>.subs[i].destroy()}<span class="hljs-keyword">this</span>.subs=<span class="hljs-literal">null</span>}<span class="hljs-keyword">this</span>.io.destroy(<span class="hljs-keyword">this</span>)};Socket.prototype.close=Socket.prototype.disconnect=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{<span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.connected){debug(<span class="hljs-string">"performing disconnect (%s)"</span>,<span class="hljs-keyword">this</span>.nsp);<span class="hljs-keyword">this</span>.packet({<span class="hljs-attr">type</span>:parser.DISCONNECT})}<span class="hljs-keyword">this</span>.destroy();<span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.connected){<span class="hljs-keyword">this</span>.onclose(<span class="hljs-string">"io client disconnect"</span>)}<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>};Socket.prototype.compress=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">compress</span>)</span>{<span class="hljs-keyword">this</span>.flags=<span class="hljs-keyword">this</span>.flags||{};<span class="hljs-keyword">this</span>.flags.compress=compress;<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>}},{<span class="hljs-string">"./on"</span>:<span class="hljs-number">33</span>,<span class="hljs-string">"component-bind"</span>:<span class="hljs-number">37</span>,<span class="hljs-string">"component-emitter"</span>:<span class="hljs-number">38</span>,<span class="hljs-attr">debug</span>:<span class="hljs-number">39</span>,<span class="hljs-string">"has-binary"</span>:<span class="hljs-number">41</span>,<span class="hljs-string">"socket.io-parser"</span>:<span class="hljs-number">47</span>,<span class="hljs-string">"to-array"</span>:<span class="hljs-number">51</span>}],<span class="hljs-number">35</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">_dereq_,module,exports</span>)</span>{(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">global</span>)</span>{<span class="hljs-keyword">var</span> parseuri=_dereq_(<span class="hljs-string">"parseuri"</span>);<span class="hljs-keyword">var</span> debug=_dereq_(<span class="hljs-string">"debug"</span>)(<span class="hljs-string">"socket.io-client:url"</span>);<span class="hljs-built_in">module</span>.exports=url;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">url</span>(<span class="hljs-params">uri,loc</span>)</span>{<span class="hljs-keyword">var</span> obj=uri;<span class="hljs-keyword">var</span> loc=loc||global.location;<span class="hljs-keyword">if</span>(<span class="hljs-literal">null</span>==uri)uri=loc.protocol+<span class="hljs-string">"//"</span>+loc.host;<span class="hljs-keyword">if</span>(<span class="hljs-string">"string"</span>==<span class="hljs-keyword">typeof</span> uri){<span class="hljs-keyword">if</span>(<span class="hljs-string">"/"</span>==uri.charAt(<span class="hljs-number">0</span>)){<span class="hljs-keyword">if</span>(<span class="hljs-string">"/"</span>==uri.charAt(<span class="hljs-number">1</span>)){uri=loc.protocol+uri}<span class="hljs-keyword">else</span>{uri=loc.host+uri}}<span class="hljs-keyword">if</span>(!<span class="hljs-regexp">/^(https?|wss?):\/\//</span>.test(uri)){debug(<span class="hljs-string">"protocol-less url %s"</span>,uri);<span class="hljs-keyword">if</span>(<span class="hljs-string">"undefined"</span>!=<span class="hljs-keyword">typeof</span> loc){uri=loc.protocol+<span class="hljs-string">"//"</span>+uri}<span class="hljs-keyword">else</span>{uri=<span class="hljs-string">"https://"</span>+uri}}debug(<span class="hljs-string">"parse %s"</span>,uri);obj=parseuri(uri)}<span class="hljs-keyword">if</span>(!obj.port){<span class="hljs-keyword">if</span>(<span class="hljs-regexp">/^(http|ws)$/</span>.test(obj.protocol)){obj.port=<span class="hljs-string">"80"</span>}<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(<span class="hljs-regexp">/^(http|ws)s$/</span>.test(obj.protocol)){obj.port=<span class="hljs-string">"443"</span>}}obj.path=obj.path||<span class="hljs-string">"/"</span>;<span class="hljs-keyword">var</span> ipv6=obj.host.indexOf(<span class="hljs-string">":"</span>)!==<span class="hljs-number">-1</span>;<span class="hljs-keyword">var</span> host=ipv6?<span class="hljs-string">"["</span>+obj.host+<span class="hljs-string">"]"</span>:obj.host;obj.id=obj.protocol+<span class="hljs-string">"://"</span>+host+<span class="hljs-string">":"</span>+obj.port;obj.href=obj.protocol+<span class="hljs-string">"://"</span>+host+(loc&amp;&amp;loc.port==obj.port?<span class="hljs-string">""</span>:<span class="hljs-string">":"</span>+obj.port);<span class="hljs-keyword">return</span> obj}}).call(<span class="hljs-keyword">this</span>,<span class="hljs-keyword">typeof</span> self!==<span class="hljs-string">"undefined"</span>?self:<span class="hljs-keyword">typeof</span> <span class="hljs-built_in">window</span>!==<span class="hljs-string">"undefined"</span>?<span class="hljs-built_in">window</span>:<span class="hljs-keyword">typeof</span> global!==<span class="hljs-string">"undefined"</span>?global:{})},{<span class="hljs-attr">debug</span>:<span class="hljs-number">39</span>,<span class="hljs-attr">parseuri</span>:<span class="hljs-number">45</span>}],<span class="hljs-number">36</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">_dereq_,module,exports</span>)</span>{<span class="hljs-built_in">module</span>.exports=Backoff;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Backoff</span>(<span class="hljs-params">opts</span>)</span>{opts=opts||{};<span class="hljs-keyword">this</span>.ms=opts.min||<span class="hljs-number">100</span>;<span class="hljs-keyword">this</span>.max=opts.max||<span class="hljs-number">1e4</span>;<span class="hljs-keyword">this</span>.factor=opts.factor||<span class="hljs-number">2</span>;<span class="hljs-keyword">this</span>.jitter=opts.jitter&gt;<span class="hljs-number">0</span>&amp;&amp;opts.jitter&lt;=<span class="hljs-number">1</span>?opts.jitter:<span class="hljs-number">0</span>;<span class="hljs-keyword">this</span>.attempts=<span class="hljs-number">0</span>}Backoff.prototype.duration=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{<span class="hljs-keyword">var</span> ms=<span class="hljs-keyword">this</span>.ms*<span class="hljs-built_in">Math</span>.pow(<span class="hljs-keyword">this</span>.factor,<span class="hljs-keyword">this</span>.attempts++);<span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.jitter){<span class="hljs-keyword">var</span> rand=<span class="hljs-built_in">Math</span>.random();<span class="hljs-keyword">var</span> deviation=<span class="hljs-built_in">Math</span>.floor(rand*<span class="hljs-keyword">this</span>.jitter*ms);ms=(<span class="hljs-built_in">Math</span>.floor(rand*<span class="hljs-number">10</span>)&amp;<span class="hljs-number">1</span>)==<span class="hljs-number">0</span>?ms-deviation:ms+deviation}<span class="hljs-keyword">return</span> <span class="hljs-built_in">Math</span>.min(ms,<span class="hljs-keyword">this</span>.max)|<span class="hljs-number">0</span>};Backoff.prototype.reset=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{<span class="hljs-keyword">this</span>.attempts=<span class="hljs-number">0</span>};Backoff.prototype.setMin=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">min</span>)</span>{<span class="hljs-keyword">this</span>.ms=min};Backoff.prototype.setMax=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">max</span>)</span>{<span class="hljs-keyword">this</span>.max=max};Backoff.prototype.setJitter=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">jitter</span>)</span>{<span class="hljs-keyword">this</span>.jitter=jitter}},{}],<span class="hljs-number">37</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">_dereq_,module,exports</span>)</span>{<span class="hljs-keyword">var</span> slice=[].slice;<span class="hljs-built_in">module</span>.exports=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">obj,fn</span>)</span>{<span class="hljs-keyword">if</span>(<span class="hljs-string">"string"</span>==<span class="hljs-keyword">typeof</span> fn)fn=obj[fn];<span class="hljs-keyword">if</span>(<span class="hljs-string">"function"</span>!=<span class="hljs-keyword">typeof</span> fn)<span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"bind() requires a function"</span>);<span class="hljs-keyword">var</span> args=slice.call(<span class="hljs-built_in">arguments</span>,<span class="hljs-number">2</span>);<span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{<span class="hljs-keyword">return</span> fn.apply(obj,args.concat(slice.call(<span class="hljs-built_in">arguments</span>)))}}},{}],<span class="hljs-number">38</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">_dereq_,module,exports</span>)</span>{<span class="hljs-built_in">module</span>.exports=Emitter;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Emitter</span>(<span class="hljs-params">obj</span>)</span>{<span class="hljs-keyword">if</span>(obj)<span class="hljs-keyword">return</span> mixin(obj)}<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">mixin</span>(<span class="hljs-params">obj</span>)</span>{<span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> key <span class="hljs-keyword">in</span> Emitter.prototype){obj[key]=Emitter.prototype[key]}<span class="hljs-keyword">return</span> obj}Emitter.prototype.on=Emitter.prototype.addEventListener=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">event,fn</span>)</span>{<span class="hljs-keyword">this</span>._callbacks=<span class="hljs-keyword">this</span>._callbacks||{};(<span class="hljs-keyword">this</span>._callbacks[<span class="hljs-string">"$"</span>+event]=<span class="hljs-keyword">this</span>._callbacks[<span class="hljs-string">"$"</span>+event]||[]).push(fn);<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>};Emitter.prototype.once=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">event,fn</span>)</span>{<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">on</span>(<span class="hljs-params"></span>)</span>{<span class="hljs-keyword">this</span>.off(event,on);fn.apply(<span class="hljs-keyword">this</span>,<span class="hljs-built_in">arguments</span>)}on.fn=fn;<span class="hljs-keyword">this</span>.on(event,on);<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>};Emitter.prototype.off=Emitter.prototype.removeListener=Emitter.prototype.removeAllListeners=Emitter.prototype.removeEventListener=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">event,fn</span>)</span>{<span class="hljs-keyword">this</span>._callbacks=<span class="hljs-keyword">this</span>._callbacks||{};<span class="hljs-keyword">if</span>(<span class="hljs-number">0</span>==<span class="hljs-built_in">arguments</span>.length){<span class="hljs-keyword">this</span>._callbacks={};<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>}<span class="hljs-keyword">var</span> callbacks=<span class="hljs-keyword">this</span>._callbacks[<span class="hljs-string">"$"</span>+event];<span class="hljs-keyword">if</span>(!callbacks)<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;<span class="hljs-keyword">if</span>(<span class="hljs-number">1</span>==<span class="hljs-built_in">arguments</span>.length){<span class="hljs-keyword">delete</span> <span class="hljs-keyword">this</span>._callbacks[<span class="hljs-string">"$"</span>+event];<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>}<span class="hljs-keyword">var</span> cb;<span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> i=<span class="hljs-number">0</span>;i&lt;callbacks.length;i++){cb=callbacks[i];<span class="hljs-keyword">if</span>(cb===fn||cb.fn===fn){callbacks.splice(i,<span class="hljs-number">1</span>);<span class="hljs-keyword">break</span>}}<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>};Emitter.prototype.emit=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">event</span>)</span>{<span class="hljs-keyword">this</span>._callbacks=<span class="hljs-keyword">this</span>._callbacks||{};<span class="hljs-keyword">var</span> args=[].slice.call(<span class="hljs-built_in">arguments</span>,<span class="hljs-number">1</span>),callbacks=<span class="hljs-keyword">this</span>._callbacks[<span class="hljs-string">"$"</span>+event];<span class="hljs-keyword">if</span>(callbacks){callbacks=callbacks.slice(<span class="hljs-number">0</span>);<span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> i=<span class="hljs-number">0</span>,len=callbacks.length;i&lt;len;++i){callbacks[i].apply(<span class="hljs-keyword">this</span>,args)}}<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>};Emitter.prototype.listeners=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">event</span>)</span>{<span class="hljs-keyword">this</span>._callbacks=<span class="hljs-keyword">this</span>._callbacks||{};<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._callbacks[<span class="hljs-string">"$"</span>+event]||[]};Emitter.prototype.hasListeners=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">event</span>)</span>{<span class="hljs-keyword">return</span>!!<span class="hljs-keyword">this</span>.listeners(event).length}},{}],<span class="hljs-number">39</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">_dereq_,module,exports</span>)</span>{<span class="hljs-built_in">arguments</span>[<span class="hljs-number">4</span>][<span class="hljs-number">17</span>][<span class="hljs-number">0</span>].apply(exports,<span class="hljs-built_in">arguments</span>)},{<span class="hljs-string">"./debug"</span>:<span class="hljs-number">40</span>,<span class="hljs-attr">dup</span>:<span class="hljs-number">17</span>}],<span class="hljs-number">40</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">_dereq_,module,exports</span>)</span>{<span class="hljs-built_in">arguments</span>[<span class="hljs-number">4</span>][<span class="hljs-number">18</span>][<span class="hljs-number">0</span>].apply(exports,<span class="hljs-built_in">arguments</span>)},{<span class="hljs-attr">dup</span>:<span class="hljs-number">18</span>,<span class="hljs-attr">ms</span>:<span class="hljs-number">44</span>}],<span class="hljs-number">41</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">_dereq_,module,exports</span>)</span>{(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">global</span>)</span>{<span class="hljs-keyword">var</span> isArray=_dereq_(<span class="hljs-string">"isarray"</span>);<span class="hljs-built_in">module</span>.exports=hasBinary;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">hasBinary</span>(<span class="hljs-params">data</span>)</span>{<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">_hasBinary</span>(<span class="hljs-params">obj</span>)</span>{<span class="hljs-keyword">if</span>(!obj)<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<span class="hljs-keyword">if</span>(global.Buffer&amp;&amp;global.Buffer.isBuffer&amp;&amp;global.Buffer.isBuffer(obj)||global.ArrayBuffer&amp;&amp;obj <span class="hljs-keyword">instanceof</span> <span class="hljs-built_in">ArrayBuffer</span>||global.Blob&amp;&amp;obj <span class="hljs-keyword">instanceof</span> Blob||global.File&amp;&amp;obj <span class="hljs-keyword">instanceof</span> File){<span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>}<span class="hljs-keyword">if</span>(isArray(obj)){<span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> i=<span class="hljs-number">0</span>;i&lt;obj.length;i++){<span class="hljs-keyword">if</span>(_hasBinary(obj[i])){<span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>}}}<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(obj&amp;&amp;<span class="hljs-string">"object"</span>==<span class="hljs-keyword">typeof</span> obj){<span class="hljs-keyword">if</span>(obj.toJSON&amp;&amp;<span class="hljs-string">"function"</span>==<span class="hljs-keyword">typeof</span> obj.toJSON){obj=obj.toJSON()}<span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> key <span class="hljs-keyword">in</span> obj){<span class="hljs-keyword">if</span>(<span class="hljs-built_in">Object</span>.prototype.hasOwnProperty.call(obj,key)&amp;&amp;_hasBinary(obj[key])){<span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>}}}<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>}<span class="hljs-keyword">return</span> _hasBinary(data)}}).call(<span class="hljs-keyword">this</span>,<span class="hljs-keyword">typeof</span> self!==<span class="hljs-string">"undefined"</span>?self:<span class="hljs-keyword">typeof</span> <span class="hljs-built_in">window</span>!==<span class="hljs-string">"undefined"</span>?<span class="hljs-built_in">window</span>:<span class="hljs-keyword">typeof</span> global!==<span class="hljs-string">"undefined"</span>?global:{})},{<span class="hljs-attr">isarray</span>:<span class="hljs-number">43</span>}],<span class="hljs-number">42</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">_dereq_,module,exports</span>)</span>{<span class="hljs-built_in">arguments</span>[<span class="hljs-number">4</span>][<span class="hljs-number">23</span>][<span class="hljs-number">0</span>].apply(exports,<span class="hljs-built_in">arguments</span>)},{<span class="hljs-attr">dup</span>:<span class="hljs-number">23</span>}],<span class="hljs-number">43</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">_dereq_,module,exports</span>)</span>{<span class="hljs-built_in">arguments</span>[<span class="hljs-number">4</span>][<span class="hljs-number">24</span>][<span class="hljs-number">0</span>].apply(exports,<span class="hljs-built_in">arguments</span>)},{<span class="hljs-attr">dup</span>:<span class="hljs-number">24</span>}],<span class="hljs-number">44</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">_dereq_,module,exports</span>)</span>{<span class="hljs-built_in">arguments</span>[<span class="hljs-number">4</span>][<span class="hljs-number">25</span>][<span class="hljs-number">0</span>].apply(exports,<span class="hljs-built_in">arguments</span>)},{<span class="hljs-attr">dup</span>:<span class="hljs-number">25</span>}],<span class="hljs-number">45</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">_dereq_,module,exports</span>)</span>{<span class="hljs-built_in">arguments</span>[<span class="hljs-number">4</span>][<span class="hljs-number">28</span>][<span class="hljs-number">0</span>].apply(exports,<span class="hljs-built_in">arguments</span>)},{<span class="hljs-attr">dup</span>:<span class="hljs-number">28</span>}],<span class="hljs-number">46</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">_dereq_,module,exports</span>)</span>{(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">global</span>)</span>{<span class="hljs-keyword">var</span> isArray=_dereq_(<span class="hljs-string">"isarray"</span>);<span class="hljs-keyword">var</span> isBuf=_dereq_(<span class="hljs-string">"./is-buffer"</span>);exports.deconstructPacket=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">packet</span>)</span>{<span class="hljs-keyword">var</span> buffers=[];<span class="hljs-keyword">var</span> packetData=packet.data;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">_deconstructPacket</span>(<span class="hljs-params">data</span>)</span>{<span class="hljs-keyword">if</span>(!data)<span class="hljs-keyword">return</span> data;<span class="hljs-keyword">if</span>(isBuf(data)){<span class="hljs-keyword">var</span> placeholder={<span class="hljs-attr">_placeholder</span>:<span class="hljs-literal">true</span>,<span class="hljs-attr">num</span>:buffers.length};buffers.push(data);<span class="hljs-keyword">return</span> placeholder}<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(isArray(data)){<span class="hljs-keyword">var</span> newData=<span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>(data.length);<span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> i=<span class="hljs-number">0</span>;i&lt;data.length;i++){newData[i]=_deconstructPacket(data[i])}<span class="hljs-keyword">return</span> newData}<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(<span class="hljs-string">"object"</span>==<span class="hljs-keyword">typeof</span> data&amp;&amp;!(data <span class="hljs-keyword">instanceof</span> <span class="hljs-built_in">Date</span>)){<span class="hljs-keyword">var</span> newData={};<span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> key <span class="hljs-keyword">in</span> data){newData[key]=_deconstructPacket(data[key])}<span class="hljs-keyword">return</span> newData}<span class="hljs-keyword">return</span> data}<span class="hljs-keyword">var</span> pack=packet;pack.data=_deconstructPacket(packetData);pack.attachments=buffers.length;<span class="hljs-keyword">return</span>{<span class="hljs-attr">packet</span>:pack,<span class="hljs-attr">buffers</span>:buffers}};exports.reconstructPacket=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">packet,buffers</span>)</span>{<span class="hljs-keyword">var</span> curPlaceHolder=<span class="hljs-number">0</span>;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">_reconstructPacket</span>(<span class="hljs-params">data</span>)</span>{<span class="hljs-keyword">if</span>(data&amp;&amp;data._placeholder){<span class="hljs-keyword">var</span> buf=buffers[data.num];<span class="hljs-keyword">return</span> buf}<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(isArray(data)){<span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> i=<span class="hljs-number">0</span>;i&lt;data.length;i++){data[i]=_reconstructPacket(data[i])}<span class="hljs-keyword">return</span> data}<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(data&amp;&amp;<span class="hljs-string">"object"</span>==<span class="hljs-keyword">typeof</span> data){<span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> key <span class="hljs-keyword">in</span> data){data[key]=_reconstructPacket(data[key])}<span class="hljs-keyword">return</span> data}<span class="hljs-keyword">return</span> data}packet.data=_reconstructPacket(packet.data);packet.attachments=<span class="hljs-literal">undefined</span>;<span class="hljs-keyword">return</span> packet};exports.removeBlobs=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">data,callback</span>)</span>{<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">_removeBlobs</span>(<span class="hljs-params">obj,curKey,containingObject</span>)</span>{<span class="hljs-keyword">if</span>(!obj)<span class="hljs-keyword">return</span> obj;<span class="hljs-keyword">if</span>(global.Blob&amp;&amp;obj <span class="hljs-keyword">instanceof</span> Blob||global.File&amp;&amp;obj <span class="hljs-keyword">instanceof</span> File){pendingBlobs++;<span class="hljs-keyword">var</span> fileReader=<span class="hljs-keyword">new</span> FileReader;fileReader.onload=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{<span class="hljs-keyword">if</span>(containingObject){containingObject[curKey]=<span class="hljs-keyword">this</span>.result}<span class="hljs-keyword">else</span>{bloblessData=<span class="hljs-keyword">this</span>.result}<span class="hljs-keyword">if</span>(!--pendingBlobs){callback(bloblessData)}};fileReader.readAsArrayBuffer(obj)}<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(isArray(obj)){<span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> i=<span class="hljs-number">0</span>;i&lt;obj.length;i++){_removeBlobs(obj[i],i,obj)}}<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(obj&amp;&amp;<span class="hljs-string">"object"</span>==<span class="hljs-keyword">typeof</span> obj&amp;&amp;!isBuf(obj)){<span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> key <span class="hljs-keyword">in</span> obj){_removeBlobs(obj[key],key,obj)}}}<span class="hljs-keyword">var</span> pendingBlobs=<span class="hljs-number">0</span>;<span class="hljs-keyword">var</span> bloblessData=data;_removeBlobs(bloblessData);<span class="hljs-keyword">if</span>(!pendingBlobs){callback(bloblessData)}}}).call(<span class="hljs-keyword">this</span>,<span class="hljs-keyword">typeof</span> self!==<span class="hljs-string">"undefined"</span>?self:<span class="hljs-keyword">typeof</span> <span class="hljs-built_in">window</span>!==<span class="hljs-string">"undefined"</span>?<span class="hljs-built_in">window</span>:<span class="hljs-keyword">typeof</span> global!==<span class="hljs-string">"undefined"</span>?global:{})},{<span class="hljs-string">"./is-buffer"</span>:<span class="hljs-number">48</span>,<span class="hljs-attr">isarray</span>:<span class="hljs-number">43</span>}],<span class="hljs-number">47</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">_dereq_,module,exports</span>)</span>{<span class="hljs-keyword">var</span> debug=_dereq_(<span class="hljs-string">"debug"</span>)(<span class="hljs-string">"socket.io-parser"</span>);<span class="hljs-keyword">var</span> json=_dereq_(<span class="hljs-string">"json3"</span>);<span class="hljs-keyword">var</span> isArray=_dereq_(<span class="hljs-string">"isarray"</span>);<span class="hljs-keyword">var</span> Emitter=_dereq_(<span class="hljs-string">"component-emitter"</span>);<span class="hljs-keyword">var</span> binary=_dereq_(<span class="hljs-string">"./binary"</span>);<span class="hljs-keyword">var</span> isBuf=_dereq_(<span class="hljs-string">"./is-buffer"</span>);exports.protocol=<span class="hljs-number">4</span>;exports.types=[<span class="hljs-string">"CONNECT"</span>,<span class="hljs-string">"DISCONNECT"</span>,<span class="hljs-string">"EVENT"</span>,<span class="hljs-string">"BINARY_EVENT"</span>,<span class="hljs-string">"ACK"</span>,<span class="hljs-string">"BINARY_ACK"</span>,<span class="hljs-string">"ERROR"</span>];exports.CONNECT=<span class="hljs-number">0</span>;exports.DISCONNECT=<span class="hljs-number">1</span>;exports.EVENT=<span class="hljs-number">2</span>;exports.ACK=<span class="hljs-number">3</span>;exports.ERROR=<span class="hljs-number">4</span>;exports.BINARY_EVENT=<span class="hljs-number">5</span>;exports.BINARY_ACK=<span class="hljs-number">6</span>;exports.Encoder=Encoder;exports.Decoder=Decoder;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Encoder</span>(<span class="hljs-params"></span>)</span>{}Encoder.prototype.encode=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">obj,callback</span>)</span>{debug(<span class="hljs-string">"encoding packet %j"</span>,obj);<span class="hljs-keyword">if</span>(exports.BINARY_EVENT==obj.type||exports.BINARY_ACK==obj.type){encodeAsBinary(obj,callback)}<span class="hljs-keyword">else</span>{<span class="hljs-keyword">var</span> encoding=encodeAsString(obj);callback([encoding])}};<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">encodeAsString</span>(<span class="hljs-params">obj</span>)</span>{<span class="hljs-keyword">var</span> str=<span class="hljs-string">""</span>;<span class="hljs-keyword">var</span> nsp=<span class="hljs-literal">false</span>;str+=obj.type;<span class="hljs-keyword">if</span>(exports.BINARY_EVENT==obj.type||exports.BINARY_ACK==obj.type){str+=obj.attachments;str+=<span class="hljs-string">"-"</span>}<span class="hljs-keyword">if</span>(obj.nsp&amp;&amp;<span class="hljs-string">"/"</span>!=obj.nsp){nsp=<span class="hljs-literal">true</span>;str+=obj.nsp}<span class="hljs-keyword">if</span>(<span class="hljs-literal">null</span>!=obj.id){<span class="hljs-keyword">if</span>(nsp){str+=<span class="hljs-string">","</span>;nsp=<span class="hljs-literal">false</span>}str+=obj.id}<span class="hljs-keyword">if</span>(<span class="hljs-literal">null</span>!=obj.data){<span class="hljs-keyword">if</span>(nsp)str+=<span class="hljs-string">","</span>;str+=json.stringify(obj.data)}debug(<span class="hljs-string">"encoded %j as %s"</span>,obj,str);<span class="hljs-keyword">return</span> str}<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">encodeAsBinary</span>(<span class="hljs-params">obj,callback</span>)</span>{<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">writeEncoding</span>(<span class="hljs-params">bloblessData</span>)</span>{<span class="hljs-keyword">var</span> deconstruction=binary.deconstructPacket(bloblessData);<span class="hljs-keyword">var</span> pack=encodeAsString(deconstruction.packet);<span class="hljs-keyword">var</span> buffers=deconstruction.buffers;buffers.unshift(pack);callback(buffers)}binary.removeBlobs(obj,writeEncoding)}<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Decoder</span>(<span class="hljs-params"></span>)</span>{<span class="hljs-keyword">this</span>.reconstructor=<span class="hljs-literal">null</span>}Emitter(Decoder.prototype);Decoder.prototype.add=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">obj</span>)</span>{<span class="hljs-keyword">var</span> packet;<span class="hljs-keyword">if</span>(<span class="hljs-string">"string"</span>==<span class="hljs-keyword">typeof</span> obj){packet=decodeString(obj);<span class="hljs-keyword">if</span>(exports.BINARY_EVENT==packet.type||exports.BINARY_ACK==packet.type){<span class="hljs-keyword">this</span>.reconstructor=<span class="hljs-keyword">new</span> BinaryReconstructor(packet);<span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.reconstructor.reconPack.attachments===<span class="hljs-number">0</span>){<span class="hljs-keyword">this</span>.emit(<span class="hljs-string">"decoded"</span>,packet)}}<span class="hljs-keyword">else</span>{<span class="hljs-keyword">this</span>.emit(<span class="hljs-string">"decoded"</span>,packet)}}<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(isBuf(obj)||obj.base64){<span class="hljs-keyword">if</span>(!<span class="hljs-keyword">this</span>.reconstructor){<span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"got binary data when not reconstructing a packet"</span>)}<span class="hljs-keyword">else</span>{packet=<span class="hljs-keyword">this</span>.reconstructor.takeBinaryData(obj);<span class="hljs-keyword">if</span>(packet){<span class="hljs-keyword">this</span>.reconstructor=<span class="hljs-literal">null</span>;<span class="hljs-keyword">this</span>.emit(<span class="hljs-string">"decoded"</span>,packet)}}}<span class="hljs-keyword">else</span>{<span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"Unknown type: "</span>+obj)}};<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">decodeString</span>(<span class="hljs-params">str</span>)</span>{<span class="hljs-keyword">var</span> p={};<span class="hljs-keyword">var</span> i=<span class="hljs-number">0</span>;p.type=<span class="hljs-built_in">Number</span>(str.charAt(<span class="hljs-number">0</span>));<span class="hljs-keyword">if</span>(<span class="hljs-literal">null</span>==exports.types[p.type])<span class="hljs-keyword">return</span> error();<span class="hljs-keyword">if</span>(exports.BINARY_EVENT==p.type||exports.BINARY_ACK==p.type){<span class="hljs-keyword">var</span> buf=<span class="hljs-string">""</span>;<span class="hljs-keyword">while</span>(str.charAt(++i)!=<span class="hljs-string">"-"</span>){buf+=str.charAt(i);<span class="hljs-keyword">if</span>(i==str.length)<span class="hljs-keyword">break</span>}<span class="hljs-keyword">if</span>(buf!=<span class="hljs-built_in">Number</span>(buf)||str.charAt(i)!=<span class="hljs-string">"-"</span>){<span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"Illegal attachments"</span>)}p.attachments=<span class="hljs-built_in">Number</span>(buf)}<span class="hljs-keyword">if</span>(<span class="hljs-string">"/"</span>==str.charAt(i+<span class="hljs-number">1</span>)){p.nsp=<span class="hljs-string">""</span>;<span class="hljs-keyword">while</span>(++i){<span class="hljs-keyword">var</span> c=str.charAt(i);<span class="hljs-keyword">if</span>(<span class="hljs-string">","</span>==c)<span class="hljs-keyword">break</span>;p.nsp+=c;<span class="hljs-keyword">if</span>(i==str.length)<span class="hljs-keyword">break</span>}}<span class="hljs-keyword">else</span>{p.nsp=<span class="hljs-string">"/"</span>}<span class="hljs-keyword">var</span> next=str.charAt(i+<span class="hljs-number">1</span>);<span class="hljs-keyword">if</span>(<span class="hljs-string">""</span>!==next&amp;&amp;<span class="hljs-built_in">Number</span>(next)==next){p.id=<span class="hljs-string">""</span>;<span class="hljs-keyword">while</span>(++i){<span class="hljs-keyword">var</span> c=str.charAt(i);<span class="hljs-keyword">if</span>(<span class="hljs-literal">null</span>==c||<span class="hljs-built_in">Number</span>(c)!=c){--i;<span class="hljs-keyword">break</span>}p.id+=str.charAt(i);<span class="hljs-keyword">if</span>(i==str.length)<span class="hljs-keyword">break</span>}p.id=<span class="hljs-built_in">Number</span>(p.id)}<span class="hljs-keyword">if</span>(str.charAt(++i)){<span class="hljs-keyword">try</span>{p.data=json.parse(str.substr(i))}<span class="hljs-keyword">catch</span>(e){<span class="hljs-keyword">return</span> error()}}debug(<span class="hljs-string">"decoded %s as %j"</span>,str,p);<span class="hljs-keyword">return</span> p}Decoder.prototype.destroy=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{<span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.reconstructor){<span class="hljs-keyword">this</span>.reconstructor.finishedReconstruction()}};<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">BinaryReconstructor</span>(<span class="hljs-params">packet</span>)</span>{<span class="hljs-keyword">this</span>.reconPack=packet;<span class="hljs-keyword">this</span>.buffers=[]}BinaryReconstructor.prototype.takeBinaryData=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">binData</span>)</span>{<span class="hljs-keyword">this</span>.buffers.push(binData);<span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.buffers.length==<span class="hljs-keyword">this</span>.reconPack.attachments){<span class="hljs-keyword">var</span> packet=binary.reconstructPacket(<span class="hljs-keyword">this</span>.reconPack,<span class="hljs-keyword">this</span>.buffers);<span class="hljs-keyword">this</span>.finishedReconstruction();<span class="hljs-keyword">return</span> packet}<span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>};BinaryReconstructor.prototype.finishedReconstruction=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{<span class="hljs-keyword">this</span>.reconPack=<span class="hljs-literal">null</span>;<span class="hljs-keyword">this</span>.buffers=[]};<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">error</span>(<span class="hljs-params">data</span>)</span>{<span class="hljs-keyword">return</span>{<span class="hljs-attr">type</span>:exports.ERROR,<span class="hljs-attr">data</span>:<span class="hljs-string">"parser error"</span>}}},{<span class="hljs-string">"./binary"</span>:<span class="hljs-number">46</span>,<span class="hljs-string">"./is-buffer"</span>:<span class="hljs-number">48</span>,<span class="hljs-string">"component-emitter"</span>:<span class="hljs-number">49</span>,<span class="hljs-attr">debug</span>:<span class="hljs-number">39</span>,<span class="hljs-attr">isarray</span>:<span class="hljs-number">43</span>,<span class="hljs-attr">json3</span>:<span class="hljs-number">50</span>}],<span class="hljs-number">48</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">_dereq_,module,exports</span>)</span>{(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">global</span>)</span>{<span class="hljs-built_in">module</span>.exports=isBuf;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isBuf</span>(<span class="hljs-params">obj</span>)</span>{<span class="hljs-keyword">return</span> global.Buffer&amp;&amp;global.Buffer.isBuffer(obj)||global.ArrayBuffer&amp;&amp;obj <span class="hljs-keyword">instanceof</span> <span class="hljs-built_in">ArrayBuffer</span>}}).call(<span class="hljs-keyword">this</span>,<span class="hljs-keyword">typeof</span> self!==<span class="hljs-string">"undefined"</span>?self:<span class="hljs-keyword">typeof</span> <span class="hljs-built_in">window</span>!==<span class="hljs-string">"undefined"</span>?<span class="hljs-built_in">window</span>:<span class="hljs-keyword">typeof</span> global!==<span class="hljs-string">"undefined"</span>?global:{})},{}],<span class="hljs-number">49</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">_dereq_,module,exports</span>)</span>{<span class="hljs-built_in">arguments</span>[<span class="hljs-number">4</span>][<span class="hljs-number">15</span>][<span class="hljs-number">0</span>].apply(exports,<span class="hljs-built_in">arguments</span>)},{<span class="hljs-attr">dup</span>:<span class="hljs-number">15</span>}],<span class="hljs-number">50</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">_dereq_,module,exports</span>)</span>{(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">global</span>)</span>{(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{<span class="hljs-keyword">var</span> isLoader=<span class="hljs-keyword">typeof</span> define===<span class="hljs-string">"function"</span>&amp;&amp;define.amd;<span class="hljs-keyword">var</span> objectTypes={<span class="hljs-string">"function"</span>:<span class="hljs-literal">true</span>,<span class="hljs-attr">object</span>:<span class="hljs-literal">true</span>};<span class="hljs-keyword">var</span> freeExports=objectTypes[<span class="hljs-keyword">typeof</span> exports]&amp;&amp;exports&amp;&amp;!exports.nodeType&amp;&amp;exports;<span class="hljs-keyword">var</span> root=objectTypes[<span class="hljs-keyword">typeof</span> <span class="hljs-built_in">window</span>]&amp;&amp;<span class="hljs-built_in">window</span>||<span class="hljs-keyword">this</span>,freeGlobal=freeExports&amp;&amp;objectTypes[<span class="hljs-keyword">typeof</span> <span class="hljs-built_in">module</span>]&amp;&amp;<span class="hljs-built_in">module</span>&amp;&amp;!<span class="hljs-built_in">module</span>.nodeType&amp;&amp;<span class="hljs-keyword">typeof</span> global==<span class="hljs-string">"object"</span>&amp;&amp;global;<span class="hljs-keyword">if</span>(freeGlobal&amp;&amp;(freeGlobal[<span class="hljs-string">"global"</span>]===freeGlobal||freeGlobal[<span class="hljs-string">"window"</span>]===freeGlobal||freeGlobal[<span class="hljs-string">"self"</span>]===freeGlobal)){root=freeGlobal}<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">runInContext</span>(<span class="hljs-params">context,exports</span>)</span>{context||(context=root[<span class="hljs-string">"Object"</span>]());exports||(exports=root[<span class="hljs-string">"Object"</span>]());<span class="hljs-keyword">var</span> <span class="hljs-built_in">Number</span>=context[<span class="hljs-string">"Number"</span>]||root[<span class="hljs-string">"Number"</span>],<span class="hljs-built_in">String</span>=context[<span class="hljs-string">"String"</span>]||root[<span class="hljs-string">"String"</span>],<span class="hljs-built_in">Object</span>=context[<span class="hljs-string">"Object"</span>]||root[<span class="hljs-string">"Object"</span>],<span class="hljs-built_in">Date</span>=context[<span class="hljs-string">"Date"</span>]||root[<span class="hljs-string">"Date"</span>],<span class="hljs-built_in">SyntaxError</span>=context[<span class="hljs-string">"SyntaxError"</span>]||root[<span class="hljs-string">"SyntaxError"</span>],<span class="hljs-built_in">TypeError</span>=context[<span class="hljs-string">"TypeError"</span>]||root[<span class="hljs-string">"TypeError"</span>],<span class="hljs-built_in">Math</span>=context[<span class="hljs-string">"Math"</span>]||root[<span class="hljs-string">"Math"</span>],nativeJSON=context[<span class="hljs-string">"JSON"</span>]||root[<span class="hljs-string">"JSON"</span>];<span class="hljs-keyword">if</span>(<span class="hljs-keyword">typeof</span> nativeJSON==<span class="hljs-string">"object"</span>&amp;&amp;nativeJSON){exports.stringify=nativeJSON.stringify;exports.parse=nativeJSON.parse}<span class="hljs-keyword">var</span> objectProto=<span class="hljs-built_in">Object</span>.prototype,getClass=objectProto.toString,isProperty,forEach,undef;<span class="hljs-keyword">var</span> isExtended=<span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(<span class="hljs-number">-0xc782b5b800cec</span>);<span class="hljs-keyword">try</span>{isExtended=isExtended.getUTCFullYear()==<span class="hljs-number">-109252</span>&amp;&amp;isExtended.getUTCMonth()===<span class="hljs-number">0</span>&amp;&amp;isExtended.getUTCDate()===<span class="hljs-number">1</span>&amp;&amp;isExtended.getUTCHours()==<span class="hljs-number">10</span>&amp;&amp;isExtended.getUTCMinutes()==<span class="hljs-number">37</span>&amp;&amp;isExtended.getUTCSeconds()==<span class="hljs-number">6</span>&amp;&amp;isExtended.getUTCMilliseconds()==<span class="hljs-number">708</span>}<span class="hljs-keyword">catch</span>(exception){}<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">has</span>(<span class="hljs-params">name</span>)</span>{<span class="hljs-keyword">if</span>(has[name]!==undef){<span class="hljs-keyword">return</span> has[name]}<span class="hljs-keyword">var</span> isSupported;<span class="hljs-keyword">if</span>(name==<span class="hljs-string">"bug-string-char-index"</span>){isSupported=<span class="hljs-string">"a"</span>[<span class="hljs-number">0</span>]!=<span class="hljs-string">"a"</span>}<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(name==<span class="hljs-string">"json"</span>){isSupported=has(<span class="hljs-string">"json-stringify"</span>)&amp;&amp;has(<span class="hljs-string">"json-parse"</span>)}<span class="hljs-keyword">else</span>{<span class="hljs-keyword">var</span> value,serialized=<span class="hljs-string">'{"a":[1,true,false,null,"\\u0000\\b\\n\\f\\r\\t"]}'</span>;<span class="hljs-keyword">if</span>(name==<span class="hljs-string">"json-stringify"</span>){<span class="hljs-keyword">var</span> stringify=exports.stringify,stringifySupported=<span class="hljs-keyword">typeof</span> stringify==<span class="hljs-string">"function"</span>&amp;&amp;isExtended;<span class="hljs-keyword">if</span>(stringifySupported){(value=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{<span class="hljs-keyword">return</span> <span class="hljs-number">1</span>}).toJSON=value;<span class="hljs-keyword">try</span>{stringifySupported=stringify(<span class="hljs-number">0</span>)===<span class="hljs-string">"0"</span>&amp;&amp;stringify(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Number</span>)===<span class="hljs-string">"0"</span>&amp;&amp;stringify(<span class="hljs-keyword">new</span> <span class="hljs-built_in">String</span>)==<span class="hljs-string">'""'</span>&amp;&amp;stringify(getClass)===undef&amp;&amp;stringify(undef)===undef&amp;&amp;stringify()===undef&amp;&amp;stringify(value)===<span class="hljs-string">"1"</span>&amp;&amp;stringify([value])==<span class="hljs-string">"[1]"</span>&amp;&amp;stringify([undef])==<span class="hljs-string">"[null]"</span>&amp;&amp;stringify(<span class="hljs-literal">null</span>)==<span class="hljs-string">"null"</span>&amp;&amp;stringify([undef,getClass,<span class="hljs-literal">null</span>])==<span class="hljs-string">"[null,null,null]"</span>&amp;&amp;stringify({<span class="hljs-attr">a</span>:[value,<span class="hljs-literal">true</span>,<span class="hljs-literal">false</span>,<span class="hljs-literal">null</span>,<span class="hljs-string">"\x00\b\n\f\r	"</span>]})==serialized&amp;&amp;stringify(<span class="hljs-literal">null</span>,value)===<span class="hljs-string">"1"</span>&amp;&amp;stringify([<span class="hljs-number">1</span>,<span class="hljs-number">2</span>],<span class="hljs-literal">null</span>,<span class="hljs-number">1</span>)==<span class="hljs-string">"[\n 1,\n 2\n]"</span>&amp;&amp;stringify(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(<span class="hljs-number">-864e13</span>))==<span class="hljs-string">'"-271821-04-20T00:00:00.000Z"'</span>&amp;&amp;stringify(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(<span class="hljs-number">864e13</span>))==<span class="hljs-string">'"+275760-09-13T00:00:00.000Z"'</span>&amp;&amp;stringify(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(<span class="hljs-number">-621987552e5</span>))==<span class="hljs-string">'"-000001-01-01T00:00:00.000Z"'</span>&amp;&amp;stringify(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(<span class="hljs-number">-1</span>))==<span class="hljs-string">'"1969-12-31T23:59:59.999Z"'</span>}<span class="hljs-keyword">catch</span>(exception){stringifySupported=<span class="hljs-literal">false</span>}}isSupported=stringifySupported}<span class="hljs-keyword">if</span>(name==<span class="hljs-string">"json-parse"</span>){<span class="hljs-keyword">var</span> parse=exports.parse;<span class="hljs-keyword">if</span>(<span class="hljs-keyword">typeof</span> parse==<span class="hljs-string">"function"</span>){<span class="hljs-keyword">try</span>{<span class="hljs-keyword">if</span>(parse(<span class="hljs-string">"0"</span>)===<span class="hljs-number">0</span>&amp;&amp;!parse(<span class="hljs-literal">false</span>)){value=parse(serialized);<span class="hljs-keyword">var</span> parseSupported=value[<span class="hljs-string">"a"</span>].length==<span class="hljs-number">5</span>&amp;&amp;value[<span class="hljs-string">"a"</span>][<span class="hljs-number">0</span>]===<span class="hljs-number">1</span>;<span class="hljs-keyword">if</span>(parseSupported){<span class="hljs-keyword">try</span>{parseSupported=!parse(<span class="hljs-string">'"	"'</span>)}<span class="hljs-keyword">catch</span>(exception){}<span class="hljs-keyword">if</span>(parseSupported){<span class="hljs-keyword">try</span>{parseSupported=parse(<span class="hljs-string">"01"</span>)!==<span class="hljs-number">1</span>}<span class="hljs-keyword">catch</span>(exception){}}<span class="hljs-keyword">if</span>(parseSupported){<span class="hljs-keyword">try</span>{parseSupported=parse(<span class="hljs-string">"1."</span>)!==<span class="hljs-number">1</span>}<span class="hljs-keyword">catch</span>(exception){}}}}}<span class="hljs-keyword">catch</span>(exception){parseSupported=<span class="hljs-literal">false</span>}}isSupported=parseSupported}}<span class="hljs-keyword">return</span> has[name]=!!isSupported}<span class="hljs-keyword">if</span>(!has(<span class="hljs-string">"json"</span>)){<span class="hljs-keyword">var</span> functionClass=<span class="hljs-string">"[object Function]"</span>,dateClass=<span class="hljs-string">"[object Date]"</span>,numberClass=<span class="hljs-string">"[object Number]"</span>,stringClass=<span class="hljs-string">"[object String]"</span>,arrayClass=<span class="hljs-string">"[object Array]"</span>,booleanClass=<span class="hljs-string">"[object Boolean]"</span>;<span class="hljs-keyword">var</span> charIndexBuggy=has(<span class="hljs-string">"bug-string-char-index"</span>);<span class="hljs-keyword">if</span>(!isExtended){<span class="hljs-keyword">var</span> floor=<span class="hljs-built_in">Math</span>.floor;<span class="hljs-keyword">var</span> Months=[<span class="hljs-number">0</span>,<span class="hljs-number">31</span>,<span class="hljs-number">59</span>,<span class="hljs-number">90</span>,<span class="hljs-number">120</span>,<span class="hljs-number">151</span>,<span class="hljs-number">181</span>,<span class="hljs-number">212</span>,<span class="hljs-number">243</span>,<span class="hljs-number">273</span>,<span class="hljs-number">304</span>,<span class="hljs-number">334</span>];<span class="hljs-keyword">var</span> getDay=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">year,month</span>)</span>{<span class="hljs-keyword">return</span> Months[month]+<span class="hljs-number">365</span>*(year<span class="hljs-number">-1970</span>)+floor((year<span class="hljs-number">-1969</span>+(month=+(month&gt;<span class="hljs-number">1</span>)))/<span class="hljs-number">4</span>)-floor((year<span class="hljs-number">-1901</span>+month)/<span class="hljs-number">100</span>)+floor((year<span class="hljs-number">-1601</span>+month)/<span class="hljs-number">400</span>)}}<span class="hljs-keyword">if</span>(!(isProperty=objectProto.hasOwnProperty)){isProperty=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">property</span>)</span>{<span class="hljs-keyword">var</span> members={},<span class="hljs-keyword">constructor</span>;if((members.__proto__=null,members.__proto__={toString:<span class="hljs-number">1</span>},members).toString!=getClass){isProperty=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">property</span>)</span>{<span class="hljs-keyword">var</span> original=<span class="hljs-keyword">this</span>.__proto__,result=property <span class="hljs-keyword">in</span>(<span class="hljs-keyword">this</span>.__proto__=<span class="hljs-literal">null</span>,<span class="hljs-keyword">this</span>);<span class="hljs-keyword">this</span>.__proto__=original;<span class="hljs-keyword">return</span> result}}<span class="hljs-keyword">else</span>{<span class="hljs-keyword">constructor</span>=members.<span class="hljs-keyword">constructor</span>;isProperty=function(property){<span class="hljs-keyword">var</span> parent=(<span class="hljs-keyword">this</span>.constructor||<span class="hljs-keyword">constructor</span>).prototype;return property in this&amp;&amp;!(property in parent&amp;&amp;this[property]===parent[property])}}members=null;return isProperty.call(this,property)}}forEach=function(object,callback){<span class="hljs-keyword">var</span> size=<span class="hljs-number">0</span>,Properties,members,property;(Properties=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{<span class="hljs-keyword">this</span>.valueOf=<span class="hljs-number">0</span>}).prototype.valueOf=<span class="hljs-number">0</span>;members=<span class="hljs-keyword">new</span> Properties;<span class="hljs-keyword">for</span>(property <span class="hljs-keyword">in</span> members){<span class="hljs-keyword">if</span>(isProperty.call(members,property)){size++}}Properties=members=<span class="hljs-literal">null</span>;<span class="hljs-keyword">if</span>(!size){members=[<span class="hljs-string">"valueOf"</span>,<span class="hljs-string">"toString"</span>,<span class="hljs-string">"toLocaleString"</span>,<span class="hljs-string">"propertyIsEnumerable"</span>,<span class="hljs-string">"isPrototypeOf"</span>,<span class="hljs-string">"hasOwnProperty"</span>,<span class="hljs-string">"constructor"</span>];forEach=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">object,callback</span>)</span>{<span class="hljs-keyword">var</span> isFunction=getClass.call(object)==functionClass,property,length;<span class="hljs-keyword">var</span> hasProperty=!isFunction&amp;&amp;<span class="hljs-keyword">typeof</span> object.constructor!=<span class="hljs-string">"function"</span>&amp;&amp;objectTypes[<span class="hljs-keyword">typeof</span> object.hasOwnProperty]&amp;&amp;object.hasOwnProperty||isProperty;<span class="hljs-keyword">for</span>(property <span class="hljs-keyword">in</span> object){<span class="hljs-keyword">if</span>(!(isFunction&amp;&amp;property==<span class="hljs-string">"prototype"</span>)&amp;&amp;hasProperty.call(object,property)){callback(property)}}<span class="hljs-keyword">for</span>(length=members.length;property=members[--length];hasProperty.call(object,property)&amp;&amp;callback(property));}}<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(size==<span class="hljs-number">2</span>){forEach=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">object,callback</span>)</span>{<span class="hljs-keyword">var</span> members={},isFunction=getClass.call(object)==functionClass,property;<span class="hljs-keyword">for</span>(property <span class="hljs-keyword">in</span> object){<span class="hljs-keyword">if</span>(!(isFunction&amp;&amp;property==<span class="hljs-string">"prototype"</span>)&amp;&amp;!isProperty.call(members,property)&amp;&amp;(members[property]=<span class="hljs-number">1</span>)&amp;&amp;isProperty.call(object,property)){callback(property)}}}}<span class="hljs-keyword">else</span>{forEach=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">object,callback</span>)</span>{<span class="hljs-keyword">var</span> isFunction=getClass.call(object)==functionClass,property,isConstructor;<span class="hljs-keyword">for</span>(property <span class="hljs-keyword">in</span> object){<span class="hljs-keyword">if</span>(!(isFunction&amp;&amp;property==<span class="hljs-string">"prototype"</span>)&amp;&amp;isProperty.call(object,property)&amp;&amp;!(isConstructor=property===<span class="hljs-string">"constructor"</span>)){callback(property)}}<span class="hljs-keyword">if</span>(isConstructor||isProperty.call(object,property=<span class="hljs-string">"constructor"</span>)){callback(property)}}}<span class="hljs-keyword">return</span> forEach(object,callback)};<span class="hljs-keyword">if</span>(!has(<span class="hljs-string">"json-stringify"</span>)){<span class="hljs-keyword">var</span> Escapes={<span class="hljs-number">92</span>:<span class="hljs-string">"\\\\"</span>,<span class="hljs-number">34</span>:<span class="hljs-string">'\\"'</span>,<span class="hljs-number">8</span>:<span class="hljs-string">"\\b"</span>,<span class="hljs-number">12</span>:<span class="hljs-string">"\\f"</span>,<span class="hljs-number">10</span>:<span class="hljs-string">"\\n"</span>,<span class="hljs-number">13</span>:<span class="hljs-string">"\\r"</span>,<span class="hljs-number">9</span>:<span class="hljs-string">"\\t"</span>};<span class="hljs-keyword">var</span> leadingZeroes=<span class="hljs-string">"000000"</span>;<span class="hljs-keyword">var</span> toPaddedString=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">width,value</span>)</span>{<span class="hljs-keyword">return</span>(leadingZeroes+(value||<span class="hljs-number">0</span>)).slice(-width)};<span class="hljs-keyword">var</span> unicodePrefix=<span class="hljs-string">"\\u00"</span>;<span class="hljs-keyword">var</span> quote=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">value</span>)</span>{<span class="hljs-keyword">var</span> result=<span class="hljs-string">'"'</span>,index=<span class="hljs-number">0</span>,length=value.length,useCharIndex=!charIndexBuggy||length&gt;<span class="hljs-number">10</span>;<span class="hljs-keyword">var</span> symbols=useCharIndex&amp;&amp;(charIndexBuggy?value.split(<span class="hljs-string">""</span>):value);<span class="hljs-keyword">for</span>(;index&lt;length;index++){<span class="hljs-keyword">var</span> charCode=value.charCodeAt(index);<span class="hljs-keyword">switch</span>(charCode){<span class="hljs-keyword">case</span> <span class="hljs-number">8</span>:<span class="hljs-keyword">case</span> <span class="hljs-number">9</span>:<span class="hljs-keyword">case</span> <span class="hljs-number">10</span>:<span class="hljs-keyword">case</span> <span class="hljs-number">12</span>:<span class="hljs-keyword">case</span> <span class="hljs-number">13</span>:<span class="hljs-keyword">case</span> <span class="hljs-number">34</span>:<span class="hljs-keyword">case</span> <span class="hljs-number">92</span>:result+=Escapes[charCode];<span class="hljs-keyword">break</span>;<span class="hljs-keyword">default</span>:<span class="hljs-keyword">if</span>(charCode&lt;<span class="hljs-number">32</span>){result+=unicodePrefix+toPaddedString(<span class="hljs-number">2</span>,charCode.toString(<span class="hljs-number">16</span>));<span class="hljs-keyword">break</span>}result+=useCharIndex?symbols[index]:value.charAt(index)}}<span class="hljs-keyword">return</span> result+<span class="hljs-string">'"'</span>};<span class="hljs-keyword">var</span> serialize=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">property,object,callback,properties,whitespace,indentation,stack</span>)</span>{<span class="hljs-keyword">var</span> value,className,year,month,date,time,hours,minutes,seconds,milliseconds,results,element,index,length,prefix,result;<span class="hljs-keyword">try</span>{value=object[property]}<span class="hljs-keyword">catch</span>(exception){}<span class="hljs-keyword">if</span>(<span class="hljs-keyword">typeof</span> value==<span class="hljs-string">"object"</span>&amp;&amp;value){className=getClass.call(value);<span class="hljs-keyword">if</span>(className==dateClass&amp;&amp;!isProperty.call(value,<span class="hljs-string">"toJSON"</span>)){<span class="hljs-keyword">if</span>(value&gt;<span class="hljs-number">-1</span>/<span class="hljs-number">0</span>&amp;&amp;value&lt;<span class="hljs-number">1</span>/<span class="hljs-number">0</span>){<span class="hljs-keyword">if</span>(getDay){date=floor(value/<span class="hljs-number">864e5</span>);<span class="hljs-keyword">for</span>(year=floor(date/<span class="hljs-number">365.2425</span>)+<span class="hljs-number">1970</span><span class="hljs-number">-1</span>;getDay(year+<span class="hljs-number">1</span>,<span class="hljs-number">0</span>)&lt;=date;year++);<span class="hljs-keyword">for</span>(month=floor((date-getDay(year,<span class="hljs-number">0</span>))/<span class="hljs-number">30.42</span>);getDay(year,month+<span class="hljs-number">1</span>)&lt;=date;month++);date=<span class="hljs-number">1</span>+date-getDay(year,month);time=(value%<span class="hljs-number">864e5</span>+<span class="hljs-number">864e5</span>)%<span class="hljs-number">864e5</span>;hours=floor(time/<span class="hljs-number">36e5</span>)%<span class="hljs-number">24</span>;minutes=floor(time/<span class="hljs-number">6e4</span>)%<span class="hljs-number">60</span>;seconds=floor(time/<span class="hljs-number">1e3</span>)%<span class="hljs-number">60</span>;milliseconds=time%<span class="hljs-number">1e3</span>}<span class="hljs-keyword">else</span>{year=value.getUTCFullYear();month=value.getUTCMonth();date=value.getUTCDate();hours=value.getUTCHours();minutes=value.getUTCMinutes();seconds=value.getUTCSeconds();milliseconds=value.getUTCMilliseconds()}value=(year&lt;=<span class="hljs-number">0</span>||year&gt;=<span class="hljs-number">1e4</span>?(year&lt;<span class="hljs-number">0</span>?<span class="hljs-string">"-"</span>:<span class="hljs-string">"+"</span>)+toPaddedString(<span class="hljs-number">6</span>,year&lt;<span class="hljs-number">0</span>?-year:year):toPaddedString(<span class="hljs-number">4</span>,year))+<span class="hljs-string">"-"</span>+toPaddedString(<span class="hljs-number">2</span>,month+<span class="hljs-number">1</span>)+<span class="hljs-string">"-"</span>+toPaddedString(<span class="hljs-number">2</span>,date)+<span class="hljs-string">"T"</span>+toPaddedString(<span class="hljs-number">2</span>,hours)+<span class="hljs-string">":"</span>+toPaddedString(<span class="hljs-number">2</span>,minutes)+<span class="hljs-string">":"</span>+toPaddedString(<span class="hljs-number">2</span>,seconds)+<span class="hljs-string">"."</span>+toPaddedString(<span class="hljs-number">3</span>,milliseconds)+<span class="hljs-string">"Z"</span>}<span class="hljs-keyword">else</span>{value=<span class="hljs-literal">null</span>}}<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(<span class="hljs-keyword">typeof</span> value.toJSON==<span class="hljs-string">"function"</span>&amp;&amp;(className!=numberClass&amp;&amp;className!=stringClass&amp;&amp;className!=arrayClass||isProperty.call(value,<span class="hljs-string">"toJSON"</span>))){value=value.toJSON(property)}}<span class="hljs-keyword">if</span>(callback){value=callback.call(object,property,value)}<span class="hljs-keyword">if</span>(value===<span class="hljs-literal">null</span>){<span class="hljs-keyword">return</span><span class="hljs-string">"null"</span>}className=getClass.call(value);<span class="hljs-keyword">if</span>(className==booleanClass){<span class="hljs-keyword">return</span><span class="hljs-string">""</span>+value}<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(className==numberClass){<span class="hljs-keyword">return</span> value&gt;<span class="hljs-number">-1</span>/<span class="hljs-number">0</span>&amp;&amp;value&lt;<span class="hljs-number">1</span>/<span class="hljs-number">0</span>?<span class="hljs-string">""</span>+value:<span class="hljs-string">"null"</span>}<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(className==stringClass){<span class="hljs-keyword">return</span> quote(<span class="hljs-string">""</span>+value)}<span class="hljs-keyword">if</span>(<span class="hljs-keyword">typeof</span> value==<span class="hljs-string">"object"</span>){<span class="hljs-keyword">for</span>(length=stack.length;length--;){<span class="hljs-keyword">if</span>(stack[length]===value){<span class="hljs-keyword">throw</span> <span class="hljs-built_in">TypeError</span>()}}stack.push(value);results=[];prefix=indentation;indentation+=whitespace;<span class="hljs-keyword">if</span>(className==arrayClass){<span class="hljs-keyword">for</span>(index=<span class="hljs-number">0</span>,length=value.length;index&lt;length;index++){element=serialize(index,value,callback,properties,whitespace,indentation,stack);results.push(element===undef?<span class="hljs-string">"null"</span>:element)}result=results.length?whitespace?<span class="hljs-string">"[\n"</span>+indentation+results.join(<span class="hljs-string">",\n"</span>+indentation)+<span class="hljs-string">"\n"</span>+prefix+<span class="hljs-string">"]"</span>:<span class="hljs-string">"["</span>+results.join(<span class="hljs-string">","</span>)+<span class="hljs-string">"]"</span>:<span class="hljs-string">"[]"</span>}<span class="hljs-keyword">else</span>{forEach(properties||value,<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">property</span>)</span>{<span class="hljs-keyword">var</span> element=serialize(property,value,callback,properties,whitespace,indentation,stack);<span class="hljs-keyword">if</span>(element!==undef){results.push(quote(property)+<span class="hljs-string">":"</span>+(whitespace?<span class="hljs-string">" "</span>:<span class="hljs-string">""</span>)+element)}});result=results.length?whitespace?<span class="hljs-string">"{\n"</span>+indentation+results.join(<span class="hljs-string">",\n"</span>+indentation)+<span class="hljs-string">"\n"</span>+prefix+<span class="hljs-string">"}"</span>:<span class="hljs-string">"{"</span>+results.join(<span class="hljs-string">","</span>)+<span class="hljs-string">"}"</span>:<span class="hljs-string">"{}"</span>}stack.pop();<span class="hljs-keyword">return</span> result}};exports.stringify=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">source,filter,width</span>)</span>{<span class="hljs-keyword">var</span> whitespace,callback,properties,className;<span class="hljs-keyword">if</span>(objectTypes[<span class="hljs-keyword">typeof</span> filter]&amp;&amp;filter){<span class="hljs-keyword">if</span>((className=getClass.call(filter))==functionClass){callback=filter}<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(className==arrayClass){properties={};<span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> index=<span class="hljs-number">0</span>,length=filter.length,value;index&lt;length;value=filter[index++],(className=getClass.call(value),className==stringClass||className==numberClass)&amp;&amp;(properties[value]=<span class="hljs-number">1</span>));}}<span class="hljs-keyword">if</span>(width){<span class="hljs-keyword">if</span>((className=getClass.call(width))==numberClass){<span class="hljs-keyword">if</span>((width-=width%<span class="hljs-number">1</span>)&gt;<span class="hljs-number">0</span>){<span class="hljs-keyword">for</span>(whitespace=<span class="hljs-string">""</span>,width&gt;<span class="hljs-number">10</span>&amp;&amp;(width=<span class="hljs-number">10</span>);whitespace.length&lt;width;whitespace+=<span class="hljs-string">" "</span>);}}<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(className==stringClass){whitespace=width.length&lt;=<span class="hljs-number">10</span>?width:width.slice(<span class="hljs-number">0</span>,<span class="hljs-number">10</span>)}}<span class="hljs-keyword">return</span> serialize(<span class="hljs-string">""</span>,(value={},value[<span class="hljs-string">""</span>]=source,value),callback,properties,whitespace,<span class="hljs-string">""</span>,[])}}<span class="hljs-keyword">if</span>(!has(<span class="hljs-string">"json-parse"</span>)){<span class="hljs-keyword">var</span> fromCharCode=<span class="hljs-built_in">String</span>.fromCharCode;<span class="hljs-keyword">var</span> Unescapes={<span class="hljs-number">92</span>:<span class="hljs-string">"\\"</span>,<span class="hljs-number">34</span>:<span class="hljs-string">'"'</span>,<span class="hljs-number">47</span>:<span class="hljs-string">"/"</span>,<span class="hljs-number">98</span>:<span class="hljs-string">"\b"</span>,<span class="hljs-number">116</span>:<span class="hljs-string">"	"</span>,<span class="hljs-number">110</span>:<span class="hljs-string">"\n"</span>,<span class="hljs-number">102</span>:<span class="hljs-string">"\f"</span>,<span class="hljs-number">114</span>:<span class="hljs-string">"\r"</span>};<span class="hljs-keyword">var</span> Index,Source;<span class="hljs-keyword">var</span> abort=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{Index=Source=<span class="hljs-literal">null</span>;<span class="hljs-keyword">throw</span> <span class="hljs-built_in">SyntaxError</span>()};<span class="hljs-keyword">var</span> lex=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{<span class="hljs-keyword">var</span> source=Source,length=source.length,value,begin,position,isSigned,charCode;<span class="hljs-keyword">while</span>(Index&lt;length){charCode=source.charCodeAt(Index);<span class="hljs-keyword">switch</span>(charCode){<span class="hljs-keyword">case</span> <span class="hljs-number">9</span>:<span class="hljs-keyword">case</span> <span class="hljs-number">10</span>:<span class="hljs-keyword">case</span> <span class="hljs-number">13</span>:<span class="hljs-keyword">case</span> <span class="hljs-number">32</span>:Index++;<span class="hljs-keyword">break</span>;<span class="hljs-keyword">case</span> <span class="hljs-number">123</span>:<span class="hljs-keyword">case</span> <span class="hljs-number">125</span>:<span class="hljs-keyword">case</span> <span class="hljs-number">91</span>:<span class="hljs-keyword">case</span> <span class="hljs-number">93</span>:<span class="hljs-keyword">case</span> <span class="hljs-number">58</span>:<span class="hljs-keyword">case</span> <span class="hljs-number">44</span>:value=charIndexBuggy?source.charAt(Index):source[Index];Index++;<span class="hljs-keyword">return</span> value;<span class="hljs-keyword">case</span> <span class="hljs-number">34</span>:<span class="hljs-keyword">for</span>(value=<span class="hljs-string">"@"</span>,Index++;Index&lt;length;){charCode=source.charCodeAt(Index);<span class="hljs-keyword">if</span>(charCode&lt;<span class="hljs-number">32</span>){abort()}<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(charCode==<span class="hljs-number">92</span>){charCode=source.charCodeAt(++Index);<span class="hljs-keyword">switch</span>(charCode){<span class="hljs-keyword">case</span> <span class="hljs-number">92</span>:<span class="hljs-keyword">case</span> <span class="hljs-number">34</span>:<span class="hljs-keyword">case</span> <span class="hljs-number">47</span>:<span class="hljs-keyword">case</span> <span class="hljs-number">98</span>:<span class="hljs-keyword">case</span> <span class="hljs-number">116</span>:<span class="hljs-keyword">case</span> <span class="hljs-number">110</span>:<span class="hljs-keyword">case</span> <span class="hljs-number">102</span>:<span class="hljs-keyword">case</span> <span class="hljs-number">114</span>:value+=Unescapes[charCode];Index++;<span class="hljs-keyword">break</span>;<span class="hljs-keyword">case</span> <span class="hljs-number">117</span>:begin=++Index;<span class="hljs-keyword">for</span>(position=Index+<span class="hljs-number">4</span>;Index&lt;position;Index++){charCode=source.charCodeAt(Index);<span class="hljs-keyword">if</span>(!(charCode&gt;=<span class="hljs-number">48</span>&amp;&amp;charCode&lt;=<span class="hljs-number">57</span>||charCode&gt;=<span class="hljs-number">97</span>&amp;&amp;charCode&lt;=<span class="hljs-number">102</span>||charCode&gt;=<span class="hljs-number">65</span>&amp;&amp;charCode&lt;=<span class="hljs-number">70</span>)){abort()}}value+=fromCharCode(<span class="hljs-string">"0x"</span>+source.slice(begin,Index));<span class="hljs-keyword">break</span>;<span class="hljs-keyword">default</span>:abort()}}<span class="hljs-keyword">else</span>{<span class="hljs-keyword">if</span>(charCode==<span class="hljs-number">34</span>){<span class="hljs-keyword">break</span>}charCode=source.charCodeAt(Index);begin=Index;<span class="hljs-keyword">while</span>(charCode&gt;=<span class="hljs-number">32</span>&amp;&amp;charCode!=<span class="hljs-number">92</span>&amp;&amp;charCode!=<span class="hljs-number">34</span>){charCode=source.charCodeAt(++Index)}value+=source.slice(begin,Index)}}<span class="hljs-keyword">if</span>(source.charCodeAt(Index)==<span class="hljs-number">34</span>){Index++;<span class="hljs-keyword">return</span> value}abort();<span class="hljs-keyword">default</span>:begin=Index;<span class="hljs-keyword">if</span>(charCode==<span class="hljs-number">45</span>){isSigned=<span class="hljs-literal">true</span>;charCode=source.charCodeAt(++Index)}<span class="hljs-keyword">if</span>(charCode&gt;=<span class="hljs-number">48</span>&amp;&amp;charCode&lt;=<span class="hljs-number">57</span>){<span class="hljs-keyword">if</span>(charCode==<span class="hljs-number">48</span>&amp;&amp;(charCode=source.charCodeAt(Index+<span class="hljs-number">1</span>),charCode&gt;=<span class="hljs-number">48</span>&amp;&amp;charCode&lt;=<span class="hljs-number">57</span>)){abort()}isSigned=<span class="hljs-literal">false</span>;<span class="hljs-keyword">for</span>(;Index&lt;length&amp;&amp;(charCode=source.charCodeAt(Index),charCode&gt;=<span class="hljs-number">48</span>&amp;&amp;charCode&lt;=<span class="hljs-number">57</span>);Index++);<span class="hljs-keyword">if</span>(source.charCodeAt(Index)==<span class="hljs-number">46</span>){position=++Index;<span class="hljs-keyword">for</span>(;position&lt;length&amp;&amp;(charCode=source.charCodeAt(position),charCode&gt;=<span class="hljs-number">48</span>&amp;&amp;charCode&lt;=<span class="hljs-number">57</span>);position++);<span class="hljs-keyword">if</span>(position==Index){abort()}Index=position}charCode=source.charCodeAt(Index);<span class="hljs-keyword">if</span>(charCode==<span class="hljs-number">101</span>||charCode==<span class="hljs-number">69</span>){charCode=source.charCodeAt(++Index);<span class="hljs-keyword">if</span>(charCode==<span class="hljs-number">43</span>||charCode==<span class="hljs-number">45</span>){Index++}<span class="hljs-keyword">for</span>(position=Index;position&lt;length&amp;&amp;(charCode=source.charCodeAt(position),charCode&gt;=<span class="hljs-number">48</span>&amp;&amp;charCode&lt;=<span class="hljs-number">57</span>);position++);<span class="hljs-keyword">if</span>(position==Index){abort()}Index=position}<span class="hljs-keyword">return</span>+source.slice(begin,Index)}<span class="hljs-keyword">if</span>(isSigned){abort()}<span class="hljs-keyword">if</span>(source.slice(Index,Index+<span class="hljs-number">4</span>)==<span class="hljs-string">"true"</span>){Index+=<span class="hljs-number">4</span>;<span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>}<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(source.slice(Index,Index+<span class="hljs-number">5</span>)==<span class="hljs-string">"false"</span>){Index+=<span class="hljs-number">5</span>;<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>}<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(source.slice(Index,Index+<span class="hljs-number">4</span>)==<span class="hljs-string">"null"</span>){Index+=<span class="hljs-number">4</span>;<span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>}abort()}}<span class="hljs-keyword">return</span><span class="hljs-string">"$"</span>};<span class="hljs-keyword">var</span> get=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">value</span>)</span>{<span class="hljs-keyword">var</span> results,hasMembers;<span class="hljs-keyword">if</span>(value==<span class="hljs-string">"$"</span>){abort()}<span class="hljs-keyword">if</span>(<span class="hljs-keyword">typeof</span> value==<span class="hljs-string">"string"</span>){<span class="hljs-keyword">if</span>((charIndexBuggy?value.charAt(<span class="hljs-number">0</span>):value[<span class="hljs-number">0</span>])==<span class="hljs-string">"@"</span>){<span class="hljs-keyword">return</span> value.slice(<span class="hljs-number">1</span>)}<span class="hljs-keyword">if</span>(value==<span class="hljs-string">"["</span>){results=[];<span class="hljs-keyword">for</span>(;;hasMembers||(hasMembers=<span class="hljs-literal">true</span>)){value=lex();<span class="hljs-keyword">if</span>(value==<span class="hljs-string">"]"</span>){<span class="hljs-keyword">break</span>}<span class="hljs-keyword">if</span>(hasMembers){<span class="hljs-keyword">if</span>(value==<span class="hljs-string">","</span>){value=lex();<span class="hljs-keyword">if</span>(value==<span class="hljs-string">"]"</span>){abort()}}<span class="hljs-keyword">else</span>{abort()}}<span class="hljs-keyword">if</span>(value==<span class="hljs-string">","</span>){abort()}results.push(get(value))}<span class="hljs-keyword">return</span> results}<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(value==<span class="hljs-string">"{"</span>){results={};<span class="hljs-keyword">for</span>(;;hasMembers||(hasMembers=<span class="hljs-literal">true</span>)){value=lex();<span class="hljs-keyword">if</span>(value==<span class="hljs-string">"}"</span>){<span class="hljs-keyword">break</span>}<span class="hljs-keyword">if</span>(hasMembers){<span class="hljs-keyword">if</span>(value==<span class="hljs-string">","</span>){value=lex();<span class="hljs-keyword">if</span>(value==<span class="hljs-string">"}"</span>){abort()}}<span class="hljs-keyword">else</span>{abort()}}<span class="hljs-keyword">if</span>(value==<span class="hljs-string">","</span>||<span class="hljs-keyword">typeof</span> value!=<span class="hljs-string">"string"</span>||(charIndexBuggy?value.charAt(<span class="hljs-number">0</span>):value[<span class="hljs-number">0</span>])!=<span class="hljs-string">"@"</span>||lex()!=<span class="hljs-string">":"</span>){abort()}results[value.slice(<span class="hljs-number">1</span>)]=get(lex())
}<span class="hljs-keyword">return</span> results}abort()}<span class="hljs-keyword">return</span> value};<span class="hljs-keyword">var</span> update=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">source,property,callback</span>)</span>{<span class="hljs-keyword">var</span> element=walk(source,property,callback);<span class="hljs-keyword">if</span>(element===undef){<span class="hljs-keyword">delete</span> source[property]}<span class="hljs-keyword">else</span>{source[property]=element}};<span class="hljs-keyword">var</span> walk=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">source,property,callback</span>)</span>{<span class="hljs-keyword">var</span> value=source[property],length;<span class="hljs-keyword">if</span>(<span class="hljs-keyword">typeof</span> value==<span class="hljs-string">"object"</span>&amp;&amp;value){<span class="hljs-keyword">if</span>(getClass.call(value)==arrayClass){<span class="hljs-keyword">for</span>(length=value.length;length--;){update(value,length,callback)}}<span class="hljs-keyword">else</span>{forEach(value,<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">property</span>)</span>{update(value,property,callback)})}}<span class="hljs-keyword">return</span> callback.call(source,property,value)};exports.parse=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">source,callback</span>)</span>{<span class="hljs-keyword">var</span> result,value;Index=<span class="hljs-number">0</span>;Source=<span class="hljs-string">""</span>+source;result=get(lex());<span class="hljs-keyword">if</span>(lex()!=<span class="hljs-string">"$"</span>){abort()}Index=Source=<span class="hljs-literal">null</span>;<span class="hljs-keyword">return</span> callback&amp;&amp;getClass.call(callback)==functionClass?walk((value={},value[<span class="hljs-string">""</span>]=result,value),<span class="hljs-string">""</span>,callback):result}}}exports[<span class="hljs-string">"runInContext"</span>]=runInContext;<span class="hljs-keyword">return</span> exports}<span class="hljs-keyword">if</span>(freeExports&amp;&amp;!isLoader){runInContext(root,freeExports)}<span class="hljs-keyword">else</span>{<span class="hljs-keyword">var</span> nativeJSON=root.JSON,previousJSON=root[<span class="hljs-string">"JSON3"</span>],isRestored=<span class="hljs-literal">false</span>;<span class="hljs-keyword">var</span> JSON3=runInContext(root,root[<span class="hljs-string">"JSON3"</span>]={<span class="hljs-attr">noConflict</span>:<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{<span class="hljs-keyword">if</span>(!isRestored){isRestored=<span class="hljs-literal">true</span>;root.JSON=nativeJSON;root[<span class="hljs-string">"JSON3"</span>]=previousJSON;nativeJSON=previousJSON=<span class="hljs-literal">null</span>}<span class="hljs-keyword">return</span> JSON3}});root.JSON={<span class="hljs-attr">parse</span>:JSON3.parse,<span class="hljs-attr">stringify</span>:JSON3.stringify}}<span class="hljs-keyword">if</span>(isLoader){define(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{<span class="hljs-keyword">return</span> JSON3})}}).call(<span class="hljs-keyword">this</span>)}).call(<span class="hljs-keyword">this</span>,<span class="hljs-keyword">typeof</span> self!==<span class="hljs-string">"undefined"</span>?self:<span class="hljs-keyword">typeof</span> <span class="hljs-built_in">window</span>!==<span class="hljs-string">"undefined"</span>?<span class="hljs-built_in">window</span>:<span class="hljs-keyword">typeof</span> global!==<span class="hljs-string">"undefined"</span>?global:{})},{}],<span class="hljs-number">51</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">_dereq_,module,exports</span>)</span>{<span class="hljs-built_in">module</span>.exports=toArray;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">toArray</span>(<span class="hljs-params">list,index</span>)</span>{<span class="hljs-keyword">var</span> array=[];index=index||<span class="hljs-number">0</span>;<span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> i=index||<span class="hljs-number">0</span>;i&lt;list.length;i++){array[i-index]=list[i]}<span class="hljs-keyword">return</span> array}},{}]},{},[<span class="hljs-number">31</span>])(<span class="hljs-number">31</span>)});</pre></div></div>
            
        </li>
        
    </ul>
  </div>
</body>
</html>
